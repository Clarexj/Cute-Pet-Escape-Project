{"version":3,"sources":["file:///Users/clare/Desktop/%E5%89%8D%E5%93%A8AI%E5%B0%8F%E8%AF%BE/ClareProject/Cute-Pet-Escape-Project/CocosProject/assets/libs/colyseus.js"],"names":["_cjsLoader","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","global","factory","amd","globalThis","self","Colyseus","_mergeNamespaces","n","m","forEach","e","Array","isArray","Object","keys","k","d","getOwnPropertyDescriptor","defineProperty","get","enumerable","freeze","ArrayBuffer","isView","a","buffer","window","extendStatics","b","setPrototypeOf","__proto__","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","v","op","pop","length","push","src","tar","headers","statusMessage","statusText","statusCode","status","data","response","send","method","uri","opts","res","rej","req","XMLHttpRequest","tmp","arr","str","timeout","ontimeout","onerror","err","type","open","href","onload","getAllResponseHeaders","trim","split","shift","toLowerCase","join","indexOf","JSON","parse","reviver","FormData","stringify","withCredentials","setRequestHeader","bind","post","patch","del","put","del_1","get_1","patch_1","post_1","put_1","send_1","xhr","http","CloseCode","ServerError","_super","code","message","_this","name","Error","Decoder","offset","_offset","_buffer","_view","DataView","byteOffset","byteLength","utf8Read$1","view","string","chr","i","end","byte","getUint8","fromCharCode","toString","_array","_parse","_map","key","_str","_bin","slice","prefix","hi","lo","getUint16","getUint32","getInt8","getFloat32","getFloat64","Math","pow","getInt16","getInt32","Date","decode","decoder","utf8Write","c","l","charCodeAt","setUint8","utf8Length$1","_encode","bytes","defers","size","_length","floor","isFinite","_float","time","getTime","toJSON","allKeys","encode","buf","deferIndex","deferWritten","nextOffset","defer","deferLength","bin","Uint8Array","j","undefined","setFloat64","browser","WebSocket","WebSocketTransport","events","ws","connect","protocols","binaryType","onopen","onmessage","onclose","close","reason","Connection","transport","Protocol","ErrorCode","utf8Read","utf8Length","serializers","registerSerializer","id","serializer","getSerializer","createNanoEvents","emit","event","args","on","cb","filter","EventEmitter","handlers","register","once","invoke","_i","arguments","handler","invokeAsync","all","map","remove","index","clear","createSignal","emitter","callback","commonjsGlobal","createCommonjsModule","fn","umd","__decorate","decorators","target","desc","r","Reflect","decorate","__spreadArray","to","from","pack","ar","concat","SWITCH_TO_STRUCTURE","TYPE_ID","OPERATION","ChangeTree","ref","parent","root","changed","changes","Map","allChanges","Set","caches","currentCustomOperation","setParent","parentIndex","indexes","Schema","definition","field","schema","parentIndex_1","changeTreee","parentIndex_2","operation","set","change","fieldName","ADD","assertValidIndex","previousChange","DELETE","TOUCH","DELETE_AND_ADD","add","touchParents","touch","has","getType","fieldsByIndex","parentType","values","getChildrenFilter","childFilters","getValue","delete","console","warn","previousValue","discard","discardAll","cache","cachedBytes","clone","ensureRefId","refId","getNextUniqueId","addCallback","$callbacks","existing","item","spliceOne","removeChildRefs","needRemoveRef","$changes","$items","removeRef","len","DEFAULT_SORT","A","B","getArrayProxy","Proxy","obj","prop","isNaN","at","setValue","parseInt","deleteAt","setAt","deleteProperty","ArraySchema","items","$indexes","$refId","onAdd","triggerAll","onRemove","onChange","REPLACE","is","splice","configurable","lastIndex","_a","_b","$deleteAt","CLEAR","separator","reverse","reversedItems","shiftAt","start","sort","compareFn","sortedItems","deleteCount","removedItems","unshift","addedLength","previousValues","searchElement","fromIndex","lastIndexOf","every","callbackfn","some","reduce","initialValue","reduceRight","find","predicate","findIndex","fill","copyWithin","toLocaleString","entries","includes","flatMap","flat","depth","setIndex","getIndex","getByIndex","deleteByIndex","toArray","isDecoding","cloned","getMapProxy","MapSchema","initialValues","toStringTag","hasIndex","isRef","assign","registeredTypes","registerType","identifier","SchemaDefinition","deprecated","descriptors","addField","getNextFieldIndex","array","hasField","addFilter","filters","indexesWithFilters","addChildrenFilter","hasFilter","klass","_context","useFilters","Context","types","schemas","typeid","_definition","_typeid","options","context","globalContext","definitionAtLine","stack","isMap","childType","manual","writable","fieldCached","filterChildren","throws","defineTypes","fields","int8$1","uint8$1","int16$1","uint16$1","int32$1","uint32$1","b4","b3","b2","b1","int64$1","high","low","uint64$1","float32$1","writeFloat32","float64$1","writeFloat64","_int32$1","Int32Array","_float32$1","Float32Array","_float64$1","Float64Array","boolean$1","string$1","number$1","Number","MAX_SAFE_INTEGER","int8","uint8","int16","uint16","int32","uint32","int64","uint64","float32","float64","boolean","number","error","it","readFloat32","readFloat64","_int32","_float32","_float64","stringCheck","numberCheck","arrayCheck","switchStructureCheck","CollectionSchema","entry","SetSchema","ClientState","refIds","WeakSet","containerIndexes","WeakMap","addRefId","changeTree","client","$filterState","ReferenceTracker","refs","refCounts","deletedRefs","nextUniqueId","addRef","incrementCount","clearRefs","garbageCollectDeletedRefs","child","EncodeSchemaError","assertType","typeofTarget","allowNull","log","foundValue","assertInstanceType","encodePrimitiveType","encodeFunc","decodePrimitiveType","defineProperties","onError","props","setDirty","property","listen","attr","$root","totalBytes","nextRef","isSchema","fieldIndex","dynamicIndex","nextIterator","refId_1","getSchemaType","createTypeInstance","typeDef","refId_2","valueRef","iter","value_1","_triggerChanges","encodeAll","rootChangeTree","refIdsVisited","changeTrees","numChangeTrees","cl","beginIndex","tryEncodeTypeId","applyFilters","refIdsDissallowed","filteredBytes","_loop_1","clientHasRefId","isEncodeAll","indexWithFilter","discardAllChanges","targetType","defaultType","instance","_c","_d","_e","_f","_g","_h","_j","uniqueRefIds","$refs","_loop_2","dumpChanges","dump","currentStructure","reflectionContext","ReflectionField","ReflectionType","Reflection","rootSchemaType","reflection","rootType","buildType","currentType","fieldType","type_1","childTypeSchema","referencedType","type_2","schemaTypes","reflectionType","schemaType","refType","typeInfo","rootInstance","Room","rootSchema","onStateChange","onLeave","onJoin","hasJoined","onMessageHandlers","roomId","state","removeAllListeners","endpoint","devModeCloseCallback","room","connection","onMessageCallback","DEVMODE_RESTART","destroy","leave","consented","LEAVE_ROOM","CONSENTED","onMessage","getMessageHandlerKey","initialBytes","ROOM_DATA","encoded","sendBytes","ROOM_DATA_BYTES","getState","JOIN_ROOM","reconnectionToken","serializerId","handshake","ERROR","it_1","code_1","ROOM_DATA_SCHEMA","it_2","context_1","dispatchMessage","ROOM_STATE","setState","ROOM_STATE_PATCH","it_3","it_4","encodedState","binaryPatch","messageType","teardown","MatchMakeError","DEFAULT_ENDPOINT","location","hostname","protocol","replace","port","Client","settings","URL","useSSL","joinOrCreate","roomName","createMatchMakeRequest","joinById","reconnect","token","getAvailableRooms","getHttpEndpoint","consumeSeatReservation","previousRoom","targetRoom","createRoom","sessionId","buildEndpoint","devMode","retryCount","retryMaxRetries","retryReconnection","info","fromCodePoint","setTimeout","params","name_1","publicAddress","getEndpointPort","processId","segments","storage","getStorage","cc","sys","localStorage","setItem","getItem","removeItem","TOKEN_STORAGE","Platform","Auth","_id","username","displayName","avatarUrl","isAnonymous","email","lang","timezone","metadata","devices","facebookId","twitterId","googleId","gameCenterId","steamId","friendIds","blockedUserIds","createdAt","updatedAt","login","queryParams","hasToken","request","registerPingService","save","getFriends","getOnlineFriends","getFriendRequests","sendFriendRequest","friendId","userId","acceptFriendRequest","declineFriendRequest","blockUser","unblockUser","query","queryString","logout","unregisterPingService","keepOnlineInterval","setInterval","clearInterval","SchemaSerializer","rawState","patches","NoneSerializer","_cjsExports","_Protocol","_ErrorCode","_OPERATION","_ArraySchema","_CollectionSchema","_Context","_MapSchema","_Reflection","_ReflectionField","_ReflectionType","_Schema","_SchemaDefinition","_SetSchema","_decode","_defineTypes","_deprecated","_dumpChanges","_encode0","_filter","_filterChildren","_hasFilter","_registerType","_type","___esModule","__esModule","_Platform","_Auth","_Client","_Room","_SchemaSerializer","_registerSerializer"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nlet _cjsExports;\nlet _Protocol;\nlet _ErrorCode;\nlet _OPERATION;\nlet _ArraySchema;\nlet _CollectionSchema;\nlet _Context;\nlet _MapSchema;\nlet _Reflection;\nlet _ReflectionField;\nlet _ReflectionType;\nlet _Schema;\nlet _SchemaDefinition;\nlet _SetSchema;\nlet _decode;\nlet _defineTypes;\nlet _deprecated;\nlet _dumpChanges;\nlet _encode0;\nlet _filter;\nlet _filterChildren;\nlet _hasFilter;\nlet _registerType;\nlet _type;\nlet ___esModule;\nlet _Platform;\nlet _Auth;\nlet _Client;\nlet _Room;\nlet _SchemaSerializer;\nlet _registerSerializer;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n // colyseus.js@0.15.0 (@colyseus/schema 2.0.5)\n (function (global, factory) {\n     typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n     typeof define === 'function' && define.amd ? define('colyseus.js', ['exports'], factory) :\n     (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.Colyseus = {}));\n })(this, (function (exports) { 'use strict';\n\n     function _mergeNamespaces(n, m) {\n         m.forEach(function (e) {\n             e && typeof e !== 'string' && !Array.isArray(e) && Object.keys(e).forEach(function (k) {\n                 if (k !== 'default' && !(k in n)) {\n                     var d = Object.getOwnPropertyDescriptor(e, k);\n                     Object.defineProperty(n, k, d.get ? d : {\n                         enumerable: true,\n                         get: function () { return e[k]; }\n                     });\n                 }\n             });\n         });\n         return Object.freeze(n);\n     }\n\n     //\n     // Polyfills for legacy environments\n     //\n     /*\n      * Support Android 4.4.x\n      */\n     if (!ArrayBuffer.isView) {\n         ArrayBuffer.isView = function (a) {\n             return a !== null && typeof (a) === 'object' && a.buffer instanceof ArrayBuffer;\n         };\n     }\n     // Define globalThis if not available.\n     // https://github.com/colyseus/colyseus.js/issues/86\n     if (typeof (globalThis) === \"undefined\" &&\n         typeof (window) !== \"undefined\") {\n         // @ts-ignore\n         window['globalThis'] = window;\n     }\n\n     /******************************************************************************\r\n     Copyright (c) Microsoft Corporation.\r\n\r\n     Permission to use, copy, modify, and/or distribute this software for any\r\n     purpose with or without fee is hereby granted.\r\n\r\n     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n     REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n     AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n     INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n     LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n     OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n     PERFORMANCE OF THIS SOFTWARE.\r\n     ***************************************************************************** */\r\n     /* global Reflect, Promise */\r\n\r\n     var extendStatics = function(d, b) {\r\n         extendStatics = Object.setPrototypeOf ||\r\n             ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n             function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n         return extendStatics(d, b);\r\n     };\r\n\r\n     function __extends(d, b) {\r\n         if (typeof b !== \"function\" && b !== null)\r\n             throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n         extendStatics(d, b);\r\n         function __() { this.constructor = d; }\r\n         d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n     }\r\n\r\n     function __awaiter(thisArg, _arguments, P, generator) {\r\n         function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n         return new (P || (P = Promise))(function (resolve, reject) {\r\n             function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n             function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n             function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n             step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n         });\r\n     }\r\n\r\n     function __generator(thisArg, body) {\r\n         var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n         return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n         function verb(n) { return function (v) { return step([n, v]); }; }\r\n         function step(op) {\r\n             if (f) throw new TypeError(\"Generator is already executing.\");\r\n             while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n                 if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                 if (y = 0, t) op = [op[0] & 2, t.value];\r\n                 switch (op[0]) {\r\n                     case 0: case 1: t = op; break;\r\n                     case 4: _.label++; return { value: op[1], done: false };\r\n                     case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                     case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                     default:\r\n                         if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                         if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                         if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                         if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                         if (t[2]) _.ops.pop();\r\n                         _.trys.pop(); continue;\r\n                 }\r\n                 op = body.call(thisArg, _);\r\n             } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n             if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n         }\r\n     }\n\n     function apply(src, tar) {\n     \ttar.headers = src.headers || {};\n     \ttar.statusMessage = src.statusText;\n     \ttar.statusCode = src.status;\n     \ttar.data = src.response;\n     }\n\n     function send(method, uri, opts) {\n     \treturn new Promise(function (res, rej) {\n     \t\topts = opts || {};\n     \t\tvar req = new XMLHttpRequest;\n     \t\tvar k, tmp, arr, str=opts.body;\n     \t\tvar headers = opts.headers || {};\n\n     \t\t// IE compatible\n     \t\tif (opts.timeout) req.timeout = opts.timeout;\n     \t\treq.ontimeout = req.onerror = function (err) {\n     \t\t\terr.timeout = err.type == 'timeout';\n     \t\t\trej(err);\n     \t\t};\n\n     \t\treq.open(method, uri.href || uri);\n\n     \t\treq.onload = function () {\n     \t\t\tarr = req.getAllResponseHeaders().trim().split(/[\\r\\n]+/);\n     \t\t\tapply(req, req); //=> req.headers\n\n     \t\t\twhile (tmp = arr.shift()) {\n     \t\t\t\ttmp = tmp.split(': ');\n     \t\t\t\treq.headers[tmp.shift().toLowerCase()] = tmp.join(': ');\n     \t\t\t}\n\n     \t\t\ttmp = req.headers['content-type'];\n     \t\t\tif (tmp && !!~tmp.indexOf('application/json')) {\n     \t\t\t\ttry {\n     \t\t\t\t\treq.data = JSON.parse(req.data, opts.reviver);\n     \t\t\t\t} catch (err) {\n     \t\t\t\t\tapply(req, err);\n     \t\t\t\t\treturn rej(err);\n     \t\t\t\t}\n     \t\t\t}\n\n     \t\t\t(req.status >= 400 ? rej : res)(req);\n     \t\t};\n\n     \t\tif (typeof FormData < 'u' && str instanceof FormData) ; else if (str && typeof str == 'object') {\n     \t\t\theaders['content-type'] = 'application/json';\n     \t\t\tstr = JSON.stringify(str);\n     \t\t}\n\n     \t\treq.withCredentials = !!opts.withCredentials;\n\n     \t\tfor (k in headers) {\n     \t\t\treq.setRequestHeader(k, headers[k]);\n     \t\t}\n\n     \t\treq.send(str);\n     \t});\n     }\n\n     var get = /*#__PURE__*/ send.bind(send, 'GET');\n     var post = /*#__PURE__*/ send.bind(send, 'POST');\n     var patch = /*#__PURE__*/ send.bind(send, 'PATCH');\n     var del = /*#__PURE__*/ send.bind(send, 'DELETE');\n     var put = /*#__PURE__*/ send.bind(send, 'PUT');\n\n     var del_1 = del;\n     var get_1 = get;\n     var patch_1 = patch;\n     var post_1 = post;\n     var put_1 = put;\n     var send_1 = send;\n\n     var xhr = {\n     \tdel: del_1,\n     \tget: get_1,\n     \tpatch: patch_1,\n     \tpost: post_1,\n     \tput: put_1,\n     \tsend: send_1\n     };\n\n     var http = /*#__PURE__*/_mergeNamespaces({\n         __proto__: null,\n         'default': xhr,\n         del: del_1,\n         get: get_1,\n         patch: patch_1,\n         post: post_1,\n         put: put_1,\n         send: send_1\n     }, [xhr]);\n\n     var CloseCode;\n     (function (CloseCode) {\n         CloseCode[CloseCode[\"CONSENTED\"] = 4000] = \"CONSENTED\";\n         CloseCode[CloseCode[\"DEVMODE_RESTART\"] = 4010] = \"DEVMODE_RESTART\";\n     })(CloseCode || (CloseCode = {}));\n     var ServerError = /** @class */ (function (_super) {\n         __extends(ServerError, _super);\n         function ServerError(code, message) {\n             var _this = _super.call(this, message) || this;\n             _this.name = \"ServerError\";\n             _this.code = code;\n             return _this;\n         }\n         return ServerError;\n     }(Error));\n\n     /**\n      * Copyright (c) 2014 Ion Drive Software Ltd.\n      * https://github.com/darrachequesne/notepack/\n      *\n      * Permission is hereby granted, free of charge, to any person obtaining a copy\n      * of this software and associated documentation files (the \"Software\"), to deal\n      * in the Software without restriction, including without limitation the rights\n      * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n      * copies of the Software, and to permit persons to whom the Software is\n      * furnished to do so, subject to the following conditions:\n      *\n      * The above copyright notice and this permission notice shall be included in all\n      * copies or substantial portions of the Software.\n      *\n      * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n      * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n      * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n      * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n      * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n      * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n      * SOFTWARE.\n      */\n     /**\n      * Patch for Colyseus:\n      * -------------------\n      *\n      * added `offset` on Decoder constructor, for messages arriving with a code\n      * before actual msgpack data\n      */\n     // \n     // DECODER\n     // \n     function Decoder(buffer, offset) {\n         this._offset = offset;\n         if (buffer instanceof ArrayBuffer) {\n             this._buffer = buffer;\n             this._view = new DataView(this._buffer);\n         }\n         else if (ArrayBuffer.isView(buffer)) {\n             this._buffer = buffer.buffer;\n             this._view = new DataView(this._buffer, buffer.byteOffset, buffer.byteLength);\n         }\n         else {\n             throw new Error('Invalid argument');\n         }\n     }\n     function utf8Read$1(view, offset, length) {\n         var string = '', chr = 0;\n         for (var i = offset, end = offset + length; i < end; i++) {\n             var byte = view.getUint8(i);\n             if ((byte & 0x80) === 0x00) {\n                 string += String.fromCharCode(byte);\n                 continue;\n             }\n             if ((byte & 0xe0) === 0xc0) {\n                 string += String.fromCharCode(((byte & 0x1f) << 6) |\n                     (view.getUint8(++i) & 0x3f));\n                 continue;\n             }\n             if ((byte & 0xf0) === 0xe0) {\n                 string += String.fromCharCode(((byte & 0x0f) << 12) |\n                     ((view.getUint8(++i) & 0x3f) << 6) |\n                     ((view.getUint8(++i) & 0x3f) << 0));\n                 continue;\n             }\n             if ((byte & 0xf8) === 0xf0) {\n                 chr = ((byte & 0x07) << 18) |\n                     ((view.getUint8(++i) & 0x3f) << 12) |\n                     ((view.getUint8(++i) & 0x3f) << 6) |\n                     ((view.getUint8(++i) & 0x3f) << 0);\n                 if (chr >= 0x010000) { // surrogate pair\n                     chr -= 0x010000;\n                     string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n                 }\n                 else {\n                     string += String.fromCharCode(chr);\n                 }\n                 continue;\n             }\n             throw new Error('Invalid byte ' + byte.toString(16));\n         }\n         return string;\n     }\n     Decoder.prototype._array = function (length) {\n         var value = new Array(length);\n         for (var i = 0; i < length; i++) {\n             value[i] = this._parse();\n         }\n         return value;\n     };\n     Decoder.prototype._map = function (length) {\n         var key = '', value = {};\n         for (var i = 0; i < length; i++) {\n             key = this._parse();\n             value[key] = this._parse();\n         }\n         return value;\n     };\n     Decoder.prototype._str = function (length) {\n         var value = utf8Read$1(this._view, this._offset, length);\n         this._offset += length;\n         return value;\n     };\n     Decoder.prototype._bin = function (length) {\n         var value = this._buffer.slice(this._offset, this._offset + length);\n         this._offset += length;\n         return value;\n     };\n     Decoder.prototype._parse = function () {\n         var prefix = this._view.getUint8(this._offset++);\n         var value, length = 0, type = 0, hi = 0, lo = 0;\n         if (prefix < 0xc0) {\n             // positive fixint\n             if (prefix < 0x80) {\n                 return prefix;\n             }\n             // fixmap\n             if (prefix < 0x90) {\n                 return this._map(prefix & 0x0f);\n             }\n             // fixarray\n             if (prefix < 0xa0) {\n                 return this._array(prefix & 0x0f);\n             }\n             // fixstr\n             return this._str(prefix & 0x1f);\n         }\n         // negative fixint\n         if (prefix > 0xdf) {\n             return (0xff - prefix + 1) * -1;\n         }\n         switch (prefix) {\n             // nil\n             case 0xc0:\n                 return null;\n             // false\n             case 0xc2:\n                 return false;\n             // true\n             case 0xc3:\n                 return true;\n             // bin\n             case 0xc4:\n                 length = this._view.getUint8(this._offset);\n                 this._offset += 1;\n                 return this._bin(length);\n             case 0xc5:\n                 length = this._view.getUint16(this._offset);\n                 this._offset += 2;\n                 return this._bin(length);\n             case 0xc6:\n                 length = this._view.getUint32(this._offset);\n                 this._offset += 4;\n                 return this._bin(length);\n             // ext\n             case 0xc7:\n                 length = this._view.getUint8(this._offset);\n                 type = this._view.getInt8(this._offset + 1);\n                 this._offset += 2;\n                 return [type, this._bin(length)];\n             case 0xc8:\n                 length = this._view.getUint16(this._offset);\n                 type = this._view.getInt8(this._offset + 2);\n                 this._offset += 3;\n                 return [type, this._bin(length)];\n             case 0xc9:\n                 length = this._view.getUint32(this._offset);\n                 type = this._view.getInt8(this._offset + 4);\n                 this._offset += 5;\n                 return [type, this._bin(length)];\n             // float\n             case 0xca:\n                 value = this._view.getFloat32(this._offset);\n                 this._offset += 4;\n                 return value;\n             case 0xcb:\n                 value = this._view.getFloat64(this._offset);\n                 this._offset += 8;\n                 return value;\n             // uint\n             case 0xcc:\n                 value = this._view.getUint8(this._offset);\n                 this._offset += 1;\n                 return value;\n             case 0xcd:\n                 value = this._view.getUint16(this._offset);\n                 this._offset += 2;\n                 return value;\n             case 0xce:\n                 value = this._view.getUint32(this._offset);\n                 this._offset += 4;\n                 return value;\n             case 0xcf:\n                 hi = this._view.getUint32(this._offset) * Math.pow(2, 32);\n                 lo = this._view.getUint32(this._offset + 4);\n                 this._offset += 8;\n                 return hi + lo;\n             // int\n             case 0xd0:\n                 value = this._view.getInt8(this._offset);\n                 this._offset += 1;\n                 return value;\n             case 0xd1:\n                 value = this._view.getInt16(this._offset);\n                 this._offset += 2;\n                 return value;\n             case 0xd2:\n                 value = this._view.getInt32(this._offset);\n                 this._offset += 4;\n                 return value;\n             case 0xd3:\n                 hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n                 lo = this._view.getUint32(this._offset + 4);\n                 this._offset += 8;\n                 return hi + lo;\n             // fixext\n             case 0xd4:\n                 type = this._view.getInt8(this._offset);\n                 this._offset += 1;\n                 if (type === 0x00) {\n                     this._offset += 1;\n                     return void 0;\n                 }\n                 return [type, this._bin(1)];\n             case 0xd5:\n                 type = this._view.getInt8(this._offset);\n                 this._offset += 1;\n                 return [type, this._bin(2)];\n             case 0xd6:\n                 type = this._view.getInt8(this._offset);\n                 this._offset += 1;\n                 return [type, this._bin(4)];\n             case 0xd7:\n                 type = this._view.getInt8(this._offset);\n                 this._offset += 1;\n                 if (type === 0x00) {\n                     hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n                     lo = this._view.getUint32(this._offset + 4);\n                     this._offset += 8;\n                     return new Date(hi + lo);\n                 }\n                 return [type, this._bin(8)];\n             case 0xd8:\n                 type = this._view.getInt8(this._offset);\n                 this._offset += 1;\n                 return [type, this._bin(16)];\n             // str\n             case 0xd9:\n                 length = this._view.getUint8(this._offset);\n                 this._offset += 1;\n                 return this._str(length);\n             case 0xda:\n                 length = this._view.getUint16(this._offset);\n                 this._offset += 2;\n                 return this._str(length);\n             case 0xdb:\n                 length = this._view.getUint32(this._offset);\n                 this._offset += 4;\n                 return this._str(length);\n             // array\n             case 0xdc:\n                 length = this._view.getUint16(this._offset);\n                 this._offset += 2;\n                 return this._array(length);\n             case 0xdd:\n                 length = this._view.getUint32(this._offset);\n                 this._offset += 4;\n                 return this._array(length);\n             // map\n             case 0xde:\n                 length = this._view.getUint16(this._offset);\n                 this._offset += 2;\n                 return this._map(length);\n             case 0xdf:\n                 length = this._view.getUint32(this._offset);\n                 this._offset += 4;\n                 return this._map(length);\n         }\n         throw new Error('Could not parse');\n     };\n     function decode(buffer, offset) {\n         if (offset === void 0) { offset = 0; }\n         var decoder = new Decoder(buffer, offset);\n         var value = decoder._parse();\n         if (decoder._offset !== buffer.byteLength) {\n             throw new Error((buffer.byteLength - decoder._offset) + ' trailing bytes');\n         }\n         return value;\n     }\n     // \n     // ENCODER\n     // \n     function utf8Write(view, offset, str) {\n         var c = 0;\n         for (var i = 0, l = str.length; i < l; i++) {\n             c = str.charCodeAt(i);\n             if (c < 0x80) {\n                 view.setUint8(offset++, c);\n             }\n             else if (c < 0x800) {\n                 view.setUint8(offset++, 0xc0 | (c >> 6));\n                 view.setUint8(offset++, 0x80 | (c & 0x3f));\n             }\n             else if (c < 0xd800 || c >= 0xe000) {\n                 view.setUint8(offset++, 0xe0 | (c >> 12));\n                 view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n                 view.setUint8(offset++, 0x80 | (c & 0x3f));\n             }\n             else {\n                 i++;\n                 c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n                 view.setUint8(offset++, 0xf0 | (c >> 18));\n                 view.setUint8(offset++, 0x80 | (c >> 12) & 0x3f);\n                 view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n                 view.setUint8(offset++, 0x80 | (c & 0x3f));\n             }\n         }\n     }\n     function utf8Length$1(str) {\n         var c = 0, length = 0;\n         for (var i = 0, l = str.length; i < l; i++) {\n             c = str.charCodeAt(i);\n             if (c < 0x80) {\n                 length += 1;\n             }\n             else if (c < 0x800) {\n                 length += 2;\n             }\n             else if (c < 0xd800 || c >= 0xe000) {\n                 length += 3;\n             }\n             else {\n                 i++;\n                 length += 4;\n             }\n         }\n         return length;\n     }\n     function _encode(bytes, defers, value) {\n         var type = typeof value, i = 0, l = 0, hi = 0, lo = 0, length = 0, size = 0;\n         if (type === 'string') {\n             length = utf8Length$1(value);\n             // fixstr\n             if (length < 0x20) {\n                 bytes.push(length | 0xa0);\n                 size = 1;\n             }\n             // str 8\n             else if (length < 0x100) {\n                 bytes.push(0xd9, length);\n                 size = 2;\n             }\n             // str 16\n             else if (length < 0x10000) {\n                 bytes.push(0xda, length >> 8, length);\n                 size = 3;\n             }\n             // str 32\n             else if (length < 0x100000000) {\n                 bytes.push(0xdb, length >> 24, length >> 16, length >> 8, length);\n                 size = 5;\n             }\n             else {\n                 throw new Error('String too long');\n             }\n             defers.push({ _str: value, _length: length, _offset: bytes.length });\n             return size + length;\n         }\n         if (type === 'number') {\n             // TODO: encode to float 32?\n             // float 64\n             if (Math.floor(value) !== value || !isFinite(value)) {\n                 bytes.push(0xcb);\n                 defers.push({ _float: value, _length: 8, _offset: bytes.length });\n                 return 9;\n             }\n             if (value >= 0) {\n                 // positive fixnum\n                 if (value < 0x80) {\n                     bytes.push(value);\n                     return 1;\n                 }\n                 // uint 8\n                 if (value < 0x100) {\n                     bytes.push(0xcc, value);\n                     return 2;\n                 }\n                 // uint 16\n                 if (value < 0x10000) {\n                     bytes.push(0xcd, value >> 8, value);\n                     return 3;\n                 }\n                 // uint 32\n                 if (value < 0x100000000) {\n                     bytes.push(0xce, value >> 24, value >> 16, value >> 8, value);\n                     return 5;\n                 }\n                 // uint 64\n                 hi = (value / Math.pow(2, 32)) >> 0;\n                 lo = value >>> 0;\n                 bytes.push(0xcf, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n                 return 9;\n             }\n             else {\n                 // negative fixnum\n                 if (value >= -0x20) {\n                     bytes.push(value);\n                     return 1;\n                 }\n                 // int 8\n                 if (value >= -0x80) {\n                     bytes.push(0xd0, value);\n                     return 2;\n                 }\n                 // int 16\n                 if (value >= -0x8000) {\n                     bytes.push(0xd1, value >> 8, value);\n                     return 3;\n                 }\n                 // int 32\n                 if (value >= -0x80000000) {\n                     bytes.push(0xd2, value >> 24, value >> 16, value >> 8, value);\n                     return 5;\n                 }\n                 // int 64\n                 hi = Math.floor(value / Math.pow(2, 32));\n                 lo = value >>> 0;\n                 bytes.push(0xd3, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n                 return 9;\n             }\n         }\n         if (type === 'object') {\n             // nil\n             if (value === null) {\n                 bytes.push(0xc0);\n                 return 1;\n             }\n             if (Array.isArray(value)) {\n                 length = value.length;\n                 // fixarray\n                 if (length < 0x10) {\n                     bytes.push(length | 0x90);\n                     size = 1;\n                 }\n                 // array 16\n                 else if (length < 0x10000) {\n                     bytes.push(0xdc, length >> 8, length);\n                     size = 3;\n                 }\n                 // array 32\n                 else if (length < 0x100000000) {\n                     bytes.push(0xdd, length >> 24, length >> 16, length >> 8, length);\n                     size = 5;\n                 }\n                 else {\n                     throw new Error('Array too large');\n                 }\n                 for (i = 0; i < length; i++) {\n                     size += _encode(bytes, defers, value[i]);\n                 }\n                 return size;\n             }\n             // fixext 8 / Date\n             if (value instanceof Date) {\n                 var time = value.getTime();\n                 hi = Math.floor(time / Math.pow(2, 32));\n                 lo = time >>> 0;\n                 bytes.push(0xd7, 0, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n                 return 10;\n             }\n             if (value instanceof ArrayBuffer) {\n                 length = value.byteLength;\n                 // bin 8\n                 if (length < 0x100) {\n                     bytes.push(0xc4, length);\n                     size = 2;\n                 }\n                 else \n                 // bin 16\n                 if (length < 0x10000) {\n                     bytes.push(0xc5, length >> 8, length);\n                     size = 3;\n                 }\n                 else \n                 // bin 32\n                 if (length < 0x100000000) {\n                     bytes.push(0xc6, length >> 24, length >> 16, length >> 8, length);\n                     size = 5;\n                 }\n                 else {\n                     throw new Error('Buffer too large');\n                 }\n                 defers.push({ _bin: value, _length: length, _offset: bytes.length });\n                 return size + length;\n             }\n             if (typeof value.toJSON === 'function') {\n                 return _encode(bytes, defers, value.toJSON());\n             }\n             var keys = [], key = '';\n             var allKeys = Object.keys(value);\n             for (i = 0, l = allKeys.length; i < l; i++) {\n                 key = allKeys[i];\n                 if (typeof value[key] !== 'function') {\n                     keys.push(key);\n                 }\n             }\n             length = keys.length;\n             // fixmap\n             if (length < 0x10) {\n                 bytes.push(length | 0x80);\n                 size = 1;\n             }\n             // map 16\n             else if (length < 0x10000) {\n                 bytes.push(0xde, length >> 8, length);\n                 size = 3;\n             }\n             // map 32\n             else if (length < 0x100000000) {\n                 bytes.push(0xdf, length >> 24, length >> 16, length >> 8, length);\n                 size = 5;\n             }\n             else {\n                 throw new Error('Object too large');\n             }\n             for (i = 0; i < length; i++) {\n                 key = keys[i];\n                 size += _encode(bytes, defers, key);\n                 size += _encode(bytes, defers, value[key]);\n             }\n             return size;\n         }\n         // false/true\n         if (type === 'boolean') {\n             bytes.push(value ? 0xc3 : 0xc2);\n             return 1;\n         }\n         // fixext 1 / undefined\n         if (type === 'undefined') {\n             bytes.push(0xd4, 0, 0);\n             return 3;\n         }\n         throw new Error('Could not encode');\n     }\n     function encode(value) {\n         var bytes = [];\n         var defers = [];\n         var size = _encode(bytes, defers, value);\n         var buf = new ArrayBuffer(size);\n         var view = new DataView(buf);\n         var deferIndex = 0;\n         var deferWritten = 0;\n         var nextOffset = -1;\n         if (defers.length > 0) {\n             nextOffset = defers[0]._offset;\n         }\n         var defer, deferLength = 0, offset = 0;\n         for (var i = 0, l = bytes.length; i < l; i++) {\n             view.setUint8(deferWritten + i, bytes[i]);\n             if (i + 1 !== nextOffset) {\n                 continue;\n             }\n             defer = defers[deferIndex];\n             deferLength = defer._length;\n             offset = deferWritten + nextOffset;\n             if (defer._bin) {\n                 var bin = new Uint8Array(defer._bin);\n                 for (var j = 0; j < deferLength; j++) {\n                     view.setUint8(offset + j, bin[j]);\n                 }\n             }\n             else if (defer._str) {\n                 utf8Write(view, offset, defer._str);\n             }\n             else if (defer._float !== undefined) {\n                 view.setFloat64(offset, defer._float);\n             }\n             deferIndex++;\n             deferWritten += deferLength;\n             if (defers[deferIndex]) {\n                 nextOffset = defers[deferIndex]._offset;\n             }\n         }\n         return buf;\n     }\n\n     var browser = function () {\n       throw new Error(\n         'ws does not work in the browser. Browser clients must use the native ' +\n           'WebSocket object'\n       );\n     };\n\n     var WebSocket = globalThis.WebSocket || browser;\n     var WebSocketTransport = /** @class */ (function () {\n         function WebSocketTransport(events) {\n             this.events = events;\n         }\n         WebSocketTransport.prototype.send = function (data) {\n             if (data instanceof ArrayBuffer) {\n                 this.ws.send(data);\n             }\n             else if (Array.isArray(data)) {\n                 this.ws.send((new Uint8Array(data)).buffer);\n             }\n         };\n         WebSocketTransport.prototype.connect = function (url) {\n             this.ws = new WebSocket(url, this.protocols);\n             this.ws.binaryType = 'arraybuffer';\n             this.ws.onopen = this.events.onopen;\n             this.ws.onmessage = this.events.onmessage;\n             this.ws.onclose = this.events.onclose;\n             this.ws.onerror = this.events.onerror;\n         };\n         WebSocketTransport.prototype.close = function (code, reason) {\n             this.ws.close(code, reason);\n         };\n         return WebSocketTransport;\n     }());\n\n     var Connection = /** @class */ (function () {\n         function Connection() {\n             this.events = {};\n             this.transport = new WebSocketTransport(this.events);\n         }\n         Connection.prototype.send = function (data) {\n             this.transport.send(data);\n         };\n         Connection.prototype.connect = function (url) {\n             this.transport.connect(url);\n         };\n         Connection.prototype.close = function (code, reason) {\n             this.transport.close(code, reason);\n         };\n         return Connection;\n     }());\n\n     // Use codes between 0~127 for lesser throughput (1 byte)\n     exports.Protocol = void 0;\n     (function (Protocol) {\n         // Room-related (10~19)\n         Protocol[Protocol[\"HANDSHAKE\"] = 9] = \"HANDSHAKE\";\n         Protocol[Protocol[\"JOIN_ROOM\"] = 10] = \"JOIN_ROOM\";\n         Protocol[Protocol[\"ERROR\"] = 11] = \"ERROR\";\n         Protocol[Protocol[\"LEAVE_ROOM\"] = 12] = \"LEAVE_ROOM\";\n         Protocol[Protocol[\"ROOM_DATA\"] = 13] = \"ROOM_DATA\";\n         Protocol[Protocol[\"ROOM_STATE\"] = 14] = \"ROOM_STATE\";\n         Protocol[Protocol[\"ROOM_STATE_PATCH\"] = 15] = \"ROOM_STATE_PATCH\";\n         Protocol[Protocol[\"ROOM_DATA_SCHEMA\"] = 16] = \"ROOM_DATA_SCHEMA\";\n         Protocol[Protocol[\"ROOM_DATA_BYTES\"] = 17] = \"ROOM_DATA_BYTES\";\n     })(exports.Protocol || (exports.Protocol = {}));\n     exports.ErrorCode = void 0;\n     (function (ErrorCode) {\n         ErrorCode[ErrorCode[\"MATCHMAKE_NO_HANDLER\"] = 4210] = \"MATCHMAKE_NO_HANDLER\";\n         ErrorCode[ErrorCode[\"MATCHMAKE_INVALID_CRITERIA\"] = 4211] = \"MATCHMAKE_INVALID_CRITERIA\";\n         ErrorCode[ErrorCode[\"MATCHMAKE_INVALID_ROOM_ID\"] = 4212] = \"MATCHMAKE_INVALID_ROOM_ID\";\n         ErrorCode[ErrorCode[\"MATCHMAKE_UNHANDLED\"] = 4213] = \"MATCHMAKE_UNHANDLED\";\n         ErrorCode[ErrorCode[\"MATCHMAKE_EXPIRED\"] = 4214] = \"MATCHMAKE_EXPIRED\";\n         ErrorCode[ErrorCode[\"AUTH_FAILED\"] = 4215] = \"AUTH_FAILED\";\n         ErrorCode[ErrorCode[\"APPLICATION_ERROR\"] = 4216] = \"APPLICATION_ERROR\";\n     })(exports.ErrorCode || (exports.ErrorCode = {}));\n     function utf8Read(view, offset) {\n         var length = view[offset++];\n         var string = '', chr = 0;\n         for (var i = offset, end = offset + length; i < end; i++) {\n             var byte = view[i];\n             if ((byte & 0x80) === 0x00) {\n                 string += String.fromCharCode(byte);\n                 continue;\n             }\n             if ((byte & 0xe0) === 0xc0) {\n                 string += String.fromCharCode(((byte & 0x1f) << 6) |\n                     (view[++i] & 0x3f));\n                 continue;\n             }\n             if ((byte & 0xf0) === 0xe0) {\n                 string += String.fromCharCode(((byte & 0x0f) << 12) |\n                     ((view[++i] & 0x3f) << 6) |\n                     ((view[++i] & 0x3f) << 0));\n                 continue;\n             }\n             if ((byte & 0xf8) === 0xf0) {\n                 chr = ((byte & 0x07) << 18) |\n                     ((view[++i] & 0x3f) << 12) |\n                     ((view[++i] & 0x3f) << 6) |\n                     ((view[++i] & 0x3f) << 0);\n                 if (chr >= 0x010000) { // surrogate pair\n                     chr -= 0x010000;\n                     string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n                 }\n                 else {\n                     string += String.fromCharCode(chr);\n                 }\n                 continue;\n             }\n             throw new Error('Invalid byte ' + byte.toString(16));\n         }\n         return string;\n     }\n     // Faster for short strings than Buffer.byteLength\n     function utf8Length(str) {\n         if (str === void 0) { str = ''; }\n         var c = 0;\n         var length = 0;\n         for (var i = 0, l = str.length; i < l; i++) {\n             c = str.charCodeAt(i);\n             if (c < 0x80) {\n                 length += 1;\n             }\n             else if (c < 0x800) {\n                 length += 2;\n             }\n             else if (c < 0xd800 || c >= 0xe000) {\n                 length += 3;\n             }\n             else {\n                 i++;\n                 length += 4;\n             }\n         }\n         return length + 1;\n     }\n\n     var serializers = {};\n     function registerSerializer(id, serializer) {\n         serializers[id] = serializer;\n     }\n     function getSerializer(id) {\n         var serializer = serializers[id];\n         if (!serializer) {\n             throw new Error(\"missing serializer: \" + id);\n         }\n         return serializer;\n     }\n\n     let createNanoEvents = () => ({\n       events: {},\n       emit(event, ...args) {\n     (this.events[event] || []).forEach(i => i(...args));\n       },\n       on(event, cb) {\n     (this.events[event] = this.events[event] || []).push(cb);\n         return () =>\n           (this.events[event] = (this.events[event] || []).filter(i => i !== cb))\n       }\n     });\n\n     var EventEmitter = /** @class */ (function () {\n         function EventEmitter() {\n             this.handlers = [];\n         }\n         EventEmitter.prototype.register = function (cb, once) {\n             this.handlers.push(cb);\n             return this;\n         };\n         EventEmitter.prototype.invoke = function () {\n             var _this = this;\n             var args = [];\n             for (var _i = 0; _i < arguments.length; _i++) {\n                 args[_i] = arguments[_i];\n             }\n             this.handlers.forEach(function (handler) { return handler.apply(_this, args); });\n         };\n         EventEmitter.prototype.invokeAsync = function () {\n             var _this = this;\n             var args = [];\n             for (var _i = 0; _i < arguments.length; _i++) {\n                 args[_i] = arguments[_i];\n             }\n             return Promise.all(this.handlers.map(function (handler) { return handler.apply(_this, args); }));\n         };\n         EventEmitter.prototype.remove = function (cb) {\n             var index = this.handlers.indexOf(cb);\n             this.handlers[index] = this.handlers[this.handlers.length - 1];\n             this.handlers.pop();\n         };\n         EventEmitter.prototype.clear = function () {\n             this.handlers = [];\n         };\n         return EventEmitter;\n     }());\n     function createSignal() {\n         var emitter = new EventEmitter();\n         function register(cb) {\n             return emitter.register(cb, this === null);\n         }\n         register.once = function (cb) {\n             var callback = function () {\n                 var args = [];\n                 for (var _i = 0; _i < arguments.length; _i++) {\n                     args[_i] = arguments[_i];\n                 }\n                 cb.apply(this, args);\n                 emitter.remove(callback);\n             };\n             emitter.register(callback);\n         };\n         register.remove = function (cb) { return emitter.remove(cb); };\n         register.invoke = function () {\n             var args = [];\n             for (var _i = 0; _i < arguments.length; _i++) {\n                 args[_i] = arguments[_i];\n             }\n             return emitter.invoke.apply(emitter, args);\n         };\n         register.invokeAsync = function () {\n             var args = [];\n             for (var _i = 0; _i < arguments.length; _i++) {\n                 args[_i] = arguments[_i];\n             }\n             return emitter.invokeAsync.apply(emitter, args);\n         };\n         register.clear = function () { return emitter.clear(); };\n         return register;\n     }\n\n     var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n     function createCommonjsModule(fn) {\n       var module = { exports: {} };\n     \treturn fn(module, module.exports), module.exports;\n     }\n\n     var umd = createCommonjsModule(function (module, exports) {\n     (function (global, factory) {\n         factory(exports) ;\n     })(commonjsGlobal, (function (exports) {\n         /******************************************************************************\r\n         Copyright (c) Microsoft Corporation.\r\n\r\n         Permission to use, copy, modify, and/or distribute this software for any\r\n         purpose with or without fee is hereby granted.\r\n\r\n         THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n         REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n         AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n         INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n         LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n         OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n         PERFORMANCE OF THIS SOFTWARE.\r\n         ***************************************************************************** */\r\n         /* global Reflect, Promise */\r\n\r\n         var extendStatics = function(d, b) {\r\n             extendStatics = Object.setPrototypeOf ||\r\n                 ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n                 function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n             return extendStatics(d, b);\r\n         };\r\n\r\n         function __extends(d, b) {\r\n             if (typeof b !== \"function\" && b !== null)\r\n                 throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n             extendStatics(d, b);\r\n             function __() { this.constructor = d; }\r\n             d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n         }\r\n\r\n         function __decorate(decorators, target, key, desc) {\r\n             var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n             if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n             else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n             return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n         }\r\n\r\n         function __spreadArray(to, from, pack) {\r\n             if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n                 if (ar || !(i in from)) {\r\n                     if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n                     ar[i] = from[i];\r\n                 }\r\n             }\r\n             return to.concat(ar || Array.prototype.slice.call(from));\r\n         }\n\n         // export const SWITCH_TO_STRUCTURE = 193; (easily collides with DELETE_AND_ADD + fieldIndex = 2)\n         var SWITCH_TO_STRUCTURE = 255; // (decoding collides with DELETE_AND_ADD + fieldIndex = 63)\n         var TYPE_ID = 213;\n         /**\n          * Encoding Schema field operations.\n          */\n         exports.OPERATION = void 0;\n         (function (OPERATION) {\n             // add new structure/primitive\n             OPERATION[OPERATION[\"ADD\"] = 128] = \"ADD\";\n             // replace structure/primitive\n             OPERATION[OPERATION[\"REPLACE\"] = 0] = \"REPLACE\";\n             // delete field\n             OPERATION[OPERATION[\"DELETE\"] = 64] = \"DELETE\";\n             // DELETE field, followed by an ADD\n             OPERATION[OPERATION[\"DELETE_AND_ADD\"] = 192] = \"DELETE_AND_ADD\";\n             // TOUCH is used to determine hierarchy of nested Schema structures during serialization.\n             // touches are NOT encoded.\n             OPERATION[OPERATION[\"TOUCH\"] = 1] = \"TOUCH\";\n             // MapSchema Operations\n             OPERATION[OPERATION[\"CLEAR\"] = 10] = \"CLEAR\";\n         })(exports.OPERATION || (exports.OPERATION = {}));\n         // export enum OPERATION {\n         //     // add new structure/primitive\n         //     // (128)\n         //     ADD = 128, // 10000000,\n         //     // replace structure/primitive\n         //     REPLACE = 1,// 00000001\n         //     // delete field\n         //     DELETE = 192, // 11000000\n         //     // DELETE field, followed by an ADD\n         //     DELETE_AND_ADD = 224, // 11100000\n         //     // TOUCH is used to determine hierarchy of nested Schema structures during serialization.\n         //     // touches are NOT encoded.\n         //     TOUCH = 0, // 00000000\n         //     // MapSchema Operations\n         //     CLEAR = 10,\n         // }\n\n         var ChangeTree = /** @class */ (function () {\n             function ChangeTree(ref, parent, root) {\n                 this.changed = false;\n                 this.changes = new Map();\n                 this.allChanges = new Set();\n                 // cached indexes for filtering\n                 this.caches = {};\n                 this.currentCustomOperation = 0;\n                 this.ref = ref;\n                 this.setParent(parent, root);\n             }\n             ChangeTree.prototype.setParent = function (parent, root, parentIndex) {\n                 var _this = this;\n                 if (!this.indexes) {\n                     this.indexes = (this.ref instanceof Schema)\n                         ? this.ref['_definition'].indexes\n                         : {};\n                 }\n                 this.parent = parent;\n                 this.parentIndex = parentIndex;\n                 // avoid setting parents with empty `root`\n                 if (!root) {\n                     return;\n                 }\n                 this.root = root;\n                 //\n                 // assign same parent on child structures\n                 //\n                 if (this.ref instanceof Schema) {\n                     var definition = this.ref['_definition'];\n                     for (var field in definition.schema) {\n                         var value = this.ref[field];\n                         if (value && value['$changes']) {\n                             var parentIndex_1 = definition.indexes[field];\n                             value['$changes'].setParent(this.ref, root, parentIndex_1);\n                         }\n                     }\n                 }\n                 else if (typeof (this.ref) === \"object\") {\n                     this.ref.forEach(function (value, key) {\n                         if (value instanceof Schema) {\n                             var changeTreee = value['$changes'];\n                             var parentIndex_2 = _this.ref['$changes'].indexes[key];\n                             changeTreee.setParent(_this.ref, _this.root, parentIndex_2);\n                         }\n                     });\n                 }\n             };\n             ChangeTree.prototype.operation = function (op) {\n                 this.changes.set(--this.currentCustomOperation, op);\n             };\n             ChangeTree.prototype.change = function (fieldName, operation) {\n                 if (operation === void 0) { operation = exports.OPERATION.ADD; }\n                 var index = (typeof (fieldName) === \"number\")\n                     ? fieldName\n                     : this.indexes[fieldName];\n                 this.assertValidIndex(index, fieldName);\n                 var previousChange = this.changes.get(index);\n                 if (!previousChange ||\n                     previousChange.op === exports.OPERATION.DELETE ||\n                     previousChange.op === exports.OPERATION.TOUCH // (mazmorra.io's BattleAction issue)\n                 ) {\n                     this.changes.set(index, {\n                         op: (!previousChange)\n                             ? operation\n                             : (previousChange.op === exports.OPERATION.DELETE)\n                                 ? exports.OPERATION.DELETE_AND_ADD\n                                 : operation,\n                         // : OPERATION.REPLACE,\n                         index: index\n                     });\n                 }\n                 this.allChanges.add(index);\n                 this.changed = true;\n                 this.touchParents();\n             };\n             ChangeTree.prototype.touch = function (fieldName) {\n                 var index = (typeof (fieldName) === \"number\")\n                     ? fieldName\n                     : this.indexes[fieldName];\n                 this.assertValidIndex(index, fieldName);\n                 if (!this.changes.has(index)) {\n                     this.changes.set(index, { op: exports.OPERATION.TOUCH, index: index });\n                 }\n                 this.allChanges.add(index);\n                 // ensure touch is placed until the $root is found.\n                 this.touchParents();\n             };\n             ChangeTree.prototype.touchParents = function () {\n                 if (this.parent) {\n                     this.parent['$changes'].touch(this.parentIndex);\n                 }\n             };\n             ChangeTree.prototype.getType = function (index) {\n                 if (this.ref['_definition']) {\n                     var definition = this.ref['_definition'];\n                     return definition.schema[definition.fieldsByIndex[index]];\n                 }\n                 else {\n                     var definition = this.parent['_definition'];\n                     var parentType = definition.schema[definition.fieldsByIndex[this.parentIndex]];\n                     //\n                     // Get the child type from parent structure.\n                     // - [\"string\"] => \"string\"\n                     // - { map: \"string\" } => \"string\"\n                     // - { set: \"string\" } => \"string\"\n                     //\n                     return Object.values(parentType)[0];\n                 }\n             };\n             ChangeTree.prototype.getChildrenFilter = function () {\n                 var childFilters = this.parent['_definition'].childFilters;\n                 return childFilters && childFilters[this.parentIndex];\n             };\n             //\n             // used during `.encode()`\n             //\n             ChangeTree.prototype.getValue = function (index) {\n                 return this.ref['getByIndex'](index);\n             };\n             ChangeTree.prototype.delete = function (fieldName) {\n                 var index = (typeof (fieldName) === \"number\")\n                     ? fieldName\n                     : this.indexes[fieldName];\n                 if (index === undefined) {\n                     console.warn(\"@colyseus/schema \".concat(this.ref.constructor.name, \": trying to delete non-existing index: \").concat(fieldName, \" (\").concat(index, \")\"));\n                     return;\n                 }\n                 var previousValue = this.getValue(index);\n                 // console.log(\"$changes.delete =>\", { fieldName, index, previousValue });\n                 this.changes.set(index, { op: exports.OPERATION.DELETE, index: index });\n                 this.allChanges.delete(index);\n                 // delete cache\n                 delete this.caches[index];\n                 // remove `root` reference\n                 if (previousValue && previousValue['$changes']) {\n                     previousValue['$changes'].parent = undefined;\n                 }\n                 this.changed = true;\n                 this.touchParents();\n             };\n             ChangeTree.prototype.discard = function (changed, discardAll) {\n                 var _this = this;\n                 if (changed === void 0) { changed = false; }\n                 if (discardAll === void 0) { discardAll = false; }\n                 //\n                 // Map, Array, etc:\n                 // Remove cached key to ensure ADD operations is unsed instead of\n                 // REPLACE in case same key is used on next patches.\n                 //\n                 // TODO: refactor this. this is not relevant for Collection and Set.\n                 //\n                 if (!(this.ref instanceof Schema)) {\n                     this.changes.forEach(function (change) {\n                         if (change.op === exports.OPERATION.DELETE) {\n                             var index = _this.ref['getIndex'](change.index);\n                             delete _this.indexes[index];\n                         }\n                     });\n                 }\n                 this.changes.clear();\n                 this.changed = changed;\n                 if (discardAll) {\n                     this.allChanges.clear();\n                 }\n                 // re-set `currentCustomOperation`\n                 this.currentCustomOperation = 0;\n             };\n             /**\n              * Recursively discard all changes from this, and child structures.\n              */\n             ChangeTree.prototype.discardAll = function () {\n                 var _this = this;\n                 this.changes.forEach(function (change) {\n                     var value = _this.getValue(change.index);\n                     if (value && value['$changes']) {\n                         value['$changes'].discardAll();\n                     }\n                 });\n                 this.discard();\n             };\n             // cache(field: number, beginIndex: number, endIndex: number) {\n             ChangeTree.prototype.cache = function (field, cachedBytes) {\n                 this.caches[field] = cachedBytes;\n             };\n             ChangeTree.prototype.clone = function () {\n                 return new ChangeTree(this.ref, this.parent, this.root);\n             };\n             ChangeTree.prototype.ensureRefId = function () {\n                 // skip if refId is already set.\n                 if (this.refId !== undefined) {\n                     return;\n                 }\n                 this.refId = this.root.getNextUniqueId();\n             };\n             ChangeTree.prototype.assertValidIndex = function (index, fieldName) {\n                 if (index === undefined) {\n                     throw new Error(\"ChangeTree: missing index for field \\\"\".concat(fieldName, \"\\\"\"));\n                 }\n             };\n             return ChangeTree;\n         }());\n\n         function addCallback($callbacks, op, callback, existing) {\n             // initialize list of callbacks\n             if (!$callbacks[op]) {\n                 $callbacks[op] = [];\n             }\n             $callbacks[op].push(callback);\n             //\n             // Trigger callback for existing elements\n             // - OPERATION.ADD\n             // - OPERATION.REPLACE\n             //\n             existing === null || existing === void 0 ? void 0 : existing.forEach(function (item, key) { return callback(item, key); });\n             return function () { return spliceOne($callbacks[op], $callbacks[op].indexOf(callback)); };\n         }\n         function removeChildRefs(changes) {\n             var _this = this;\n             var needRemoveRef = (typeof (this.$changes.getType()) !== \"string\");\n             this.$items.forEach(function (item, key) {\n                 changes.push({\n                     refId: _this.$changes.refId,\n                     op: exports.OPERATION.DELETE,\n                     field: key,\n                     value: undefined,\n                     previousValue: item\n                 });\n                 if (needRemoveRef) {\n                     _this.$changes.root.removeRef(item['$changes'].refId);\n                 }\n             });\n         }\n         function spliceOne(arr, index) {\n             // manually splice an array\n             if (index === -1 || index >= arr.length) {\n                 return false;\n             }\n             var len = arr.length - 1;\n             for (var i = index; i < len; i++) {\n                 arr[i] = arr[i + 1];\n             }\n             arr.length = len;\n             return true;\n         }\n\n         var DEFAULT_SORT = function (a, b) {\n             var A = a.toString();\n             var B = b.toString();\n             if (A < B)\n                 return -1;\n             else if (A > B)\n                 return 1;\n             else\n                 return 0;\n         };\n         function getArrayProxy(value) {\n             value['$proxy'] = true;\n             //\n             // compatibility with @colyseus/schema 0.5.x\n             // - allow `map[\"key\"]`\n             // - allow `map[\"key\"] = \"xxx\"`\n             // - allow `delete map[\"key\"]`\n             //\n             value = new Proxy(value, {\n                 get: function (obj, prop) {\n                     if (typeof (prop) !== \"symbol\" &&\n                         !isNaN(prop) // https://stackoverflow.com/a/175787/892698\n                     ) {\n                         return obj.at(prop);\n                     }\n                     else {\n                         return obj[prop];\n                     }\n                 },\n                 set: function (obj, prop, setValue) {\n                     if (typeof (prop) !== \"symbol\" &&\n                         !isNaN(prop)) {\n                         var indexes = Array.from(obj['$items'].keys());\n                         var key = parseInt(indexes[prop] || prop);\n                         if (setValue === undefined || setValue === null) {\n                             obj.deleteAt(key);\n                         }\n                         else {\n                             obj.setAt(key, setValue);\n                         }\n                     }\n                     else {\n                         obj[prop] = setValue;\n                     }\n                     return true;\n                 },\n                 deleteProperty: function (obj, prop) {\n                     if (typeof (prop) === \"number\") {\n                         obj.deleteAt(prop);\n                     }\n                     else {\n                         delete obj[prop];\n                     }\n                     return true;\n                 },\n             });\n             return value;\n         }\n         var ArraySchema = /** @class */ (function () {\n             function ArraySchema() {\n                 var items = [];\n                 for (var _i = 0; _i < arguments.length; _i++) {\n                     items[_i] = arguments[_i];\n                 }\n                 this.$changes = new ChangeTree(this);\n                 this.$items = new Map();\n                 this.$indexes = new Map();\n                 this.$refId = 0;\n                 this.push.apply(this, items);\n             }\n             ArraySchema.prototype.onAdd = function (callback, triggerAll) {\n                 if (triggerAll === void 0) { triggerAll = true; }\n                 return addCallback((this.$callbacks || (this.$callbacks = [])), exports.OPERATION.ADD, callback, (triggerAll)\n                     ? this.$items\n                     : undefined);\n             };\n             ArraySchema.prototype.onRemove = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.DELETE, callback); };\n             ArraySchema.prototype.onChange = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.REPLACE, callback); };\n             ArraySchema.is = function (type) {\n                 return (\n                 // type format: [\"string\"]\n                 Array.isArray(type) ||\n                     // type format: { array: \"string\" }\n                     (type['array'] !== undefined));\n             };\n             Object.defineProperty(ArraySchema.prototype, \"length\", {\n                 get: function () {\n                     return this.$items.size;\n                 },\n                 set: function (value) {\n                     if (value === 0) {\n                         this.clear();\n                     }\n                     else {\n                         this.splice(value, this.length - value);\n                     }\n                 },\n                 enumerable: false,\n                 configurable: true\n             });\n             ArraySchema.prototype.push = function () {\n                 var _this = this;\n                 var values = [];\n                 for (var _i = 0; _i < arguments.length; _i++) {\n                     values[_i] = arguments[_i];\n                 }\n                 var lastIndex;\n                 values.forEach(function (value) {\n                     // set \"index\" for reference.\n                     lastIndex = _this.$refId++;\n                     _this.setAt(lastIndex, value);\n                 });\n                 return lastIndex;\n             };\n             /**\n              * Removes the last element from an array and returns it.\n              */\n             ArraySchema.prototype.pop = function () {\n                 var key = Array.from(this.$indexes.values()).pop();\n                 if (key === undefined) {\n                     return undefined;\n                 }\n                 this.$changes.delete(key);\n                 this.$indexes.delete(key);\n                 var value = this.$items.get(key);\n                 this.$items.delete(key);\n                 return value;\n             };\n             ArraySchema.prototype.at = function (index) {\n                 //\n                 // FIXME: this should be O(1)\n                 //\n                 var key = Array.from(this.$items.keys())[index];\n                 return this.$items.get(key);\n             };\n             ArraySchema.prototype.setAt = function (index, value) {\n                 var _a, _b;\n                 if (value['$changes'] !== undefined) {\n                     value['$changes'].setParent(this, this.$changes.root, index);\n                 }\n                 var operation = (_b = (_a = this.$changes.indexes[index]) === null || _a === void 0 ? void 0 : _a.op) !== null && _b !== void 0 ? _b : exports.OPERATION.ADD;\n                 this.$changes.indexes[index] = index;\n                 this.$indexes.set(index, index);\n                 this.$items.set(index, value);\n                 this.$changes.change(index, operation);\n             };\n             ArraySchema.prototype.deleteAt = function (index) {\n                 var key = Array.from(this.$items.keys())[index];\n                 if (key === undefined) {\n                     return false;\n                 }\n                 return this.$deleteAt(key);\n             };\n             ArraySchema.prototype.$deleteAt = function (index) {\n                 // delete at internal index\n                 this.$changes.delete(index);\n                 this.$indexes.delete(index);\n                 return this.$items.delete(index);\n             };\n             ArraySchema.prototype.clear = function (changes) {\n                 // discard previous operations.\n                 this.$changes.discard(true, true);\n                 this.$changes.indexes = {};\n                 // clear previous indexes\n                 this.$indexes.clear();\n                 //\n                 // When decoding:\n                 // - enqueue items for DELETE callback.\n                 // - flag child items for garbage collection.\n                 //\n                 if (changes) {\n                     removeChildRefs.call(this, changes);\n                 }\n                 // clear items\n                 this.$items.clear();\n                 this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                 // touch all structures until reach root\n                 this.$changes.touchParents();\n             };\n             /**\n              * Combines two or more arrays.\n              * @param items Additional items to add to the end of array1.\n              */\n             ArraySchema.prototype.concat = function () {\n                 var _a;\n                 var items = [];\n                 for (var _i = 0; _i < arguments.length; _i++) {\n                     items[_i] = arguments[_i];\n                 }\n                 return new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], (_a = Array.from(this.$items.values())).concat.apply(_a, items), false)))();\n             };\n             /**\n              * Adds all the elements of an array separated by the specified separator string.\n              * @param separator A string used to separate one element of an array from the next in the resulting String. If omitted, the array elements are separated with a comma.\n              */\n             ArraySchema.prototype.join = function (separator) {\n                 return Array.from(this.$items.values()).join(separator);\n             };\n             /**\n              * Reverses the elements in an Array.\n              */\n             ArraySchema.prototype.reverse = function () {\n                 var _this = this;\n                 var indexes = Array.from(this.$items.keys());\n                 var reversedItems = Array.from(this.$items.values()).reverse();\n                 reversedItems.forEach(function (item, i) {\n                     _this.setAt(indexes[i], item);\n                 });\n                 return this;\n             };\n             /**\n              * Removes the first element from an array and returns it.\n              */\n             ArraySchema.prototype.shift = function () {\n                 var indexes = Array.from(this.$items.keys());\n                 var shiftAt = indexes.shift();\n                 if (shiftAt === undefined) {\n                     return undefined;\n                 }\n                 var value = this.$items.get(shiftAt);\n                 this.$deleteAt(shiftAt);\n                 return value;\n             };\n             /**\n              * Returns a section of an array.\n              * @param start The beginning of the specified portion of the array.\n              * @param end The end of the specified portion of the array. This is exclusive of the element at the index 'end'.\n              */\n             ArraySchema.prototype.slice = function (start, end) {\n                 return new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], Array.from(this.$items.values()).slice(start, end), false)))();\n             };\n             /**\n              * Sorts an array.\n              * @param compareFn Function used to determine the order of the elements. It is expected to return\n              * a negative value if first argument is less than second argument, zero if they're equal and a positive\n              * value otherwise. If omitted, the elements are sorted in ascending, ASCII character order.\n              * ```ts\n              * [11,2,22,1].sort((a, b) => a - b)\n              * ```\n              */\n             ArraySchema.prototype.sort = function (compareFn) {\n                 var _this = this;\n                 if (compareFn === void 0) { compareFn = DEFAULT_SORT; }\n                 var indexes = Array.from(this.$items.keys());\n                 var sortedItems = Array.from(this.$items.values()).sort(compareFn);\n                 sortedItems.forEach(function (item, i) {\n                     _this.setAt(indexes[i], item);\n                 });\n                 return this;\n             };\n             /**\n              * Removes elements from an array and, if necessary, inserts new elements in their place, returning the deleted elements.\n              * @param start The zero-based location in the array from which to start removing elements.\n              * @param deleteCount The number of elements to remove.\n              * @param items Elements to insert into the array in place of the deleted elements.\n              */\n             ArraySchema.prototype.splice = function (start, deleteCount) {\n                 if (deleteCount === void 0) { deleteCount = this.length - start; }\n                 var indexes = Array.from(this.$items.keys());\n                 var removedItems = [];\n                 for (var i = start; i < start + deleteCount; i++) {\n                     removedItems.push(this.$items.get(indexes[i]));\n                     this.$deleteAt(indexes[i]);\n                 }\n                 return removedItems;\n             };\n             /**\n              * Inserts new elements at the start of an array.\n              * @param items  Elements to insert at the start of the Array.\n              */\n             ArraySchema.prototype.unshift = function () {\n                 var _this = this;\n                 var items = [];\n                 for (var _i = 0; _i < arguments.length; _i++) {\n                     items[_i] = arguments[_i];\n                 }\n                 var length = this.length;\n                 var addedLength = items.length;\n                 // const indexes = Array.from(this.$items.keys());\n                 var previousValues = Array.from(this.$items.values());\n                 items.forEach(function (item, i) {\n                     _this.setAt(i, item);\n                 });\n                 previousValues.forEach(function (previousValue, i) {\n                     _this.setAt(addedLength + i, previousValue);\n                 });\n                 return length + addedLength;\n             };\n             /**\n              * Returns the index of the first occurrence of a value in an array.\n              * @param searchElement The value to locate in the array.\n              * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at index 0.\n              */\n             ArraySchema.prototype.indexOf = function (searchElement, fromIndex) {\n                 return Array.from(this.$items.values()).indexOf(searchElement, fromIndex);\n             };\n             /**\n              * Returns the index of the last occurrence of a specified value in an array.\n              * @param searchElement The value to locate in the array.\n              * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at the last index in the array.\n              */\n             ArraySchema.prototype.lastIndexOf = function (searchElement, fromIndex) {\n                 if (fromIndex === void 0) { fromIndex = this.length - 1; }\n                 return Array.from(this.$items.values()).lastIndexOf(searchElement, fromIndex);\n             };\n             /**\n              * Determines whether all the members of an array satisfy the specified test.\n              * @param callbackfn A function that accepts up to three arguments. The every method calls\n              * the callbackfn function for each element in the array until the callbackfn returns a value\n              * which is coercible to the Boolean value false, or until the end of the array.\n              * @param thisArg An object to which the this keyword can refer in the callbackfn function.\n              * If thisArg is omitted, undefined is used as the this value.\n              */\n             ArraySchema.prototype.every = function (callbackfn, thisArg) {\n                 return Array.from(this.$items.values()).every(callbackfn, thisArg);\n             };\n             /**\n              * Determines whether the specified callback function returns true for any element of an array.\n              * @param callbackfn A function that accepts up to three arguments. The some method calls\n              * the callbackfn function for each element in the array until the callbackfn returns a value\n              * which is coercible to the Boolean value true, or until the end of the array.\n              * @param thisArg An object to which the this keyword can refer in the callbackfn function.\n              * If thisArg is omitted, undefined is used as the this value.\n              */\n             ArraySchema.prototype.some = function (callbackfn, thisArg) {\n                 return Array.from(this.$items.values()).some(callbackfn, thisArg);\n             };\n             /**\n              * Performs the specified action for each element in an array.\n              * @param callbackfn  A function that accepts up to three arguments. forEach calls the callbackfn function one time for each element in the array.\n              * @param thisArg  An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\n              */\n             ArraySchema.prototype.forEach = function (callbackfn, thisArg) {\n                 Array.from(this.$items.values()).forEach(callbackfn, thisArg);\n             };\n             /**\n              * Calls a defined callback function on each element of an array, and returns an array that contains the results.\n              * @param callbackfn A function that accepts up to three arguments. The map method calls the callbackfn function one time for each element in the array.\n              * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\n              */\n             ArraySchema.prototype.map = function (callbackfn, thisArg) {\n                 return Array.from(this.$items.values()).map(callbackfn, thisArg);\n             };\n             ArraySchema.prototype.filter = function (callbackfn, thisArg) {\n                 return Array.from(this.$items.values()).filter(callbackfn, thisArg);\n             };\n             /**\n              * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\n              * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\n              * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\n              */\n             ArraySchema.prototype.reduce = function (callbackfn, initialValue) {\n                 return Array.prototype.reduce.apply(Array.from(this.$items.values()), arguments);\n             };\n             /**\n              * Calls the specified callback function for all the elements in an array, in descending order. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\n              * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls the callbackfn function one time for each element in the array.\n              * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\n              */\n             ArraySchema.prototype.reduceRight = function (callbackfn, initialValue) {\n                 return Array.prototype.reduceRight.apply(Array.from(this.$items.values()), arguments);\n             };\n             /**\n              * Returns the value of the first element in the array where predicate is true, and undefined\n              * otherwise.\n              * @param predicate find calls predicate once for each element of the array, in ascending\n              * order, until it finds one where predicate returns true. If such an element is found, find\n              * immediately returns that element value. Otherwise, find returns undefined.\n              * @param thisArg If provided, it will be used as the this value for each invocation of\n              * predicate. If it is not provided, undefined is used instead.\n              */\n             ArraySchema.prototype.find = function (predicate, thisArg) {\n                 return Array.from(this.$items.values()).find(predicate, thisArg);\n             };\n             /**\n              * Returns the index of the first element in the array where predicate is true, and -1\n              * otherwise.\n              * @param predicate find calls predicate once for each element of the array, in ascending\n              * order, until it finds one where predicate returns true. If such an element is found,\n              * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\n              * @param thisArg If provided, it will be used as the this value for each invocation of\n              * predicate. If it is not provided, undefined is used instead.\n              */\n             ArraySchema.prototype.findIndex = function (predicate, thisArg) {\n                 return Array.from(this.$items.values()).findIndex(predicate, thisArg);\n             };\n             /**\n              * Returns the this object after filling the section identified by start and end with value\n              * @param value value to fill array section with\n              * @param start index to start filling the array at. If start is negative, it is treated as\n              * length+start where length is the length of the array.\n              * @param end index to stop filling the array at. If end is negative, it is treated as\n              * length+end.\n              */\n             ArraySchema.prototype.fill = function (value, start, end) {\n                 //\n                 // TODO\n                 //\n                 throw new Error(\"ArraySchema#fill() not implemented\");\n             };\n             /**\n              * Returns the this object after copying a section of the array identified by start and end\n              * to the same array starting at position target\n              * @param target If target is negative, it is treated as length+target where length is the\n              * length of the array.\n              * @param start If start is negative, it is treated as length+start. If end is negative, it\n              * is treated as length+end.\n              * @param end If not specified, length of the this object is used as its default value.\n              */\n             ArraySchema.prototype.copyWithin = function (target, start, end) {\n                 //\n                 // TODO\n                 //\n                 throw new Error(\"ArraySchema#copyWithin() not implemented\");\n             };\n             /**\n              * Returns a string representation of an array.\n              */\n             ArraySchema.prototype.toString = function () { return this.$items.toString(); };\n             /**\n              * Returns a string representation of an array. The elements are converted to string using their toLocalString methods.\n              */\n             ArraySchema.prototype.toLocaleString = function () { return this.$items.toLocaleString(); };\n             /** Iterator */\n             ArraySchema.prototype[Symbol.iterator] = function () {\n                 return Array.from(this.$items.values())[Symbol.iterator]();\n             };\n             /**\n              * Returns an iterable of key, value pairs for every entry in the array\n              */\n             ArraySchema.prototype.entries = function () { return this.$items.entries(); };\n             /**\n              * Returns an iterable of keys in the array\n              */\n             ArraySchema.prototype.keys = function () { return this.$items.keys(); };\n             /**\n              * Returns an iterable of values in the array\n              */\n             ArraySchema.prototype.values = function () { return this.$items.values(); };\n             /**\n              * Determines whether an array includes a certain element, returning true or false as appropriate.\n              * @param searchElement The element to search for.\n              * @param fromIndex The position in this array at which to begin searching for searchElement.\n              */\n             ArraySchema.prototype.includes = function (searchElement, fromIndex) {\n                 return Array.from(this.$items.values()).includes(searchElement, fromIndex);\n             };\n             /**\n              * Calls a defined callback function on each element of an array. Then, flattens the result into\n              * a new array.\n              * This is identical to a map followed by flat with depth 1.\n              *\n              * @param callback A function that accepts up to three arguments. The flatMap method calls the\n              * callback function one time for each element in the array.\n              * @param thisArg An object to which the this keyword can refer in the callback function. If\n              * thisArg is omitted, undefined is used as the this value.\n              */\n             // @ts-ignore\n             ArraySchema.prototype.flatMap = function (callback, thisArg) {\n                 // @ts-ignore\n                 throw new Error(\"ArraySchema#flatMap() is not supported.\");\n             };\n             /**\n              * Returns a new array with all sub-array elements concatenated into it recursively up to the\n              * specified depth.\n              *\n              * @param depth The maximum recursion depth\n              */\n             // @ts-ignore\n             ArraySchema.prototype.flat = function (depth) {\n                 // @ts-ignore\n                 throw new Error(\"ArraySchema#flat() is not supported.\");\n             };\n             // get size () {\n             //     return this.$items.size;\n             // }\n             ArraySchema.prototype.setIndex = function (index, key) {\n                 this.$indexes.set(index, key);\n             };\n             ArraySchema.prototype.getIndex = function (index) {\n                 return this.$indexes.get(index);\n             };\n             ArraySchema.prototype.getByIndex = function (index) {\n                 return this.$items.get(this.$indexes.get(index));\n             };\n             ArraySchema.prototype.deleteByIndex = function (index) {\n                 var key = this.$indexes.get(index);\n                 this.$items.delete(key);\n                 this.$indexes.delete(index);\n             };\n             ArraySchema.prototype.toArray = function () {\n                 return Array.from(this.$items.values());\n             };\n             ArraySchema.prototype.toJSON = function () {\n                 return this.toArray().map(function (value) {\n                     return (typeof (value['toJSON']) === \"function\")\n                         ? value['toJSON']()\n                         : value;\n                 });\n             };\n             //\n             // Decoding utilities\n             //\n             ArraySchema.prototype.clone = function (isDecoding) {\n                 var cloned;\n                 if (isDecoding) {\n                     cloned = new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], Array.from(this.$items.values()), false)))();\n                 }\n                 else {\n                     cloned = new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], this.map(function (item) { return ((item['$changes'])\n                         ? item.clone()\n                         : item); }), false)))();\n                 }\n                 return cloned;\n             };\n             return ArraySchema;\n         }());\n\n         function getMapProxy(value) {\n             value['$proxy'] = true;\n             value = new Proxy(value, {\n                 get: function (obj, prop) {\n                     if (typeof (prop) !== \"symbol\" && // accessing properties\n                         typeof (obj[prop]) === \"undefined\") {\n                         return obj.get(prop);\n                     }\n                     else {\n                         return obj[prop];\n                     }\n                 },\n                 set: function (obj, prop, setValue) {\n                     if (typeof (prop) !== \"symbol\" &&\n                         (prop.indexOf(\"$\") === -1 &&\n                             prop !== \"onAdd\" &&\n                             prop !== \"onRemove\" &&\n                             prop !== \"onChange\")) {\n                         obj.set(prop, setValue);\n                     }\n                     else {\n                         obj[prop] = setValue;\n                     }\n                     return true;\n                 },\n                 deleteProperty: function (obj, prop) {\n                     obj.delete(prop);\n                     return true;\n                 },\n             });\n             return value;\n         }\n         var MapSchema = /** @class */ (function () {\n             function MapSchema(initialValues) {\n                 var _this = this;\n                 this.$changes = new ChangeTree(this);\n                 this.$items = new Map();\n                 this.$indexes = new Map();\n                 this.$refId = 0;\n                 if (initialValues) {\n                     if (initialValues instanceof Map ||\n                         initialValues instanceof MapSchema) {\n                         initialValues.forEach(function (v, k) { return _this.set(k, v); });\n                     }\n                     else {\n                         for (var k in initialValues) {\n                             this.set(k, initialValues[k]);\n                         }\n                     }\n                 }\n             }\n             MapSchema.prototype.onAdd = function (callback, triggerAll) {\n                 if (triggerAll === void 0) { triggerAll = true; }\n                 return addCallback((this.$callbacks || (this.$callbacks = [])), exports.OPERATION.ADD, callback, (triggerAll)\n                     ? this.$items\n                     : undefined);\n             };\n             MapSchema.prototype.onRemove = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.DELETE, callback); };\n             MapSchema.prototype.onChange = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.REPLACE, callback); };\n             MapSchema.is = function (type) {\n                 return type['map'] !== undefined;\n             };\n             /** Iterator */\n             MapSchema.prototype[Symbol.iterator] = function () { return this.$items[Symbol.iterator](); };\n             Object.defineProperty(MapSchema.prototype, Symbol.toStringTag, {\n                 get: function () { return this.$items[Symbol.toStringTag]; },\n                 enumerable: false,\n                 configurable: true\n             });\n             MapSchema.prototype.set = function (key, value) {\n                 if (value === undefined || value === null) {\n                     throw new Error(\"MapSchema#set('\".concat(key, \"', \").concat(value, \"): trying to set \").concat(value, \" value on '\").concat(key, \"'.\"));\n                 }\n                 // get \"index\" for this value.\n                 var hasIndex = typeof (this.$changes.indexes[key]) !== \"undefined\";\n                 var index = (hasIndex)\n                     ? this.$changes.indexes[key]\n                     : this.$refId++;\n                 var operation = (hasIndex)\n                     ? exports.OPERATION.REPLACE\n                     : exports.OPERATION.ADD;\n                 var isRef = (value['$changes']) !== undefined;\n                 if (isRef) {\n                     value['$changes'].setParent(this, this.$changes.root, index);\n                 }\n                 //\n                 // (encoding)\n                 // set a unique id to relate directly with this key/value.\n                 //\n                 if (!hasIndex) {\n                     this.$changes.indexes[key] = index;\n                     this.$indexes.set(index, key);\n                 }\n                 else if (isRef && // if is schema, force ADD operation if value differ from previous one.\n                     this.$items.get(key) !== value) {\n                     operation = exports.OPERATION.ADD;\n                 }\n                 this.$items.set(key, value);\n                 this.$changes.change(key, operation);\n                 return this;\n             };\n             MapSchema.prototype.get = function (key) {\n                 return this.$items.get(key);\n             };\n             MapSchema.prototype.delete = function (key) {\n                 //\n                 // TODO: add a \"purge\" method after .encode() runs, to cleanup removed `$indexes`\n                 //\n                 // We don't remove $indexes to allow setting the same key in the same patch\n                 // (See \"should allow to remove and set an item in the same place\" test)\n                 //\n                 // // const index = this.$changes.indexes[key];\n                 // // this.$indexes.delete(index);\n                 this.$changes.delete(key);\n                 return this.$items.delete(key);\n             };\n             MapSchema.prototype.clear = function (changes) {\n                 // discard previous operations.\n                 this.$changes.discard(true, true);\n                 this.$changes.indexes = {};\n                 // clear previous indexes\n                 this.$indexes.clear();\n                 //\n                 // When decoding:\n                 // - enqueue items for DELETE callback.\n                 // - flag child items for garbage collection.\n                 //\n                 if (changes) {\n                     removeChildRefs.call(this, changes);\n                 }\n                 // clear items\n                 this.$items.clear();\n                 this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                 // touch all structures until reach root\n                 this.$changes.touchParents();\n             };\n             MapSchema.prototype.has = function (key) {\n                 return this.$items.has(key);\n             };\n             MapSchema.prototype.forEach = function (callbackfn) {\n                 this.$items.forEach(callbackfn);\n             };\n             MapSchema.prototype.entries = function () {\n                 return this.$items.entries();\n             };\n             MapSchema.prototype.keys = function () {\n                 return this.$items.keys();\n             };\n             MapSchema.prototype.values = function () {\n                 return this.$items.values();\n             };\n             Object.defineProperty(MapSchema.prototype, \"size\", {\n                 get: function () {\n                     return this.$items.size;\n                 },\n                 enumerable: false,\n                 configurable: true\n             });\n             MapSchema.prototype.setIndex = function (index, key) {\n                 this.$indexes.set(index, key);\n             };\n             MapSchema.prototype.getIndex = function (index) {\n                 return this.$indexes.get(index);\n             };\n             MapSchema.prototype.getByIndex = function (index) {\n                 return this.$items.get(this.$indexes.get(index));\n             };\n             MapSchema.prototype.deleteByIndex = function (index) {\n                 var key = this.$indexes.get(index);\n                 this.$items.delete(key);\n                 this.$indexes.delete(index);\n             };\n             MapSchema.prototype.toJSON = function () {\n                 var map = {};\n                 this.forEach(function (value, key) {\n                     map[key] = (typeof (value['toJSON']) === \"function\")\n                         ? value['toJSON']()\n                         : value;\n                 });\n                 return map;\n             };\n             //\n             // Decoding utilities\n             //\n             MapSchema.prototype.clone = function (isDecoding) {\n                 var cloned;\n                 if (isDecoding) {\n                     // client-side\n                     cloned = Object.assign(new MapSchema(), this);\n                 }\n                 else {\n                     // server-side\n                     cloned = new MapSchema();\n                     this.forEach(function (value, key) {\n                         if (value['$changes']) {\n                             cloned.set(key, value['clone']());\n                         }\n                         else {\n                             cloned.set(key, value);\n                         }\n                     });\n                 }\n                 return cloned;\n             };\n             return MapSchema;\n         }());\n\n         var registeredTypes = {};\n         function registerType(identifier, definition) {\n             registeredTypes[identifier] = definition;\n         }\n         function getType(identifier) {\n             return registeredTypes[identifier];\n         }\n\n         var SchemaDefinition = /** @class */ (function () {\n             function SchemaDefinition() {\n                 //\n                 // TODO: use a \"field\" structure combining all these properties per-field.\n                 //\n                 this.indexes = {};\n                 this.fieldsByIndex = {};\n                 this.deprecated = {};\n                 this.descriptors = {};\n             }\n             SchemaDefinition.create = function (parent) {\n                 var definition = new SchemaDefinition();\n                 // support inheritance\n                 definition.schema = Object.assign({}, parent && parent.schema || {});\n                 definition.indexes = Object.assign({}, parent && parent.indexes || {});\n                 definition.fieldsByIndex = Object.assign({}, parent && parent.fieldsByIndex || {});\n                 definition.descriptors = Object.assign({}, parent && parent.descriptors || {});\n                 definition.deprecated = Object.assign({}, parent && parent.deprecated || {});\n                 return definition;\n             };\n             SchemaDefinition.prototype.addField = function (field, type) {\n                 var index = this.getNextFieldIndex();\n                 this.fieldsByIndex[index] = field;\n                 this.indexes[field] = index;\n                 this.schema[field] = (Array.isArray(type))\n                     ? { array: type[0] }\n                     : type;\n             };\n             SchemaDefinition.prototype.hasField = function (field) {\n                 return this.indexes[field] !== undefined;\n             };\n             SchemaDefinition.prototype.addFilter = function (field, cb) {\n                 if (!this.filters) {\n                     this.filters = {};\n                     this.indexesWithFilters = [];\n                 }\n                 this.filters[this.indexes[field]] = cb;\n                 this.indexesWithFilters.push(this.indexes[field]);\n                 return true;\n             };\n             SchemaDefinition.prototype.addChildrenFilter = function (field, cb) {\n                 var index = this.indexes[field];\n                 var type = this.schema[field];\n                 if (getType(Object.keys(type)[0])) {\n                     if (!this.childFilters) {\n                         this.childFilters = {};\n                     }\n                     this.childFilters[index] = cb;\n                     return true;\n                 }\n                 else {\n                     console.warn(\"@filterChildren: field '\".concat(field, \"' can't have children. Ignoring filter.\"));\n                 }\n             };\n             SchemaDefinition.prototype.getChildrenFilter = function (field) {\n                 return this.childFilters && this.childFilters[this.indexes[field]];\n             };\n             SchemaDefinition.prototype.getNextFieldIndex = function () {\n                 return Object.keys(this.schema || {}).length;\n             };\n             return SchemaDefinition;\n         }());\n         function hasFilter(klass) {\n             return klass._context && klass._context.useFilters;\n         }\n         var Context = /** @class */ (function () {\n             function Context() {\n                 this.types = {};\n                 this.schemas = new Map();\n                 this.useFilters = false;\n             }\n             Context.prototype.has = function (schema) {\n                 return this.schemas.has(schema);\n             };\n             Context.prototype.get = function (typeid) {\n                 return this.types[typeid];\n             };\n             Context.prototype.add = function (schema, typeid) {\n                 if (typeid === void 0) { typeid = this.schemas.size; }\n                 // FIXME: move this to somewhere else?\n                 // support inheritance\n                 schema._definition = SchemaDefinition.create(schema._definition);\n                 schema._typeid = typeid;\n                 this.types[typeid] = schema;\n                 this.schemas.set(schema, typeid);\n             };\n             Context.create = function (options) {\n                 if (options === void 0) { options = {}; }\n                 return function (definition) {\n                     if (!options.context) {\n                         options.context = new Context();\n                     }\n                     return type(definition, options);\n                 };\n             };\n             return Context;\n         }());\n         var globalContext = new Context();\n         /**\n          * [See documentation](https://docs.colyseus.io/state/schema/)\n          *\n          * Annotate a Schema property to be serializeable.\n          * \\@type()'d fields are automatically flagged as \"dirty\" for the next patch.\n          *\n          * @example Standard usage, with automatic change tracking.\n          * ```\n          * \\@type(\"string\") propertyName: string;\n          * ```\n          *\n          * @example You can provide the \"manual\" option if you'd like to manually control your patches via .setDirty().\n          * ```\n          * \\@type(\"string\", { manual: true })\n          * ```\n          */\n         function type(type, options) {\n             if (options === void 0) { options = {}; }\n             return function (target, field) {\n                 var context = options.context || globalContext;\n                 var constructor = target.constructor;\n                 constructor._context = context;\n                 if (!type) {\n                     throw new Error(\"\".concat(constructor.name, \": @type() reference provided for \\\"\").concat(field, \"\\\" is undefined. Make sure you don't have any circular dependencies.\"));\n                 }\n                 /*\n                  * static schema\n                  */\n                 if (!context.has(constructor)) {\n                     context.add(constructor);\n                 }\n                 var definition = constructor._definition;\n                 definition.addField(field, type);\n                 /**\n                  * skip if descriptor already exists for this field (`@deprecated()`)\n                  */\n                 if (definition.descriptors[field]) {\n                     if (definition.deprecated[field]) {\n                         // do not create accessors for deprecated properties.\n                         return;\n                     }\n                     else {\n                         // trying to define same property multiple times across inheritance.\n                         // https://github.com/colyseus/colyseus-unity3d/issues/131#issuecomment-814308572\n                         try {\n                             throw new Error(\"@colyseus/schema: Duplicate '\".concat(field, \"' definition on '\").concat(constructor.name, \"'.\\nCheck @type() annotation\"));\n                         }\n                         catch (e) {\n                             var definitionAtLine = e.stack.split(\"\\n\")[4].trim();\n                             throw new Error(\"\".concat(e.message, \" \").concat(definitionAtLine));\n                         }\n                     }\n                 }\n                 var isArray = ArraySchema.is(type);\n                 var isMap = !isArray && MapSchema.is(type);\n                 // TODO: refactor me.\n                 // Allow abstract intermediary classes with no fields to be serialized\n                 // (See \"should support an inheritance with a Schema type without fields\" test)\n                 if (typeof (type) !== \"string\" && !Schema.is(type)) {\n                     var childType = Object.values(type)[0];\n                     if (typeof (childType) !== \"string\" && !context.has(childType)) {\n                         context.add(childType);\n                     }\n                 }\n                 if (options.manual) {\n                     // do not declare getter/setter descriptor\n                     definition.descriptors[field] = {\n                         enumerable: true,\n                         configurable: true,\n                         writable: true,\n                     };\n                     return;\n                 }\n                 var fieldCached = \"_\".concat(field);\n                 definition.descriptors[fieldCached] = {\n                     enumerable: false,\n                     configurable: false,\n                     writable: true,\n                 };\n                 definition.descriptors[field] = {\n                     get: function () {\n                         return this[fieldCached];\n                     },\n                     set: function (value) {\n                         /**\n                          * Create Proxy for array or map items\n                          */\n                         // skip if value is the same as cached.\n                         if (value === this[fieldCached]) {\n                             return;\n                         }\n                         if (value !== undefined &&\n                             value !== null) {\n                             // automaticallty transform Array into ArraySchema\n                             if (isArray && !(value instanceof ArraySchema)) {\n                                 value = new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], value, false)))();\n                             }\n                             // automaticallty transform Map into MapSchema\n                             if (isMap && !(value instanceof MapSchema)) {\n                                 value = new MapSchema(value);\n                             }\n                             // try to turn provided structure into a Proxy\n                             if (value['$proxy'] === undefined) {\n                                 if (isMap) {\n                                     value = getMapProxy(value);\n                                 }\n                                 else if (isArray) {\n                                     value = getArrayProxy(value);\n                                 }\n                             }\n                             // flag the change for encoding.\n                             this.$changes.change(field);\n                             //\n                             // call setParent() recursively for this and its child\n                             // structures.\n                             //\n                             if (value['$changes']) {\n                                 value['$changes'].setParent(this, this.$changes.root, this._definition.indexes[field]);\n                             }\n                         }\n                         else if (this[fieldCached]) {\n                             //\n                             // Setting a field to `null` or `undefined` will delete it.\n                             //\n                             this.$changes.delete(field);\n                         }\n                         this[fieldCached] = value;\n                     },\n                     enumerable: true,\n                     configurable: true\n                 };\n             };\n         }\n         /**\n          * `@filter()` decorator for defining data filters per client\n          */\n         function filter(cb) {\n             return function (target, field) {\n                 var constructor = target.constructor;\n                 var definition = constructor._definition;\n                 if (definition.addFilter(field, cb)) {\n                     constructor._context.useFilters = true;\n                 }\n             };\n         }\n         function filterChildren(cb) {\n             return function (target, field) {\n                 var constructor = target.constructor;\n                 var definition = constructor._definition;\n                 if (definition.addChildrenFilter(field, cb)) {\n                     constructor._context.useFilters = true;\n                 }\n             };\n         }\n         /**\n          * `@deprecated()` flag a field as deprecated.\n          * The previous `@type()` annotation should remain along with this one.\n          */\n         function deprecated(throws) {\n             if (throws === void 0) { throws = true; }\n             return function (target, field) {\n                 var constructor = target.constructor;\n                 var definition = constructor._definition;\n                 definition.deprecated[field] = true;\n                 if (throws) {\n                     definition.descriptors[field] = {\n                         get: function () { throw new Error(\"\".concat(field, \" is deprecated.\")); },\n                         set: function (value) { },\n                         enumerable: false,\n                         configurable: true\n                     };\n                 }\n             };\n         }\n         function defineTypes(target, fields, options) {\n             if (options === void 0) { options = {}; }\n             if (!options.context) {\n                 options.context = target._context || options.context || globalContext;\n             }\n             for (var field in fields) {\n                 type(fields[field], options)(target.prototype, field);\n             }\n             return target;\n         }\n\n         /**\n          * Copyright (c) 2018 Endel Dreyer\n          * Copyright (c) 2014 Ion Drive Software Ltd.\n          *\n          * Permission is hereby granted, free of charge, to any person obtaining a copy\n          * of this software and associated documentation files (the \"Software\"), to deal\n          * in the Software without restriction, including without limitation the rights\n          * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n          * copies of the Software, and to permit persons to whom the Software is\n          * furnished to do so, subject to the following conditions:\n          *\n          * The above copyright notice and this permission notice shall be included in all\n          * copies or substantial portions of the Software.\n          *\n          * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n          * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n          * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n          * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n          * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n          * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n          * SOFTWARE\n          */\n         /**\n          * msgpack implementation highly based on notepack.io\n          * https://github.com/darrachequesne/notepack\n          */\n         function utf8Length(str) {\n             var c = 0, length = 0;\n             for (var i = 0, l = str.length; i < l; i++) {\n                 c = str.charCodeAt(i);\n                 if (c < 0x80) {\n                     length += 1;\n                 }\n                 else if (c < 0x800) {\n                     length += 2;\n                 }\n                 else if (c < 0xd800 || c >= 0xe000) {\n                     length += 3;\n                 }\n                 else {\n                     i++;\n                     length += 4;\n                 }\n             }\n             return length;\n         }\n         function utf8Write(view, offset, str) {\n             var c = 0;\n             for (var i = 0, l = str.length; i < l; i++) {\n                 c = str.charCodeAt(i);\n                 if (c < 0x80) {\n                     view[offset++] = c;\n                 }\n                 else if (c < 0x800) {\n                     view[offset++] = 0xc0 | (c >> 6);\n                     view[offset++] = 0x80 | (c & 0x3f);\n                 }\n                 else if (c < 0xd800 || c >= 0xe000) {\n                     view[offset++] = 0xe0 | (c >> 12);\n                     view[offset++] = 0x80 | (c >> 6 & 0x3f);\n                     view[offset++] = 0x80 | (c & 0x3f);\n                 }\n                 else {\n                     i++;\n                     c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n                     view[offset++] = 0xf0 | (c >> 18);\n                     view[offset++] = 0x80 | (c >> 12 & 0x3f);\n                     view[offset++] = 0x80 | (c >> 6 & 0x3f);\n                     view[offset++] = 0x80 | (c & 0x3f);\n                 }\n             }\n         }\n         function int8$1(bytes, value) {\n             bytes.push(value & 255);\n         }\n         function uint8$1(bytes, value) {\n             bytes.push(value & 255);\n         }\n         function int16$1(bytes, value) {\n             bytes.push(value & 255);\n             bytes.push((value >> 8) & 255);\n         }\n         function uint16$1(bytes, value) {\n             bytes.push(value & 255);\n             bytes.push((value >> 8) & 255);\n         }\n         function int32$1(bytes, value) {\n             bytes.push(value & 255);\n             bytes.push((value >> 8) & 255);\n             bytes.push((value >> 16) & 255);\n             bytes.push((value >> 24) & 255);\n         }\n         function uint32$1(bytes, value) {\n             var b4 = value >> 24;\n             var b3 = value >> 16;\n             var b2 = value >> 8;\n             var b1 = value;\n             bytes.push(b1 & 255);\n             bytes.push(b2 & 255);\n             bytes.push(b3 & 255);\n             bytes.push(b4 & 255);\n         }\n         function int64$1(bytes, value) {\n             var high = Math.floor(value / Math.pow(2, 32));\n             var low = value >>> 0;\n             uint32$1(bytes, low);\n             uint32$1(bytes, high);\n         }\n         function uint64$1(bytes, value) {\n             var high = (value / Math.pow(2, 32)) >> 0;\n             var low = value >>> 0;\n             uint32$1(bytes, low);\n             uint32$1(bytes, high);\n         }\n         function float32$1(bytes, value) {\n             writeFloat32(bytes, value);\n         }\n         function float64$1(bytes, value) {\n             writeFloat64(bytes, value);\n         }\n         var _int32$1 = new Int32Array(2);\n         var _float32$1 = new Float32Array(_int32$1.buffer);\n         var _float64$1 = new Float64Array(_int32$1.buffer);\n         function writeFloat32(bytes, value) {\n             _float32$1[0] = value;\n             int32$1(bytes, _int32$1[0]);\n         }\n         function writeFloat64(bytes, value) {\n             _float64$1[0] = value;\n             int32$1(bytes, _int32$1[0 ]);\n             int32$1(bytes, _int32$1[1 ]);\n         }\n         function boolean$1(bytes, value) {\n             return uint8$1(bytes, value ? 1 : 0);\n         }\n         function string$1(bytes, value) {\n             // encode `null` strings as empty.\n             if (!value) {\n                 value = \"\";\n             }\n             var length = utf8Length(value);\n             var size = 0;\n             // fixstr\n             if (length < 0x20) {\n                 bytes.push(length | 0xa0);\n                 size = 1;\n             }\n             // str 8\n             else if (length < 0x100) {\n                 bytes.push(0xd9);\n                 uint8$1(bytes, length);\n                 size = 2;\n             }\n             // str 16\n             else if (length < 0x10000) {\n                 bytes.push(0xda);\n                 uint16$1(bytes, length);\n                 size = 3;\n             }\n             // str 32\n             else if (length < 0x100000000) {\n                 bytes.push(0xdb);\n                 uint32$1(bytes, length);\n                 size = 5;\n             }\n             else {\n                 throw new Error('String too long');\n             }\n             utf8Write(bytes, bytes.length, value);\n             return size + length;\n         }\n         function number$1(bytes, value) {\n             if (isNaN(value)) {\n                 return number$1(bytes, 0);\n             }\n             else if (!isFinite(value)) {\n                 return number$1(bytes, (value > 0) ? Number.MAX_SAFE_INTEGER : -Number.MAX_SAFE_INTEGER);\n             }\n             else if (value !== (value | 0)) {\n                 bytes.push(0xcb);\n                 writeFloat64(bytes, value);\n                 return 9;\n                 // TODO: encode float 32?\n                 // is it possible to differentiate between float32 / float64 here?\n                 // // float 32\n                 // bytes.push(0xca);\n                 // writeFloat32(bytes, value);\n                 // return 5;\n             }\n             if (value >= 0) {\n                 // positive fixnum\n                 if (value < 0x80) {\n                     uint8$1(bytes, value);\n                     return 1;\n                 }\n                 // uint 8\n                 if (value < 0x100) {\n                     bytes.push(0xcc);\n                     uint8$1(bytes, value);\n                     return 2;\n                 }\n                 // uint 16\n                 if (value < 0x10000) {\n                     bytes.push(0xcd);\n                     uint16$1(bytes, value);\n                     return 3;\n                 }\n                 // uint 32\n                 if (value < 0x100000000) {\n                     bytes.push(0xce);\n                     uint32$1(bytes, value);\n                     return 5;\n                 }\n                 // uint 64\n                 bytes.push(0xcf);\n                 uint64$1(bytes, value);\n                 return 9;\n             }\n             else {\n                 // negative fixnum\n                 if (value >= -0x20) {\n                     bytes.push(0xe0 | (value + 0x20));\n                     return 1;\n                 }\n                 // int 8\n                 if (value >= -0x80) {\n                     bytes.push(0xd0);\n                     int8$1(bytes, value);\n                     return 2;\n                 }\n                 // int 16\n                 if (value >= -0x8000) {\n                     bytes.push(0xd1);\n                     int16$1(bytes, value);\n                     return 3;\n                 }\n                 // int 32\n                 if (value >= -0x80000000) {\n                     bytes.push(0xd2);\n                     int32$1(bytes, value);\n                     return 5;\n                 }\n                 // int 64\n                 bytes.push(0xd3);\n                 int64$1(bytes, value);\n                 return 9;\n             }\n         }\n\n         var encode = /*#__PURE__*/Object.freeze({\n             __proto__: null,\n             utf8Write: utf8Write,\n             int8: int8$1,\n             uint8: uint8$1,\n             int16: int16$1,\n             uint16: uint16$1,\n             int32: int32$1,\n             uint32: uint32$1,\n             int64: int64$1,\n             uint64: uint64$1,\n             float32: float32$1,\n             float64: float64$1,\n             writeFloat32: writeFloat32,\n             writeFloat64: writeFloat64,\n             boolean: boolean$1,\n             string: string$1,\n             number: number$1\n         });\n\n         /**\n          * Copyright (c) 2018 Endel Dreyer\n          * Copyright (c) 2014 Ion Drive Software Ltd.\n          *\n          * Permission is hereby granted, free of charge, to any person obtaining a copy\n          * of this software and associated documentation files (the \"Software\"), to deal\n          * in the Software without restriction, including without limitation the rights\n          * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n          * copies of the Software, and to permit persons to whom the Software is\n          * furnished to do so, subject to the following conditions:\n          *\n          * The above copyright notice and this permission notice shall be included in all\n          * copies or substantial portions of the Software.\n          *\n          * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n          * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n          * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n          * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n          * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n          * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n          * SOFTWARE\n          */\n         function utf8Read(bytes, offset, length) {\n             var string = '', chr = 0;\n             for (var i = offset, end = offset + length; i < end; i++) {\n                 var byte = bytes[i];\n                 if ((byte & 0x80) === 0x00) {\n                     string += String.fromCharCode(byte);\n                     continue;\n                 }\n                 if ((byte & 0xe0) === 0xc0) {\n                     string += String.fromCharCode(((byte & 0x1f) << 6) |\n                         (bytes[++i] & 0x3f));\n                     continue;\n                 }\n                 if ((byte & 0xf0) === 0xe0) {\n                     string += String.fromCharCode(((byte & 0x0f) << 12) |\n                         ((bytes[++i] & 0x3f) << 6) |\n                         ((bytes[++i] & 0x3f) << 0));\n                     continue;\n                 }\n                 if ((byte & 0xf8) === 0xf0) {\n                     chr = ((byte & 0x07) << 18) |\n                         ((bytes[++i] & 0x3f) << 12) |\n                         ((bytes[++i] & 0x3f) << 6) |\n                         ((bytes[++i] & 0x3f) << 0);\n                     if (chr >= 0x010000) { // surrogate pair\n                         chr -= 0x010000;\n                         string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n                     }\n                     else {\n                         string += String.fromCharCode(chr);\n                     }\n                     continue;\n                 }\n                 console.error('Invalid byte ' + byte.toString(16));\n                 // (do not throw error to avoid server/client from crashing due to hack attemps)\n                 // throw new Error('Invalid byte ' + byte.toString(16));\n             }\n             return string;\n         }\n         function int8(bytes, it) {\n             return uint8(bytes, it) << 24 >> 24;\n         }\n         function uint8(bytes, it) {\n             return bytes[it.offset++];\n         }\n         function int16(bytes, it) {\n             return uint16(bytes, it) << 16 >> 16;\n         }\n         function uint16(bytes, it) {\n             return bytes[it.offset++] | bytes[it.offset++] << 8;\n         }\n         function int32(bytes, it) {\n             return bytes[it.offset++] | bytes[it.offset++] << 8 | bytes[it.offset++] << 16 | bytes[it.offset++] << 24;\n         }\n         function uint32(bytes, it) {\n             return int32(bytes, it) >>> 0;\n         }\n         function float32(bytes, it) {\n             return readFloat32(bytes, it);\n         }\n         function float64(bytes, it) {\n             return readFloat64(bytes, it);\n         }\n         function int64(bytes, it) {\n             var low = uint32(bytes, it);\n             var high = int32(bytes, it) * Math.pow(2, 32);\n             return high + low;\n         }\n         function uint64(bytes, it) {\n             var low = uint32(bytes, it);\n             var high = uint32(bytes, it) * Math.pow(2, 32);\n             return high + low;\n         }\n         var _int32 = new Int32Array(2);\n         var _float32 = new Float32Array(_int32.buffer);\n         var _float64 = new Float64Array(_int32.buffer);\n         function readFloat32(bytes, it) {\n             _int32[0] = int32(bytes, it);\n             return _float32[0];\n         }\n         function readFloat64(bytes, it) {\n             _int32[0 ] = int32(bytes, it);\n             _int32[1 ] = int32(bytes, it);\n             return _float64[0];\n         }\n         function boolean(bytes, it) {\n             return uint8(bytes, it) > 0;\n         }\n         function string(bytes, it) {\n             var prefix = bytes[it.offset++];\n             var length;\n             if (prefix < 0xc0) {\n                 // fixstr\n                 length = prefix & 0x1f;\n             }\n             else if (prefix === 0xd9) {\n                 length = uint8(bytes, it);\n             }\n             else if (prefix === 0xda) {\n                 length = uint16(bytes, it);\n             }\n             else if (prefix === 0xdb) {\n                 length = uint32(bytes, it);\n             }\n             var value = utf8Read(bytes, it.offset, length);\n             it.offset += length;\n             return value;\n         }\n         function stringCheck(bytes, it) {\n             var prefix = bytes[it.offset];\n             return (\n             // fixstr\n             (prefix < 0xc0 && prefix > 0xa0) ||\n                 // str 8\n                 prefix === 0xd9 ||\n                 // str 16\n                 prefix === 0xda ||\n                 // str 32\n                 prefix === 0xdb);\n         }\n         function number(bytes, it) {\n             var prefix = bytes[it.offset++];\n             if (prefix < 0x80) {\n                 // positive fixint\n                 return prefix;\n             }\n             else if (prefix === 0xca) {\n                 // float 32\n                 return readFloat32(bytes, it);\n             }\n             else if (prefix === 0xcb) {\n                 // float 64\n                 return readFloat64(bytes, it);\n             }\n             else if (prefix === 0xcc) {\n                 // uint 8\n                 return uint8(bytes, it);\n             }\n             else if (prefix === 0xcd) {\n                 // uint 16\n                 return uint16(bytes, it);\n             }\n             else if (prefix === 0xce) {\n                 // uint 32\n                 return uint32(bytes, it);\n             }\n             else if (prefix === 0xcf) {\n                 // uint 64\n                 return uint64(bytes, it);\n             }\n             else if (prefix === 0xd0) {\n                 // int 8\n                 return int8(bytes, it);\n             }\n             else if (prefix === 0xd1) {\n                 // int 16\n                 return int16(bytes, it);\n             }\n             else if (prefix === 0xd2) {\n                 // int 32\n                 return int32(bytes, it);\n             }\n             else if (prefix === 0xd3) {\n                 // int 64\n                 return int64(bytes, it);\n             }\n             else if (prefix > 0xdf) {\n                 // negative fixint\n                 return (0xff - prefix + 1) * -1;\n             }\n         }\n         function numberCheck(bytes, it) {\n             var prefix = bytes[it.offset];\n             // positive fixint - 0x00 - 0x7f\n             // float 32        - 0xca\n             // float 64        - 0xcb\n             // uint 8          - 0xcc\n             // uint 16         - 0xcd\n             // uint 32         - 0xce\n             // uint 64         - 0xcf\n             // int 8           - 0xd0\n             // int 16          - 0xd1\n             // int 32          - 0xd2\n             // int 64          - 0xd3\n             return (prefix < 0x80 ||\n                 (prefix >= 0xca && prefix <= 0xd3));\n         }\n         function arrayCheck(bytes, it) {\n             return bytes[it.offset] < 0xa0;\n             // const prefix = bytes[it.offset] ;\n             // if (prefix < 0xa0) {\n             //   return prefix;\n             // // array\n             // } else if (prefix === 0xdc) {\n             //   it.offset += 2;\n             // } else if (0xdd) {\n             //   it.offset += 4;\n             // }\n             // return prefix;\n         }\n         function switchStructureCheck(bytes, it) {\n             return (\n             // previous byte should be `SWITCH_TO_STRUCTURE`\n             bytes[it.offset - 1] === SWITCH_TO_STRUCTURE &&\n                 // next byte should be a number\n                 (bytes[it.offset] < 0x80 || (bytes[it.offset] >= 0xca && bytes[it.offset] <= 0xd3)));\n         }\n\n         var decode = /*#__PURE__*/Object.freeze({\n             __proto__: null,\n             int8: int8,\n             uint8: uint8,\n             int16: int16,\n             uint16: uint16,\n             int32: int32,\n             uint32: uint32,\n             float32: float32,\n             float64: float64,\n             int64: int64,\n             uint64: uint64,\n             readFloat32: readFloat32,\n             readFloat64: readFloat64,\n             boolean: boolean,\n             string: string,\n             stringCheck: stringCheck,\n             number: number,\n             numberCheck: numberCheck,\n             arrayCheck: arrayCheck,\n             switchStructureCheck: switchStructureCheck\n         });\n\n         var CollectionSchema = /** @class */ (function () {\n             function CollectionSchema(initialValues) {\n                 var _this = this;\n                 this.$changes = new ChangeTree(this);\n                 this.$items = new Map();\n                 this.$indexes = new Map();\n                 this.$refId = 0;\n                 if (initialValues) {\n                     initialValues.forEach(function (v) { return _this.add(v); });\n                 }\n             }\n             CollectionSchema.prototype.onAdd = function (callback, triggerAll) {\n                 if (triggerAll === void 0) { triggerAll = true; }\n                 return addCallback((this.$callbacks || (this.$callbacks = [])), exports.OPERATION.ADD, callback, (triggerAll)\n                     ? this.$items\n                     : undefined);\n             };\n             CollectionSchema.prototype.onRemove = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.DELETE, callback); };\n             CollectionSchema.prototype.onChange = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.REPLACE, callback); };\n             CollectionSchema.is = function (type) {\n                 return type['collection'] !== undefined;\n             };\n             CollectionSchema.prototype.add = function (value) {\n                 // set \"index\" for reference.\n                 var index = this.$refId++;\n                 var isRef = (value['$changes']) !== undefined;\n                 if (isRef) {\n                     value['$changes'].setParent(this, this.$changes.root, index);\n                 }\n                 this.$changes.indexes[index] = index;\n                 this.$indexes.set(index, index);\n                 this.$items.set(index, value);\n                 this.$changes.change(index);\n                 return index;\n             };\n             CollectionSchema.prototype.at = function (index) {\n                 var key = Array.from(this.$items.keys())[index];\n                 return this.$items.get(key);\n             };\n             CollectionSchema.prototype.entries = function () {\n                 return this.$items.entries();\n             };\n             CollectionSchema.prototype.delete = function (item) {\n                 var entries = this.$items.entries();\n                 var index;\n                 var entry;\n                 while (entry = entries.next()) {\n                     if (entry.done) {\n                         break;\n                     }\n                     if (item === entry.value[1]) {\n                         index = entry.value[0];\n                         break;\n                     }\n                 }\n                 if (index === undefined) {\n                     return false;\n                 }\n                 this.$changes.delete(index);\n                 this.$indexes.delete(index);\n                 return this.$items.delete(index);\n             };\n             CollectionSchema.prototype.clear = function (changes) {\n                 // discard previous operations.\n                 this.$changes.discard(true, true);\n                 this.$changes.indexes = {};\n                 // clear previous indexes\n                 this.$indexes.clear();\n                 //\n                 // When decoding:\n                 // - enqueue items for DELETE callback.\n                 // - flag child items for garbage collection.\n                 //\n                 if (changes) {\n                     removeChildRefs.call(this, changes);\n                 }\n                 // clear items\n                 this.$items.clear();\n                 this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                 // touch all structures until reach root\n                 this.$changes.touchParents();\n             };\n             CollectionSchema.prototype.has = function (value) {\n                 return Array.from(this.$items.values()).some(function (v) { return v === value; });\n             };\n             CollectionSchema.prototype.forEach = function (callbackfn) {\n                 var _this = this;\n                 this.$items.forEach(function (value, key, _) { return callbackfn(value, key, _this); });\n             };\n             CollectionSchema.prototype.values = function () {\n                 return this.$items.values();\n             };\n             Object.defineProperty(CollectionSchema.prototype, \"size\", {\n                 get: function () {\n                     return this.$items.size;\n                 },\n                 enumerable: false,\n                 configurable: true\n             });\n             CollectionSchema.prototype.setIndex = function (index, key) {\n                 this.$indexes.set(index, key);\n             };\n             CollectionSchema.prototype.getIndex = function (index) {\n                 return this.$indexes.get(index);\n             };\n             CollectionSchema.prototype.getByIndex = function (index) {\n                 return this.$items.get(this.$indexes.get(index));\n             };\n             CollectionSchema.prototype.deleteByIndex = function (index) {\n                 var key = this.$indexes.get(index);\n                 this.$items.delete(key);\n                 this.$indexes.delete(index);\n             };\n             CollectionSchema.prototype.toArray = function () {\n                 return Array.from(this.$items.values());\n             };\n             CollectionSchema.prototype.toJSON = function () {\n                 var values = [];\n                 this.forEach(function (value, key) {\n                     values.push((typeof (value['toJSON']) === \"function\")\n                         ? value['toJSON']()\n                         : value);\n                 });\n                 return values;\n             };\n             //\n             // Decoding utilities\n             //\n             CollectionSchema.prototype.clone = function (isDecoding) {\n                 var cloned;\n                 if (isDecoding) {\n                     // client-side\n                     cloned = Object.assign(new CollectionSchema(), this);\n                 }\n                 else {\n                     // server-side\n                     cloned = new CollectionSchema();\n                     this.forEach(function (value) {\n                         if (value['$changes']) {\n                             cloned.add(value['clone']());\n                         }\n                         else {\n                             cloned.add(value);\n                         }\n                     });\n                 }\n                 return cloned;\n             };\n             return CollectionSchema;\n         }());\n\n         var SetSchema = /** @class */ (function () {\n             function SetSchema(initialValues) {\n                 var _this = this;\n                 this.$changes = new ChangeTree(this);\n                 this.$items = new Map();\n                 this.$indexes = new Map();\n                 this.$refId = 0;\n                 if (initialValues) {\n                     initialValues.forEach(function (v) { return _this.add(v); });\n                 }\n             }\n             SetSchema.prototype.onAdd = function (callback, triggerAll) {\n                 if (triggerAll === void 0) { triggerAll = true; }\n                 return addCallback((this.$callbacks || (this.$callbacks = [])), exports.OPERATION.ADD, callback, (triggerAll)\n                     ? this.$items\n                     : undefined);\n             };\n             SetSchema.prototype.onRemove = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.DELETE, callback); };\n             SetSchema.prototype.onChange = function (callback) { return addCallback(this.$callbacks || (this.$callbacks = []), exports.OPERATION.REPLACE, callback); };\n             SetSchema.is = function (type) {\n                 return type['set'] !== undefined;\n             };\n             SetSchema.prototype.add = function (value) {\n                 var _a, _b;\n                 // immediatelly return false if value already added.\n                 if (this.has(value)) {\n                     return false;\n                 }\n                 // set \"index\" for reference.\n                 var index = this.$refId++;\n                 if ((value['$changes']) !== undefined) {\n                     value['$changes'].setParent(this, this.$changes.root, index);\n                 }\n                 var operation = (_b = (_a = this.$changes.indexes[index]) === null || _a === void 0 ? void 0 : _a.op) !== null && _b !== void 0 ? _b : exports.OPERATION.ADD;\n                 this.$changes.indexes[index] = index;\n                 this.$indexes.set(index, index);\n                 this.$items.set(index, value);\n                 this.$changes.change(index, operation);\n                 return index;\n             };\n             SetSchema.prototype.entries = function () {\n                 return this.$items.entries();\n             };\n             SetSchema.prototype.delete = function (item) {\n                 var entries = this.$items.entries();\n                 var index;\n                 var entry;\n                 while (entry = entries.next()) {\n                     if (entry.done) {\n                         break;\n                     }\n                     if (item === entry.value[1]) {\n                         index = entry.value[0];\n                         break;\n                     }\n                 }\n                 if (index === undefined) {\n                     return false;\n                 }\n                 this.$changes.delete(index);\n                 this.$indexes.delete(index);\n                 return this.$items.delete(index);\n             };\n             SetSchema.prototype.clear = function (changes) {\n                 // discard previous operations.\n                 this.$changes.discard(true, true);\n                 this.$changes.indexes = {};\n                 // clear previous indexes\n                 this.$indexes.clear();\n                 //\n                 // When decoding:\n                 // - enqueue items for DELETE callback.\n                 // - flag child items for garbage collection.\n                 //\n                 if (changes) {\n                     removeChildRefs.call(this, changes);\n                 }\n                 // clear items\n                 this.$items.clear();\n                 this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                 // touch all structures until reach root\n                 this.$changes.touchParents();\n             };\n             SetSchema.prototype.has = function (value) {\n                 var values = this.$items.values();\n                 var has = false;\n                 var entry;\n                 while (entry = values.next()) {\n                     if (entry.done) {\n                         break;\n                     }\n                     if (value === entry.value) {\n                         has = true;\n                         break;\n                     }\n                 }\n                 return has;\n             };\n             SetSchema.prototype.forEach = function (callbackfn) {\n                 var _this = this;\n                 this.$items.forEach(function (value, key, _) { return callbackfn(value, key, _this); });\n             };\n             SetSchema.prototype.values = function () {\n                 return this.$items.values();\n             };\n             Object.defineProperty(SetSchema.prototype, \"size\", {\n                 get: function () {\n                     return this.$items.size;\n                 },\n                 enumerable: false,\n                 configurable: true\n             });\n             SetSchema.prototype.setIndex = function (index, key) {\n                 this.$indexes.set(index, key);\n             };\n             SetSchema.prototype.getIndex = function (index) {\n                 return this.$indexes.get(index);\n             };\n             SetSchema.prototype.getByIndex = function (index) {\n                 return this.$items.get(this.$indexes.get(index));\n             };\n             SetSchema.prototype.deleteByIndex = function (index) {\n                 var key = this.$indexes.get(index);\n                 this.$items.delete(key);\n                 this.$indexes.delete(index);\n             };\n             SetSchema.prototype.toArray = function () {\n                 return Array.from(this.$items.values());\n             };\n             SetSchema.prototype.toJSON = function () {\n                 var values = [];\n                 this.forEach(function (value, key) {\n                     values.push((typeof (value['toJSON']) === \"function\")\n                         ? value['toJSON']()\n                         : value);\n                 });\n                 return values;\n             };\n             //\n             // Decoding utilities\n             //\n             SetSchema.prototype.clone = function (isDecoding) {\n                 var cloned;\n                 if (isDecoding) {\n                     // client-side\n                     cloned = Object.assign(new SetSchema(), this);\n                 }\n                 else {\n                     // server-side\n                     cloned = new SetSchema();\n                     this.forEach(function (value) {\n                         if (value['$changes']) {\n                             cloned.add(value['clone']());\n                         }\n                         else {\n                             cloned.add(value);\n                         }\n                     });\n                 }\n                 return cloned;\n             };\n             return SetSchema;\n         }());\n\n         var ClientState = /** @class */ (function () {\n             function ClientState() {\n                 this.refIds = new WeakSet();\n                 this.containerIndexes = new WeakMap();\n             }\n             // containerIndexes = new Map<ChangeTree, Set<number>>();\n             ClientState.prototype.addRefId = function (changeTree) {\n                 if (!this.refIds.has(changeTree)) {\n                     this.refIds.add(changeTree);\n                     this.containerIndexes.set(changeTree, new Set());\n                 }\n             };\n             ClientState.get = function (client) {\n                 if (client.$filterState === undefined) {\n                     client.$filterState = new ClientState();\n                 }\n                 return client.$filterState;\n             };\n             return ClientState;\n         }());\n\n         var ReferenceTracker = /** @class */ (function () {\n             function ReferenceTracker() {\n                 //\n                 // Relation of refId => Schema structure\n                 // For direct access of structures during decoding time.\n                 //\n                 this.refs = new Map();\n                 this.refCounts = {};\n                 this.deletedRefs = new Set();\n                 this.nextUniqueId = 0;\n             }\n             ReferenceTracker.prototype.getNextUniqueId = function () {\n                 return this.nextUniqueId++;\n             };\n             // for decoding\n             ReferenceTracker.prototype.addRef = function (refId, ref, incrementCount) {\n                 if (incrementCount === void 0) { incrementCount = true; }\n                 this.refs.set(refId, ref);\n                 if (incrementCount) {\n                     this.refCounts[refId] = (this.refCounts[refId] || 0) + 1;\n                 }\n             };\n             // for decoding\n             ReferenceTracker.prototype.removeRef = function (refId) {\n                 this.refCounts[refId] = this.refCounts[refId] - 1;\n                 this.deletedRefs.add(refId);\n             };\n             ReferenceTracker.prototype.clearRefs = function () {\n                 this.refs.clear();\n                 this.deletedRefs.clear();\n                 this.refCounts = {};\n             };\n             // for decoding\n             ReferenceTracker.prototype.garbageCollectDeletedRefs = function () {\n                 var _this = this;\n                 this.deletedRefs.forEach(function (refId) {\n                     //\n                     // Skip active references.\n                     //\n                     if (_this.refCounts[refId] > 0) {\n                         return;\n                     }\n                     var ref = _this.refs.get(refId);\n                     //\n                     // Ensure child schema instances have their references removed as well.\n                     //\n                     if (ref instanceof Schema) {\n                         for (var fieldName in ref['_definition'].schema) {\n                             if (typeof (ref['_definition'].schema[fieldName]) !== \"string\" &&\n                                 ref[fieldName] &&\n                                 ref[fieldName]['$changes']) {\n                                 _this.removeRef(ref[fieldName]['$changes'].refId);\n                             }\n                         }\n                     }\n                     else {\n                         var definition = ref['$changes'].parent._definition;\n                         var type = definition.schema[definition.fieldsByIndex[ref['$changes'].parentIndex]];\n                         if (typeof (Object.values(type)[0]) === \"function\") {\n                             Array.from(ref.values())\n                                 .forEach(function (child) { return _this.removeRef(child['$changes'].refId); });\n                         }\n                     }\n                     _this.refs.delete(refId);\n                     delete _this.refCounts[refId];\n                 });\n                 // clear deleted refs.\n                 this.deletedRefs.clear();\n             };\n             return ReferenceTracker;\n         }());\n\n         var EncodeSchemaError = /** @class */ (function (_super) {\n             __extends(EncodeSchemaError, _super);\n             function EncodeSchemaError() {\n                 return _super !== null && _super.apply(this, arguments) || this;\n             }\n             return EncodeSchemaError;\n         }(Error));\n         function assertType(value, type, klass, field) {\n             var typeofTarget;\n             var allowNull = false;\n             switch (type) {\n                 case \"number\":\n                 case \"int8\":\n                 case \"uint8\":\n                 case \"int16\":\n                 case \"uint16\":\n                 case \"int32\":\n                 case \"uint32\":\n                 case \"int64\":\n                 case \"uint64\":\n                 case \"float32\":\n                 case \"float64\":\n                     typeofTarget = \"number\";\n                     if (isNaN(value)) {\n                         console.log(\"trying to encode \\\"NaN\\\" in \".concat(klass.constructor.name, \"#\").concat(field));\n                     }\n                     break;\n                 case \"string\":\n                     typeofTarget = \"string\";\n                     allowNull = true;\n                     break;\n                 case \"boolean\":\n                     // boolean is always encoded as true/false based on truthiness\n                     return;\n             }\n             if (typeof (value) !== typeofTarget && (!allowNull || (allowNull && value !== null))) {\n                 var foundValue = \"'\".concat(JSON.stringify(value), \"'\").concat((value && value.constructor && \" (\".concat(value.constructor.name, \")\")) || '');\n                 throw new EncodeSchemaError(\"a '\".concat(typeofTarget, \"' was expected, but \").concat(foundValue, \" was provided in \").concat(klass.constructor.name, \"#\").concat(field));\n             }\n         }\n         function assertInstanceType(value, type, klass, field) {\n             if (!(value instanceof type)) {\n                 throw new EncodeSchemaError(\"a '\".concat(type.name, \"' was expected, but '\").concat(value.constructor.name, \"' was provided in \").concat(klass.constructor.name, \"#\").concat(field));\n             }\n         }\n         function encodePrimitiveType(type, bytes, value, klass, field) {\n             assertType(value, type, klass, field);\n             var encodeFunc = encode[type];\n             if (encodeFunc) {\n                 encodeFunc(bytes, value);\n             }\n             else {\n                 throw new EncodeSchemaError(\"a '\".concat(type, \"' was expected, but \").concat(value, \" was provided in \").concat(klass.constructor.name, \"#\").concat(field));\n             }\n         }\n         function decodePrimitiveType(type, bytes, it) {\n             return decode[type](bytes, it);\n         }\n         /**\n          * Schema encoder / decoder\n          */\n         var Schema = /** @class */ (function () {\n             // allow inherited classes to have a constructor\n             function Schema() {\n                 var args = [];\n                 for (var _i = 0; _i < arguments.length; _i++) {\n                     args[_i] = arguments[_i];\n                 }\n                 // fix enumerability of fields for end-user\n                 Object.defineProperties(this, {\n                     $changes: {\n                         value: new ChangeTree(this, undefined, new ReferenceTracker()),\n                         enumerable: false,\n                         writable: true\n                     },\n                     // $listeners: {\n                     //     value: undefined,\n                     //     enumerable: false,\n                     //     writable: true\n                     // },\n                     $callbacks: {\n                         value: undefined,\n                         enumerable: false,\n                         writable: true\n                     },\n                 });\n                 var descriptors = this._definition.descriptors;\n                 if (descriptors) {\n                     Object.defineProperties(this, descriptors);\n                 }\n                 //\n                 // Assign initial values\n                 //\n                 if (args[0]) {\n                     this.assign(args[0]);\n                 }\n             }\n             Schema.onError = function (e) {\n                 console.error(e);\n             };\n             Schema.is = function (type) {\n                 return (type['_definition'] &&\n                     type['_definition'].schema !== undefined);\n             };\n             Schema.prototype.onChange = function (callback) {\n                 return addCallback((this.$callbacks || (this.$callbacks = [])), exports.OPERATION.REPLACE, callback);\n             };\n             Schema.prototype.onRemove = function (callback) {\n                 return addCallback((this.$callbacks || (this.$callbacks = [])), exports.OPERATION.DELETE, callback);\n             };\n             Schema.prototype.assign = function (props) {\n                 Object.assign(this, props);\n                 return this;\n             };\n             Object.defineProperty(Schema.prototype, \"_definition\", {\n                 get: function () { return this.constructor._definition; },\n                 enumerable: false,\n                 configurable: true\n             });\n             /**\n              * (Server-side): Flag a property to be encoded for the next patch.\n              * @param instance Schema instance\n              * @param property string representing the property name, or number representing the index of the property.\n              * @param operation OPERATION to perform (detected automatically)\n              */\n             Schema.prototype.setDirty = function (property, operation) {\n                 this.$changes.change(property, operation);\n             };\n             Schema.prototype.listen = function (attr, callback) {\n                 var _this = this;\n                 if (!this.$callbacks) {\n                     this.$callbacks = {};\n                 }\n                 if (!this.$callbacks[attr]) {\n                     this.$callbacks[attr] = [];\n                 }\n                 this.$callbacks[attr].push(callback);\n                 // return un-register callback.\n                 return function () { return spliceOne(_this.$callbacks[attr], _this.$callbacks[attr].indexOf(callback)); };\n             };\n             Schema.prototype.decode = function (bytes, it, ref) {\n                 var _a;\n                 if (it === void 0) { it = { offset: 0 }; }\n                 if (ref === void 0) { ref = this; }\n                 var allChanges = [];\n                 var $root = this.$changes.root;\n                 var totalBytes = bytes.length;\n                 var refId = 0;\n                 $root.refs.set(refId, this);\n                 while (it.offset < totalBytes) {\n                     var byte = bytes[it.offset++];\n                     if (byte == SWITCH_TO_STRUCTURE) {\n                         refId = number(bytes, it);\n                         var nextRef = $root.refs.get(refId);\n                         //\n                         // Trying to access a reference that haven't been decoded yet.\n                         //\n                         if (!nextRef) {\n                             throw new Error(\"\\\"refId\\\" not found: \".concat(refId));\n                         }\n                         ref = nextRef;\n                         continue;\n                     }\n                     var changeTree = ref['$changes'];\n                     var isSchema = (ref['_definition'] !== undefined);\n                     var operation = (isSchema)\n                         ? (byte >> 6) << 6 // \"compressed\" index + operation\n                         : byte; // \"uncompressed\" index + operation (array/map items)\n                     if (operation === exports.OPERATION.CLEAR) {\n                         //\n                         // TODO: refactor me!\n                         // The `.clear()` method is calling `$root.removeRef(refId)` for\n                         // each item inside this collection\n                         //\n                         ref.clear(allChanges);\n                         continue;\n                     }\n                     var fieldIndex = (isSchema)\n                         ? byte % (operation || 255) // if \"REPLACE\" operation (0), use 255\n                         : number(bytes, it);\n                     var fieldName = (isSchema)\n                         ? (ref['_definition'].fieldsByIndex[fieldIndex])\n                         : \"\";\n                     var type = changeTree.getType(fieldIndex);\n                     var value = void 0;\n                     var previousValue = void 0;\n                     var dynamicIndex = void 0;\n                     if (!isSchema) {\n                         previousValue = ref['getByIndex'](fieldIndex);\n                         if ((operation & exports.OPERATION.ADD) === exports.OPERATION.ADD) { // ADD or DELETE_AND_ADD\n                             dynamicIndex = (ref instanceof MapSchema)\n                                 ? string(bytes, it)\n                                 : fieldIndex;\n                             ref['setIndex'](fieldIndex, dynamicIndex);\n                         }\n                         else {\n                             // here\n                             dynamicIndex = ref['getIndex'](fieldIndex);\n                         }\n                     }\n                     else {\n                         previousValue = ref[\"_\".concat(fieldName)];\n                     }\n                     //\n                     // Delete operations\n                     //\n                     if ((operation & exports.OPERATION.DELETE) === exports.OPERATION.DELETE) {\n                         if (operation !== exports.OPERATION.DELETE_AND_ADD) {\n                             ref['deleteByIndex'](fieldIndex);\n                         }\n                         // Flag `refId` for garbage collection.\n                         if (previousValue && previousValue['$changes']) {\n                             $root.removeRef(previousValue['$changes'].refId);\n                         }\n                         value = null;\n                     }\n                     if (fieldName === undefined) {\n                         console.warn(\"@colyseus/schema: definition mismatch\");\n                         //\n                         // keep skipping next bytes until reaches a known structure\n                         // by local decoder.\n                         //\n                         var nextIterator = { offset: it.offset };\n                         while (it.offset < totalBytes) {\n                             if (switchStructureCheck(bytes, it)) {\n                                 nextIterator.offset = it.offset + 1;\n                                 if ($root.refs.has(number(bytes, nextIterator))) {\n                                     break;\n                                 }\n                             }\n                             it.offset++;\n                         }\n                         continue;\n                     }\n                     else if (operation === exports.OPERATION.DELETE) ;\n                     else if (Schema.is(type)) {\n                         var refId_1 = number(bytes, it);\n                         value = $root.refs.get(refId_1);\n                         if (operation !== exports.OPERATION.REPLACE) {\n                             var childType = this.getSchemaType(bytes, it, type);\n                             if (!value) {\n                                 value = this.createTypeInstance(childType);\n                                 value.$changes.refId = refId_1;\n                                 if (previousValue) {\n                                     value.$callbacks = previousValue.$callbacks;\n                                     // value.$listeners = previousValue.$listeners;\n                                     if (previousValue['$changes'].refId &&\n                                         refId_1 !== previousValue['$changes'].refId) {\n                                         $root.removeRef(previousValue['$changes'].refId);\n                                     }\n                                 }\n                             }\n                             $root.addRef(refId_1, value, (value !== previousValue));\n                         }\n                     }\n                     else if (typeof (type) === \"string\") {\n                         //\n                         // primitive value (number, string, boolean, etc)\n                         //\n                         value = decodePrimitiveType(type, bytes, it);\n                     }\n                     else {\n                         var typeDef = getType(Object.keys(type)[0]);\n                         var refId_2 = number(bytes, it);\n                         var valueRef = ($root.refs.has(refId_2))\n                             ? previousValue || $root.refs.get(refId_2)\n                             : new typeDef.constructor();\n                         value = valueRef.clone(true);\n                         value.$changes.refId = refId_2;\n                         // preserve schema callbacks\n                         if (previousValue) {\n                             value['$callbacks'] = previousValue['$callbacks'];\n                             if (previousValue['$changes'].refId &&\n                                 refId_2 !== previousValue['$changes'].refId) {\n                                 $root.removeRef(previousValue['$changes'].refId);\n                                 //\n                                 // Trigger onRemove if structure has been replaced.\n                                 //\n                                 var entries = previousValue.entries();\n                                 var iter = void 0;\n                                 while ((iter = entries.next()) && !iter.done) {\n                                     var key = (_a = iter.value, _a[0]), value_1 = _a[1];\n                                     allChanges.push({\n                                         refId: refId_2,\n                                         op: exports.OPERATION.DELETE,\n                                         field: key,\n                                         value: undefined,\n                                         previousValue: value_1,\n                                     });\n                                 }\n                             }\n                         }\n                         $root.addRef(refId_2, value, (valueRef !== previousValue));\n                     }\n                     if (value !== null &&\n                         value !== undefined) {\n                         if (value['$changes']) {\n                             value['$changes'].setParent(changeTree.ref, changeTree.root, fieldIndex);\n                         }\n                         if (ref instanceof Schema) {\n                             ref[fieldName] = value;\n                             // ref[`_${fieldName}`] = value;\n                         }\n                         else if (ref instanceof MapSchema) {\n                             // const key = ref['$indexes'].get(field);\n                             var key = dynamicIndex;\n                             // ref.set(key, value);\n                             ref['$items'].set(key, value);\n                             ref['$changes'].allChanges.add(fieldIndex);\n                         }\n                         else if (ref instanceof ArraySchema) {\n                             // const key = ref['$indexes'][field];\n                             // console.log(\"SETTING FOR ArraySchema =>\", { field, key, value });\n                             // ref[key] = value;\n                             ref.setAt(fieldIndex, value);\n                         }\n                         else if (ref instanceof CollectionSchema) {\n                             var index = ref.add(value);\n                             ref['setIndex'](fieldIndex, index);\n                         }\n                         else if (ref instanceof SetSchema) {\n                             var index = ref.add(value);\n                             if (index !== false) {\n                                 ref['setIndex'](fieldIndex, index);\n                             }\n                         }\n                     }\n                     if (previousValue !== value) {\n                         allChanges.push({\n                             refId: refId,\n                             op: operation,\n                             field: fieldName,\n                             dynamicIndex: dynamicIndex,\n                             value: value,\n                             previousValue: previousValue,\n                         });\n                     }\n                 }\n                 this._triggerChanges(allChanges);\n                 // drop references of unused schemas\n                 $root.garbageCollectDeletedRefs();\n                 return allChanges;\n             };\n             Schema.prototype.encode = function (encodeAll, bytes, useFilters) {\n                 if (encodeAll === void 0) { encodeAll = false; }\n                 if (bytes === void 0) { bytes = []; }\n                 if (useFilters === void 0) { useFilters = false; }\n                 var rootChangeTree = this.$changes;\n                 var refIdsVisited = new WeakSet();\n                 var changeTrees = [rootChangeTree];\n                 var numChangeTrees = 1;\n                 for (var i = 0; i < numChangeTrees; i++) {\n                     var changeTree = changeTrees[i];\n                     var ref = changeTree.ref;\n                     var isSchema = (ref instanceof Schema);\n                     // Generate unique refId for the ChangeTree.\n                     changeTree.ensureRefId();\n                     // mark this ChangeTree as visited.\n                     refIdsVisited.add(changeTree);\n                     // root `refId` is skipped.\n                     if (changeTree !== rootChangeTree &&\n                         (changeTree.changed || encodeAll)) {\n                         uint8$1(bytes, SWITCH_TO_STRUCTURE);\n                         number$1(bytes, changeTree.refId);\n                     }\n                     var changes = (encodeAll)\n                         ? Array.from(changeTree.allChanges)\n                         : Array.from(changeTree.changes.values());\n                     for (var j = 0, cl = changes.length; j < cl; j++) {\n                         var operation = (encodeAll)\n                             ? { op: exports.OPERATION.ADD, index: changes[j] }\n                             : changes[j];\n                         var fieldIndex = operation.index;\n                         var field = (isSchema)\n                             ? ref['_definition'].fieldsByIndex && ref['_definition'].fieldsByIndex[fieldIndex]\n                             : fieldIndex;\n                         // cache begin index if `useFilters`\n                         var beginIndex = bytes.length;\n                         // encode field index + operation\n                         if (operation.op !== exports.OPERATION.TOUCH) {\n                             if (isSchema) {\n                                 //\n                                 // Compress `fieldIndex` + `operation` into a single byte.\n                                 // This adds a limitaion of 64 fields per Schema structure\n                                 //\n                                 uint8$1(bytes, (fieldIndex | operation.op));\n                             }\n                             else {\n                                 uint8$1(bytes, operation.op);\n                                 // custom operations\n                                 if (operation.op === exports.OPERATION.CLEAR) {\n                                     continue;\n                                 }\n                                 // indexed operations\n                                 number$1(bytes, fieldIndex);\n                             }\n                         }\n                         //\n                         // encode \"alias\" for dynamic fields (maps)\n                         //\n                         if (!isSchema &&\n                             (operation.op & exports.OPERATION.ADD) == exports.OPERATION.ADD // ADD or DELETE_AND_ADD\n                         ) {\n                             if (ref instanceof MapSchema) {\n                                 //\n                                 // MapSchema dynamic key\n                                 //\n                                 var dynamicIndex = changeTree.ref['$indexes'].get(fieldIndex);\n                                 string$1(bytes, dynamicIndex);\n                             }\n                         }\n                         if (operation.op === exports.OPERATION.DELETE) {\n                             //\n                             // TODO: delete from filter cache data.\n                             //\n                             // if (useFilters) {\n                             //     delete changeTree.caches[fieldIndex];\n                             // }\n                             continue;\n                         }\n                         // const type = changeTree.childType || ref._schema[field];\n                         var type = changeTree.getType(fieldIndex);\n                         // const type = changeTree.getType(fieldIndex);\n                         var value = changeTree.getValue(fieldIndex);\n                         // Enqueue ChangeTree to be visited\n                         if (value &&\n                             value['$changes'] &&\n                             !refIdsVisited.has(value['$changes'])) {\n                             changeTrees.push(value['$changes']);\n                             value['$changes'].ensureRefId();\n                             numChangeTrees++;\n                         }\n                         if (operation.op === exports.OPERATION.TOUCH) {\n                             continue;\n                         }\n                         if (Schema.is(type)) {\n                             assertInstanceType(value, type, ref, field);\n                             //\n                             // Encode refId for this instance.\n                             // The actual instance is going to be encoded on next `changeTree` iteration.\n                             //\n                             number$1(bytes, value.$changes.refId);\n                             // Try to encode inherited TYPE_ID if it's an ADD operation.\n                             if ((operation.op & exports.OPERATION.ADD) === exports.OPERATION.ADD) {\n                                 this.tryEncodeTypeId(bytes, type, value.constructor);\n                             }\n                         }\n                         else if (typeof (type) === \"string\") {\n                             //\n                             // Primitive values\n                             //\n                             encodePrimitiveType(type, bytes, value, ref, field);\n                         }\n                         else {\n                             //\n                             // Custom type (MapSchema, ArraySchema, etc)\n                             //\n                             var definition = getType(Object.keys(type)[0]);\n                             //\n                             // ensure a ArraySchema has been provided\n                             //\n                             assertInstanceType(ref[\"_\".concat(field)], definition.constructor, ref, field);\n                             //\n                             // Encode refId for this instance.\n                             // The actual instance is going to be encoded on next `changeTree` iteration.\n                             //\n                             number$1(bytes, value.$changes.refId);\n                         }\n                         if (useFilters) {\n                             // cache begin / end index\n                             changeTree.cache(fieldIndex, bytes.slice(beginIndex));\n                         }\n                     }\n                     if (!encodeAll && !useFilters) {\n                         changeTree.discard();\n                     }\n                 }\n                 return bytes;\n             };\n             Schema.prototype.encodeAll = function (useFilters) {\n                 return this.encode(true, [], useFilters);\n             };\n             Schema.prototype.applyFilters = function (client, encodeAll) {\n                 var _a, _b;\n                 if (encodeAll === void 0) { encodeAll = false; }\n                 var root = this;\n                 var refIdsDissallowed = new Set();\n                 var $filterState = ClientState.get(client);\n                 var changeTrees = [this.$changes];\n                 var numChangeTrees = 1;\n                 var filteredBytes = [];\n                 var _loop_1 = function (i) {\n                     var changeTree = changeTrees[i];\n                     if (refIdsDissallowed.has(changeTree.refId)) {\n                         return \"continue\";\n                     }\n                     var ref = changeTree.ref;\n                     var isSchema = ref instanceof Schema;\n                     uint8$1(filteredBytes, SWITCH_TO_STRUCTURE);\n                     number$1(filteredBytes, changeTree.refId);\n                     var clientHasRefId = $filterState.refIds.has(changeTree);\n                     var isEncodeAll = (encodeAll || !clientHasRefId);\n                     // console.log(\"REF:\", ref.constructor.name);\n                     // console.log(\"Encode all?\", isEncodeAll);\n                     //\n                     // include `changeTree` on list of known refIds by this client.\n                     //\n                     $filterState.addRefId(changeTree);\n                     var containerIndexes = $filterState.containerIndexes.get(changeTree);\n                     var changes = (isEncodeAll)\n                         ? Array.from(changeTree.allChanges)\n                         : Array.from(changeTree.changes.values());\n                     //\n                     // WORKAROUND: tries to re-evaluate previously not included @filter() attributes\n                     // - see \"DELETE a field of Schema\" test case.\n                     //\n                     if (!encodeAll &&\n                         isSchema &&\n                         ref._definition.indexesWithFilters) {\n                         var indexesWithFilters = ref._definition.indexesWithFilters;\n                         indexesWithFilters.forEach(function (indexWithFilter) {\n                             if (!containerIndexes.has(indexWithFilter) &&\n                                 changeTree.allChanges.has(indexWithFilter)) {\n                                 if (isEncodeAll) {\n                                     changes.push(indexWithFilter);\n                                 }\n                                 else {\n                                     changes.push({ op: exports.OPERATION.ADD, index: indexWithFilter, });\n                                 }\n                             }\n                         });\n                     }\n                     for (var j = 0, cl = changes.length; j < cl; j++) {\n                         var change = (isEncodeAll)\n                             ? { op: exports.OPERATION.ADD, index: changes[j] }\n                             : changes[j];\n                         // custom operations\n                         if (change.op === exports.OPERATION.CLEAR) {\n                             uint8$1(filteredBytes, change.op);\n                             continue;\n                         }\n                         var fieldIndex = change.index;\n                         //\n                         // Deleting fields: encode the operation + field index\n                         //\n                         if (change.op === exports.OPERATION.DELETE) {\n                             //\n                             // DELETE operations also need to go through filtering.\n                             //\n                             // TODO: cache the previous value so we can access the value (primitive or `refId`)\n                             // (check against `$filterState.refIds`)\n                             //\n                             if (isSchema) {\n                                 uint8$1(filteredBytes, change.op | fieldIndex);\n                             }\n                             else {\n                                 uint8$1(filteredBytes, change.op);\n                                 number$1(filteredBytes, fieldIndex);\n                             }\n                             continue;\n                         }\n                         // indexed operation\n                         var value = changeTree.getValue(fieldIndex);\n                         var type = changeTree.getType(fieldIndex);\n                         if (isSchema) {\n                             // Is a Schema!\n                             var filter = (ref._definition.filters &&\n                                 ref._definition.filters[fieldIndex]);\n                             if (filter && !filter.call(ref, client, value, root)) {\n                                 if (value && value['$changes']) {\n                                     refIdsDissallowed.add(value['$changes'].refId);\n                                 }\n                                 continue;\n                             }\n                         }\n                         else {\n                             // Is a collection! (map, array, etc.)\n                             var parent = changeTree.parent;\n                             var filter = changeTree.getChildrenFilter();\n                             if (filter && !filter.call(parent, client, ref['$indexes'].get(fieldIndex), value, root)) {\n                                 if (value && value['$changes']) {\n                                     refIdsDissallowed.add(value['$changes'].refId);\n                                 }\n                                 continue;\n                             }\n                         }\n                         // visit child ChangeTree on further iteration.\n                         if (value['$changes']) {\n                             changeTrees.push(value['$changes']);\n                             numChangeTrees++;\n                         }\n                         //\n                         // Copy cached bytes\n                         //\n                         if (change.op !== exports.OPERATION.TOUCH) {\n                             //\n                             // TODO: refactor me!\n                             //\n                             if (change.op === exports.OPERATION.ADD || isSchema) {\n                                 //\n                                 // use cached bytes directly if is from Schema type.\n                                 //\n                                 filteredBytes.push.apply(filteredBytes, (_a = changeTree.caches[fieldIndex]) !== null && _a !== void 0 ? _a : []);\n                                 containerIndexes.add(fieldIndex);\n                             }\n                             else {\n                                 if (containerIndexes.has(fieldIndex)) {\n                                     //\n                                     // use cached bytes if already has the field\n                                     //\n                                     filteredBytes.push.apply(filteredBytes, (_b = changeTree.caches[fieldIndex]) !== null && _b !== void 0 ? _b : []);\n                                 }\n                                 else {\n                                     //\n                                     // force ADD operation if field is not known by this client.\n                                     //\n                                     containerIndexes.add(fieldIndex);\n                                     uint8$1(filteredBytes, exports.OPERATION.ADD);\n                                     number$1(filteredBytes, fieldIndex);\n                                     if (ref instanceof MapSchema) {\n                                         //\n                                         // MapSchema dynamic key\n                                         //\n                                         var dynamicIndex = changeTree.ref['$indexes'].get(fieldIndex);\n                                         string$1(filteredBytes, dynamicIndex);\n                                     }\n                                     if (value['$changes']) {\n                                         number$1(filteredBytes, value['$changes'].refId);\n                                     }\n                                     else {\n                                         // \"encodePrimitiveType\" without type checking.\n                                         // the type checking has been done on the first .encode() call.\n                                         encode[type](filteredBytes, value);\n                                     }\n                                 }\n                             }\n                         }\n                         else if (value['$changes'] && !isSchema) {\n                             //\n                             // TODO:\n                             // - track ADD/REPLACE/DELETE instances on `$filterState`\n                             // - do NOT always encode dynamicIndex for MapSchema.\n                             //   (If client already has that key, only the first index is necessary.)\n                             //\n                             uint8$1(filteredBytes, exports.OPERATION.ADD);\n                             number$1(filteredBytes, fieldIndex);\n                             if (ref instanceof MapSchema) {\n                                 //\n                                 // MapSchema dynamic key\n                                 //\n                                 var dynamicIndex = changeTree.ref['$indexes'].get(fieldIndex);\n                                 string$1(filteredBytes, dynamicIndex);\n                             }\n                             number$1(filteredBytes, value['$changes'].refId);\n                         }\n                     }\n                 };\n                 for (var i = 0; i < numChangeTrees; i++) {\n                     _loop_1(i);\n                 }\n                 return filteredBytes;\n             };\n             Schema.prototype.clone = function () {\n                 var _a;\n                 var cloned = new (this.constructor);\n                 var schema = this._definition.schema;\n                 for (var field in schema) {\n                     if (typeof (this[field]) === \"object\" &&\n                         typeof ((_a = this[field]) === null || _a === void 0 ? void 0 : _a.clone) === \"function\") {\n                         // deep clone\n                         cloned[field] = this[field].clone();\n                     }\n                     else {\n                         // primitive values\n                         cloned[field] = this[field];\n                     }\n                 }\n                 return cloned;\n             };\n             Schema.prototype.toJSON = function () {\n                 var schema = this._definition.schema;\n                 var deprecated = this._definition.deprecated;\n                 var obj = {};\n                 for (var field in schema) {\n                     if (!deprecated[field] && this[field] !== null && typeof (this[field]) !== \"undefined\") {\n                         obj[field] = (typeof (this[field]['toJSON']) === \"function\")\n                             ? this[field]['toJSON']()\n                             : this[\"_\".concat(field)];\n                     }\n                 }\n                 return obj;\n             };\n             Schema.prototype.discardAllChanges = function () {\n                 this.$changes.discardAll();\n             };\n             Schema.prototype.getByIndex = function (index) {\n                 return this[this._definition.fieldsByIndex[index]];\n             };\n             Schema.prototype.deleteByIndex = function (index) {\n                 this[this._definition.fieldsByIndex[index]] = undefined;\n             };\n             Schema.prototype.tryEncodeTypeId = function (bytes, type, targetType) {\n                 if (type._typeid !== targetType._typeid) {\n                     uint8$1(bytes, TYPE_ID);\n                     number$1(bytes, targetType._typeid);\n                 }\n             };\n             Schema.prototype.getSchemaType = function (bytes, it, defaultType) {\n                 var type;\n                 if (bytes[it.offset] === TYPE_ID) {\n                     it.offset++;\n                     type = this.constructor._context.get(number(bytes, it));\n                 }\n                 return type || defaultType;\n             };\n             Schema.prototype.createTypeInstance = function (type) {\n                 var instance = new type();\n                 // assign root on $changes\n                 instance.$changes.root = this.$changes.root;\n                 return instance;\n             };\n             Schema.prototype._triggerChanges = function (changes) {\n                 var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n                 var uniqueRefIds = new Set();\n                 var $refs = this.$changes.root.refs;\n                 var _loop_2 = function (i) {\n                     var change = changes[i];\n                     var refId = change.refId;\n                     var ref = $refs.get(refId);\n                     var $callbacks = ref['$callbacks'];\n                     //\n                     // trigger onRemove on child structure.\n                     //\n                     if ((change.op & exports.OPERATION.DELETE) === exports.OPERATION.DELETE &&\n                         change.previousValue instanceof Schema) {\n                         (_b = (_a = change.previousValue['$callbacks']) === null || _a === void 0 ? void 0 : _a[exports.OPERATION.DELETE]) === null || _b === void 0 ? void 0 : _b.forEach(function (callback) { return callback(); });\n                     }\n                     // no callbacks defined, skip this structure!\n                     if (!$callbacks) {\n                         return \"continue\";\n                     }\n                     if (ref instanceof Schema) {\n                         if (!uniqueRefIds.has(refId)) {\n                             try {\n                                 // trigger onChange\n                                 (_c = $callbacks === null || $callbacks === void 0 ? void 0 : $callbacks[exports.OPERATION.REPLACE]) === null || _c === void 0 ? void 0 : _c.forEach(function (callback) {\n                                     return callback(changes);\n                                 });\n                             }\n                             catch (e) {\n                                 Schema.onError(e);\n                             }\n                         }\n                         try {\n                             if ($callbacks.hasOwnProperty(change.field)) {\n                                 (_d = $callbacks[change.field]) === null || _d === void 0 ? void 0 : _d.forEach(function (callback) {\n                                     return callback(change.value, change.previousValue);\n                                 });\n                             }\n                         }\n                         catch (e) {\n                             Schema.onError(e);\n                         }\n                     }\n                     else {\n                         // is a collection of items\n                         if (change.op === exports.OPERATION.ADD && change.previousValue === undefined) {\n                             // triger onAdd\n                             (_e = $callbacks[exports.OPERATION.ADD]) === null || _e === void 0 ? void 0 : _e.forEach(function (callback) { var _a; return callback(change.value, (_a = change.dynamicIndex) !== null && _a !== void 0 ? _a : change.field); });\n                         }\n                         else if (change.op === exports.OPERATION.DELETE) {\n                             //\n                             // FIXME: `previousValue` should always be available.\n                             // ADD + DELETE operations are still encoding DELETE operation.\n                             //\n                             if (change.previousValue !== undefined) {\n                                 // triger onRemove\n                                 (_f = $callbacks[exports.OPERATION.DELETE]) === null || _f === void 0 ? void 0 : _f.forEach(function (callback) { var _a; return callback(change.previousValue, (_a = change.dynamicIndex) !== null && _a !== void 0 ? _a : change.field); });\n                             }\n                         }\n                         else if (change.op === exports.OPERATION.DELETE_AND_ADD) {\n                             // triger onRemove\n                             if (change.previousValue !== undefined) {\n                                 (_g = $callbacks[exports.OPERATION.DELETE]) === null || _g === void 0 ? void 0 : _g.forEach(function (callback) { var _a; return callback(change.previousValue, (_a = change.dynamicIndex) !== null && _a !== void 0 ? _a : change.field); });\n                             }\n                             // triger onAdd\n                             (_h = $callbacks[exports.OPERATION.ADD]) === null || _h === void 0 ? void 0 : _h.forEach(function (callback) { var _a; return callback(change.value, (_a = change.dynamicIndex) !== null && _a !== void 0 ? _a : change.field); });\n                         }\n                         // trigger onChange\n                         if (change.value !== change.previousValue) {\n                             (_j = $callbacks[exports.OPERATION.REPLACE]) === null || _j === void 0 ? void 0 : _j.forEach(function (callback) { var _a; return callback(change.value, (_a = change.dynamicIndex) !== null && _a !== void 0 ? _a : change.field); });\n                         }\n                     }\n                     uniqueRefIds.add(refId);\n                 };\n                 for (var i = 0; i < changes.length; i++) {\n                     _loop_2(i);\n                 }\n             };\n             Schema._definition = SchemaDefinition.create();\n             return Schema;\n         }());\n\n         function dumpChanges(schema) {\n             var changeTrees = [schema['$changes']];\n             var numChangeTrees = 1;\n             var dump = {};\n             var currentStructure = dump;\n             var _loop_1 = function (i) {\n                 var changeTree = changeTrees[i];\n                 changeTree.changes.forEach(function (change) {\n                     var ref = changeTree.ref;\n                     var fieldIndex = change.index;\n                     var field = (ref['_definition'])\n                         ? ref['_definition'].fieldsByIndex[fieldIndex]\n                         : ref['$indexes'].get(fieldIndex);\n                     currentStructure[field] = changeTree.getValue(fieldIndex);\n                 });\n             };\n             for (var i = 0; i < numChangeTrees; i++) {\n                 _loop_1(i);\n             }\n             return dump;\n         }\n\n         var reflectionContext = { context: new Context() };\n         /**\n          * Reflection\n          */\n         var ReflectionField = /** @class */ (function (_super) {\n             __extends(ReflectionField, _super);\n             function ReflectionField() {\n                 return _super !== null && _super.apply(this, arguments) || this;\n             }\n             __decorate([\n                 type(\"string\", reflectionContext)\n             ], ReflectionField.prototype, \"name\", void 0);\n             __decorate([\n                 type(\"string\", reflectionContext)\n             ], ReflectionField.prototype, \"type\", void 0);\n             __decorate([\n                 type(\"number\", reflectionContext)\n             ], ReflectionField.prototype, \"referencedType\", void 0);\n             return ReflectionField;\n         }(Schema));\n         var ReflectionType = /** @class */ (function (_super) {\n             __extends(ReflectionType, _super);\n             function ReflectionType() {\n                 var _this = _super !== null && _super.apply(this, arguments) || this;\n                 _this.fields = new ArraySchema();\n                 return _this;\n             }\n             __decorate([\n                 type(\"number\", reflectionContext)\n             ], ReflectionType.prototype, \"id\", void 0);\n             __decorate([\n                 type([ReflectionField], reflectionContext)\n             ], ReflectionType.prototype, \"fields\", void 0);\n             return ReflectionType;\n         }(Schema));\n         var Reflection = /** @class */ (function (_super) {\n             __extends(Reflection, _super);\n             function Reflection() {\n                 var _this = _super !== null && _super.apply(this, arguments) || this;\n                 _this.types = new ArraySchema();\n                 return _this;\n             }\n             Reflection.encode = function (instance) {\n                 var rootSchemaType = instance.constructor;\n                 var reflection = new Reflection();\n                 reflection.rootType = rootSchemaType._typeid;\n                 var buildType = function (currentType, schema) {\n                     for (var fieldName in schema) {\n                         var field = new ReflectionField();\n                         field.name = fieldName;\n                         var fieldType = void 0;\n                         if (typeof (schema[fieldName]) === \"string\") {\n                             fieldType = schema[fieldName];\n                         }\n                         else {\n                             var type_1 = schema[fieldName];\n                             var childTypeSchema = void 0;\n                             //\n                             // TODO: refactor below.\n                             //\n                             if (Schema.is(type_1)) {\n                                 fieldType = \"ref\";\n                                 childTypeSchema = schema[fieldName];\n                             }\n                             else {\n                                 fieldType = Object.keys(type_1)[0];\n                                 if (typeof (type_1[fieldType]) === \"string\") {\n                                     fieldType += \":\" + type_1[fieldType]; // array:string\n                                 }\n                                 else {\n                                     childTypeSchema = type_1[fieldType];\n                                 }\n                             }\n                             field.referencedType = (childTypeSchema)\n                                 ? childTypeSchema._typeid\n                                 : -1;\n                         }\n                         field.type = fieldType;\n                         currentType.fields.push(field);\n                     }\n                     reflection.types.push(currentType);\n                 };\n                 var types = rootSchemaType._context.types;\n                 for (var typeid in types) {\n                     var type_2 = new ReflectionType();\n                     type_2.id = Number(typeid);\n                     buildType(type_2, types[typeid]._definition.schema);\n                 }\n                 return reflection.encodeAll();\n             };\n             Reflection.decode = function (bytes, it) {\n                 var context = new Context();\n                 var reflection = new Reflection();\n                 reflection.decode(bytes, it);\n                 var schemaTypes = reflection.types.reduce(function (types, reflectionType) {\n                     var schema = /** @class */ (function (_super) {\n                         __extends(_, _super);\n                         function _() {\n                             return _super !== null && _super.apply(this, arguments) || this;\n                         }\n                         return _;\n                     }(Schema));\n                     var typeid = reflectionType.id;\n                     types[typeid] = schema;\n                     context.add(schema, typeid);\n                     return types;\n                 }, {});\n                 reflection.types.forEach(function (reflectionType) {\n                     var schemaType = schemaTypes[reflectionType.id];\n                     reflectionType.fields.forEach(function (field) {\n                         var _a;\n                         if (field.referencedType !== undefined) {\n                             var fieldType = field.type;\n                             var refType = schemaTypes[field.referencedType];\n                             // map or array of primitive type (-1)\n                             if (!refType) {\n                                 var typeInfo = field.type.split(\":\");\n                                 fieldType = typeInfo[0];\n                                 refType = typeInfo[1];\n                             }\n                             if (fieldType === \"ref\") {\n                                 type(refType, { context: context })(schemaType.prototype, field.name);\n                             }\n                             else {\n                                 type((_a = {}, _a[fieldType] = refType, _a), { context: context })(schemaType.prototype, field.name);\n                             }\n                         }\n                         else {\n                             type(field.type, { context: context })(schemaType.prototype, field.name);\n                         }\n                     });\n                 });\n                 var rootType = schemaTypes[reflection.rootType];\n                 var rootInstance = new rootType();\n                 /**\n                  * auto-initialize referenced types on root type\n                  * to allow registering listeners immediatelly on client-side\n                  */\n                 for (var fieldName in rootType._definition.schema) {\n                     var fieldType = rootType._definition.schema[fieldName];\n                     if (typeof (fieldType) !== \"string\") {\n                         rootInstance[fieldName] = (typeof (fieldType) === \"function\")\n                             ? new fieldType() // is a schema reference\n                             : new (getType(Object.keys(fieldType)[0])).constructor(); // is a \"collection\"\n                     }\n                 }\n                 return rootInstance;\n             };\n             __decorate([\n                 type([ReflectionType], reflectionContext)\n             ], Reflection.prototype, \"types\", void 0);\n             __decorate([\n                 type(\"number\", reflectionContext)\n             ], Reflection.prototype, \"rootType\", void 0);\n             return Reflection;\n         }(Schema));\n\n         registerType(\"map\", { constructor: MapSchema });\n         registerType(\"array\", { constructor: ArraySchema });\n         registerType(\"set\", { constructor: SetSchema });\n         registerType(\"collection\", { constructor: CollectionSchema, });\n\n         exports.ArraySchema = ArraySchema;\n         exports.CollectionSchema = CollectionSchema;\n         exports.Context = Context;\n         exports.MapSchema = MapSchema;\n         exports.Reflection = Reflection;\n         exports.ReflectionField = ReflectionField;\n         exports.ReflectionType = ReflectionType;\n         exports.Schema = Schema;\n         exports.SchemaDefinition = SchemaDefinition;\n         exports.SetSchema = SetSchema;\n         exports.decode = decode;\n         exports.defineTypes = defineTypes;\n         exports.deprecated = deprecated;\n         exports.dumpChanges = dumpChanges;\n         exports.encode = encode;\n         exports.filter = filter;\n         exports.filterChildren = filterChildren;\n         exports.hasFilter = hasFilter;\n         exports.registerType = registerType;\n         exports.type = type;\n\n         Object.defineProperty(exports, '__esModule', { value: true });\n\n     }));\n     });\n\n     var Room = /** @class */ (function () {\n         function Room(name, rootSchema) {\n             var _this = this;\n             // Public signals\n             this.onStateChange = createSignal();\n             this.onError = createSignal();\n             this.onLeave = createSignal();\n             this.onJoin = createSignal();\n             this.hasJoined = false;\n             this.onMessageHandlers = createNanoEvents();\n             this.roomId = null;\n             this.name = name;\n             if (rootSchema) {\n                 this.serializer = new (getSerializer(\"schema\"));\n                 this.rootSchema = rootSchema;\n                 this.serializer.state = new rootSchema();\n             }\n             this.onError(function (code, message) { return console.warn(\"colyseus.js - onError => (\".concat(code, \") \").concat(message)); });\n             this.onLeave(function () { return _this.removeAllListeners(); });\n         }\n         Object.defineProperty(Room.prototype, \"id\", {\n             // TODO: deprecate me on version 1.0\n             get: function () { return this.roomId; },\n             enumerable: false,\n             configurable: true\n         });\n         Room.prototype.connect = function (endpoint, devModeCloseCallback, room // when reconnecting on devMode, re-use previous room intance for handling events.\n         ) {\n             if (room === void 0) { room = this; }\n             var connection = new Connection();\n             room.connection = connection;\n             connection.events.onmessage = Room.prototype.onMessageCallback.bind(room);\n             connection.events.onclose = function (e) {\n                 if (!room.hasJoined) {\n                     console.warn(\"Room connection was closed unexpectedly (\".concat(e.code, \"): \").concat(e.reason));\n                     room.onError.invoke(e.code, e.reason);\n                     return;\n                 }\n                 if (e.code === CloseCode.DEVMODE_RESTART && devModeCloseCallback) {\n                     devModeCloseCallback();\n                 }\n                 else {\n                     room.onLeave.invoke(e.code);\n                     room.destroy();\n                 }\n             };\n             connection.events.onerror = function (e) {\n                 console.warn(\"Room, onError (\".concat(e.code, \"): \").concat(e.reason));\n                 room.onError.invoke(e.code, e.reason);\n             };\n             connection.connect(endpoint);\n         };\n         Room.prototype.leave = function (consented) {\n             var _this = this;\n             if (consented === void 0) { consented = true; }\n             return new Promise(function (resolve) {\n                 _this.onLeave(function (code) { return resolve(code); });\n                 if (_this.connection) {\n                     if (consented) {\n                         _this.connection.send([exports.Protocol.LEAVE_ROOM]);\n                     }\n                     else {\n                         _this.connection.close();\n                     }\n                 }\n                 else {\n                     _this.onLeave.invoke(CloseCode.CONSENTED);\n                 }\n             });\n         };\n         Room.prototype.onMessage = function (type, callback) {\n             return this.onMessageHandlers.on(this.getMessageHandlerKey(type), callback);\n         };\n         Room.prototype.send = function (type, message) {\n             var initialBytes = [exports.Protocol.ROOM_DATA];\n             if (typeof (type) === \"string\") {\n                 umd.encode.string(initialBytes, type);\n             }\n             else {\n                 umd.encode.number(initialBytes, type);\n             }\n             var arr;\n             if (message !== undefined) {\n                 var encoded = encode(message);\n                 arr = new Uint8Array(initialBytes.length + encoded.byteLength);\n                 arr.set(new Uint8Array(initialBytes), 0);\n                 arr.set(new Uint8Array(encoded), initialBytes.length);\n             }\n             else {\n                 arr = new Uint8Array(initialBytes);\n             }\n             this.connection.send(arr.buffer);\n         };\n         Room.prototype.sendBytes = function (type, bytes) {\n             var initialBytes = [exports.Protocol.ROOM_DATA_BYTES];\n             if (typeof (type) === \"string\") {\n                 umd.encode.string(initialBytes, type);\n             }\n             else {\n                 umd.encode.number(initialBytes, type);\n             }\n             var arr;\n             arr = new Uint8Array(initialBytes.length + (bytes.byteLength || bytes.length));\n             arr.set(new Uint8Array(initialBytes), 0);\n             arr.set(new Uint8Array(bytes), initialBytes.length);\n             this.connection.send(arr.buffer);\n         };\n         Object.defineProperty(Room.prototype, \"state\", {\n             get: function () {\n                 return this.serializer.getState();\n             },\n             enumerable: false,\n             configurable: true\n         });\n         Room.prototype.removeAllListeners = function () {\n             this.onJoin.clear();\n             this.onStateChange.clear();\n             this.onError.clear();\n             this.onLeave.clear();\n             this.onMessageHandlers.events = {};\n         };\n         Room.prototype.onMessageCallback = function (event) {\n             var bytes = Array.from(new Uint8Array(event.data));\n             var code = bytes[0];\n             if (code === exports.Protocol.JOIN_ROOM) {\n                 var offset = 1;\n                 var reconnectionToken = utf8Read(bytes, offset);\n                 offset += utf8Length(reconnectionToken);\n                 this.serializerId = utf8Read(bytes, offset);\n                 offset += utf8Length(this.serializerId);\n                 // Instantiate serializer if not locally available.\n                 if (!this.serializer) {\n                     var serializer = getSerializer(this.serializerId);\n                     this.serializer = new serializer();\n                 }\n                 if (bytes.length > offset && this.serializer.handshake) {\n                     this.serializer.handshake(bytes, { offset: offset });\n                 }\n                 this.reconnectionToken = \"\".concat(this.roomId, \":\").concat(reconnectionToken);\n                 this.hasJoined = true;\n                 this.onJoin.invoke();\n                 // acknowledge successfull JOIN_ROOM\n                 this.connection.send([exports.Protocol.JOIN_ROOM]);\n             }\n             else if (code === exports.Protocol.ERROR) {\n                 var it_1 = { offset: 1 };\n                 var code_1 = umd.decode.number(bytes, it_1);\n                 var message = umd.decode.string(bytes, it_1);\n                 this.onError.invoke(code_1, message);\n             }\n             else if (code === exports.Protocol.LEAVE_ROOM) {\n                 this.leave();\n             }\n             else if (code === exports.Protocol.ROOM_DATA_SCHEMA) {\n                 var it_2 = { offset: 1 };\n                 var context_1 = this.serializer.getState().constructor._context;\n                 var type = context_1.get(umd.decode.number(bytes, it_2));\n                 var message = new type();\n                 message.decode(bytes, it_2);\n                 this.dispatchMessage(type, message);\n             }\n             else if (code === exports.Protocol.ROOM_STATE) {\n                 bytes.shift(); // drop `code` byte\n                 this.setState(bytes);\n             }\n             else if (code === exports.Protocol.ROOM_STATE_PATCH) {\n                 bytes.shift(); // drop `code` byte\n                 this.patch(bytes);\n             }\n             else if (code === exports.Protocol.ROOM_DATA) {\n                 var it_3 = { offset: 1 };\n                 var type = (umd.decode.stringCheck(bytes, it_3))\n                     ? umd.decode.string(bytes, it_3)\n                     : umd.decode.number(bytes, it_3);\n                 var message = (bytes.length > it_3.offset)\n                     ? decode(event.data, it_3.offset)\n                     : undefined;\n                 this.dispatchMessage(type, message);\n             }\n             else if (code === exports.Protocol.ROOM_DATA_BYTES) {\n                 var it_4 = { offset: 1 };\n                 var type = (umd.decode.stringCheck(bytes, it_4))\n                     ? umd.decode.string(bytes, it_4)\n                     : umd.decode.number(bytes, it_4);\n                 this.dispatchMessage(type, new Uint8Array(bytes.slice(it_4.offset)));\n             }\n         };\n         Room.prototype.setState = function (encodedState) {\n             this.serializer.setState(encodedState);\n             this.onStateChange.invoke(this.serializer.getState());\n         };\n         Room.prototype.patch = function (binaryPatch) {\n             this.serializer.patch(binaryPatch);\n             this.onStateChange.invoke(this.serializer.getState());\n         };\n         Room.prototype.dispatchMessage = function (type, message) {\n             var messageType = this.getMessageHandlerKey(type);\n             if (this.onMessageHandlers.events[messageType]) {\n                 this.onMessageHandlers.emit(messageType, message);\n             }\n             else if (this.onMessageHandlers.events['*']) {\n                 this.onMessageHandlers.emit('*', type, message);\n             }\n             else {\n                 console.warn(\"colyseus.js: onMessage() not registered for type '\".concat(type, \"'.\"));\n             }\n         };\n         Room.prototype.destroy = function () {\n             if (this.serializer) {\n                 this.serializer.teardown();\n             }\n         };\n         Room.prototype.getMessageHandlerKey = function (type) {\n             switch (typeof (type)) {\n                 // typeof Schema\n                 case \"function\": return \"$\".concat(type._typeid);\n                 // string\n                 case \"string\": return type;\n                 // number\n                 case \"number\": return \"i\".concat(type);\n                 default: throw new Error(\"invalid message type.\");\n             }\n         };\n         return Room;\n     }());\n\n     var _a;\n     var MatchMakeError = /** @class */ (function (_super) {\n         __extends(MatchMakeError, _super);\n         function MatchMakeError(message, code) {\n             var _this = _super.call(this, message) || this;\n             _this.code = code;\n             Object.setPrototypeOf(_this, MatchMakeError.prototype);\n             return _this;\n         }\n         return MatchMakeError;\n     }(Error));\n     // - React Native does not provide `window.location`\n     // - Cocos Creator (Native) does not provide `window.location.hostname`\n     var DEFAULT_ENDPOINT = (typeof (window) !== \"undefined\" && typeof ((_a = window === null || window === void 0 ? void 0 : window.location) === null || _a === void 0 ? void 0 : _a.hostname) !== \"undefined\")\n         ? \"\".concat(window.location.protocol.replace(\"http\", \"ws\"), \"//\").concat(window.location.hostname).concat((window.location.port && \":\".concat(window.location.port)))\n         : \"ws://127.0.0.1:2567\";\n     var Client = /** @class */ (function () {\n         function Client(settings) {\n             if (settings === void 0) { settings = DEFAULT_ENDPOINT; }\n             if (typeof (settings) === \"string\") {\n                 var url = new URL(settings);\n                 var useSSL = (url.protocol === \"https:\" || url.protocol === \"wss:\");\n                 var port = Number(url.port || (useSSL ? 443 : 80));\n                 this.settings = {\n                     hostname: url.hostname,\n                     port: port,\n                     useSSL: useSSL\n                 };\n             }\n             else {\n                 this.settings = settings;\n             }\n         }\n         Client.prototype.joinOrCreate = function (roomName, options, rootSchema) {\n             if (options === void 0) { options = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinOrCreate', roomName, options, rootSchema)];\n                         case 1: return [2 /*return*/, _a.sent()];\n                     }\n                 });\n             });\n         };\n         Client.prototype.create = function (roomName, options, rootSchema) {\n             if (options === void 0) { options = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.createMatchMakeRequest('create', roomName, options, rootSchema)];\n                         case 1: return [2 /*return*/, _a.sent()];\n                     }\n                 });\n             });\n         };\n         Client.prototype.join = function (roomName, options, rootSchema) {\n             if (options === void 0) { options = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.createMatchMakeRequest('join', roomName, options, rootSchema)];\n                         case 1: return [2 /*return*/, _a.sent()];\n                     }\n                 });\n             });\n         };\n         Client.prototype.joinById = function (roomId, options, rootSchema) {\n             if (options === void 0) { options = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinById', roomId, options, rootSchema)];\n                         case 1: return [2 /*return*/, _a.sent()];\n                     }\n                 });\n             });\n         };\n         /**\n          * Re-establish connection with a room this client was previously connected to.\n          *\n          * @param reconnectionToken The `room.reconnectionToken` from previously connected room.\n          * @param rootSchema (optional) Concrete root schema definition\n          * @returns Promise<Room>\n          */\n         Client.prototype.reconnect = function (reconnectionToken, rootSchema) {\n             return __awaiter(this, void 0, void 0, function () {\n                 var _a, roomId, token;\n                 return __generator(this, function (_b) {\n                     switch (_b.label) {\n                         case 0:\n                             if (typeof (reconnectionToken) === \"string\" && typeof (rootSchema) === \"string\") {\n                                 throw new Error(\"DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\\nYou can get this token from previously connected `room.reconnectionToken`\");\n                             }\n                             _a = reconnectionToken.split(\":\"), roomId = _a[0], token = _a[1];\n                             return [4 /*yield*/, this.createMatchMakeRequest('reconnect', roomId, { reconnectionToken: token }, rootSchema)];\n                         case 1: return [2 /*return*/, _b.sent()];\n                     }\n                 });\n             });\n         };\n         Client.prototype.getAvailableRooms = function (roomName) {\n             if (roomName === void 0) { roomName = \"\"; }\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, get_1(this.getHttpEndpoint(\"\".concat(roomName)), {\n                                 headers: {\n                                     'Accept': 'application/json'\n                                 }\n                             })];\n                         case 1: return [2 /*return*/, (_a.sent()).data];\n                     }\n                 });\n             });\n         };\n         Client.prototype.consumeSeatReservation = function (response, rootSchema, previousRoom // used in devMode\n         ) {\n             return __awaiter(this, void 0, void 0, function () {\n                 var room, options, targetRoom;\n                 var _this = this;\n                 return __generator(this, function (_a) {\n                     room = this.createRoom(response.room.name, rootSchema);\n                     room.roomId = response.room.roomId;\n                     room.sessionId = response.sessionId;\n                     options = { sessionId: room.sessionId };\n                     // forward \"reconnection token\" in case of reconnection.\n                     if (response.reconnectionToken) {\n                         options.reconnectionToken = response.reconnectionToken;\n                     }\n                     targetRoom = previousRoom || room;\n                     room.connect(this.buildEndpoint(response.room, options), response.devMode && (function () { return __awaiter(_this, void 0, void 0, function () {\n                         var retryCount, retryMaxRetries, retryReconnection;\n                         var _this = this;\n                         return __generator(this, function (_a) {\n                             console.info(\"[Colyseus devMode]: \".concat(String.fromCodePoint(0x1F504), \" Re-establishing connection with room id '\").concat(room.roomId, \"'...\")); // 🔄\n                             retryCount = 0;\n                             retryMaxRetries = 8;\n                             retryReconnection = function () { return __awaiter(_this, void 0, void 0, function () {\n                                 return __generator(this, function (_a) {\n                                     switch (_a.label) {\n                                         case 0:\n                                             retryCount++;\n                                             _a.label = 1;\n                                         case 1:\n                                             _a.trys.push([1, 3, , 4]);\n                                             return [4 /*yield*/, this.consumeSeatReservation(response, rootSchema, targetRoom)];\n                                         case 2:\n                                             _a.sent();\n                                             console.info(\"[Colyseus devMode]: \".concat(String.fromCodePoint(0x2705), \" Successfully re-established connection with room '\").concat(room.roomId, \"'\")); // ✅\n                                             return [3 /*break*/, 4];\n                                         case 3:\n                                             _a.sent();\n                                             if (retryCount < retryMaxRetries) {\n                                                 console.info(\"[Colyseus devMode]: \".concat(String.fromCodePoint(0x1F504), \" retrying... (\").concat(retryCount, \" out of \").concat(retryMaxRetries, \")\")); // 🔄\n                                                 setTimeout(retryReconnection, 2000);\n                                             }\n                                             else {\n                                                 console.info(\"[Colyseus devMode]: \".concat(String.fromCodePoint(0x274C), \" Failed to reconnect. Is your server running? Please check server logs.\")); // ❌\n                                             }\n                                             return [3 /*break*/, 4];\n                                         case 4: return [2 /*return*/];\n                                     }\n                                 });\n                             }); };\n                             setTimeout(retryReconnection, 2000);\n                             return [2 /*return*/];\n                         });\n                     }); }), targetRoom);\n                     return [2 /*return*/, new Promise(function (resolve, reject) {\n                             var onError = function (code, message) { return reject(new ServerError(code, message)); };\n                             targetRoom.onError.once(onError);\n                             targetRoom['onJoin'].once(function () {\n                                 targetRoom.onError.remove(onError);\n                                 resolve(targetRoom);\n                             });\n                         })];\n                 });\n             });\n         };\n         Client.prototype.createMatchMakeRequest = function (method, roomName, options, rootSchema) {\n             if (options === void 0) { options = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 var response;\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, post_1(this.getHttpEndpoint(\"\".concat(method, \"/\").concat(roomName)), {\n                                 headers: {\n                                     'Accept': 'application/json',\n                                     'Content-Type': 'application/json'\n                                 },\n                                 body: JSON.stringify(options)\n                             })];\n                         case 1:\n                             response = (_a.sent()).data;\n                             if (response.error) {\n                                 throw new MatchMakeError(response.error, response.code);\n                             }\n                             // forward reconnection token during \"reconnect\" methods.\n                             if (method === \"reconnect\") {\n                                 response.reconnectionToken = options.reconnectionToken;\n                             }\n                             return [4 /*yield*/, this.consumeSeatReservation(response, rootSchema)];\n                         case 2: return [2 /*return*/, _a.sent()];\n                     }\n                 });\n             });\n         };\n         Client.prototype.createRoom = function (roomName, rootSchema) {\n             return new Room(roomName, rootSchema);\n         };\n         Client.prototype.buildEndpoint = function (room, options) {\n             if (options === void 0) { options = {}; }\n             var params = [];\n             for (var name_1 in options) {\n                 if (!options.hasOwnProperty(name_1)) {\n                     continue;\n                 }\n                 params.push(\"\".concat(name_1, \"=\").concat(options[name_1]));\n             }\n             var endpoint = (this.settings.useSSL)\n                 ? \"wss://\"\n                 : \"ws://\";\n             if (room.publicAddress) {\n                 endpoint += \"\".concat(room.publicAddress);\n             }\n             else {\n                 endpoint += \"\".concat(this.settings.hostname).concat(this.getEndpointPort());\n             }\n             return \"\".concat(endpoint, \"/\").concat(room.processId, \"/\").concat(room.roomId, \"?\").concat(params.join('&'));\n         };\n         Client.prototype.getHttpEndpoint = function (segments) {\n             return \"\".concat((this.settings.useSSL) ? \"https\" : \"http\", \"://\").concat(this.settings.hostname).concat(this.getEndpointPort(), \"/matchmake/\").concat(segments);\n         };\n         Client.prototype.getEndpointPort = function () {\n             return (this.settings.port !== 80 && this.settings.port !== 443)\n                 ? \":\".concat(this.settings.port)\n                 : \"\";\n         };\n         return Client;\n     }());\n\n     /// <reference path=\"../typings/cocos-creator.d.ts\" />\n     /**\n      * We do not assign 'storage' to window.localStorage immediatelly for React\n      * Native compatibility. window.localStorage is not present when this module is\n      * loaded.\n      */\n     var storage;\n     function getStorage() {\n         if (!storage) {\n             storage = (typeof (cc) !== 'undefined' && cc.sys && cc.sys.localStorage)\n                 ? cc.sys.localStorage // compatibility with cocos creator\n                 : typeof (window) !== \"undefined\" && window.localStorage //RN does have window object at this point, but localStorage is not defined\n                     ? window.localStorage // regular browser environment\n                     : {\n                         cache: {},\n                         setItem: function (key, value) { this.cache[key] = value; },\n                         getItem: function (key) { this.cache[key]; },\n                         removeItem: function (key) { delete this.cache[key]; },\n                     };\n         }\n         return storage;\n     }\n     function setItem(key, value) {\n         getStorage().setItem(key, value);\n     }\n     function removeItem(key) {\n         getStorage().removeItem(key);\n     }\n     function getItem(key, callback) {\n         var value = getStorage().getItem(key);\n         if (typeof (Promise) === 'undefined' || // old browsers\n             !(value instanceof Promise)) {\n             // browser has synchronous return\n             callback(value);\n         }\n         else {\n             // react-native is asynchronous\n             value.then(function (id) { return callback(id); });\n         }\n     }\n\n     var TOKEN_STORAGE = \"colyseus-auth-token\";\n     exports.Platform = void 0;\n     (function (Platform) {\n         Platform[\"ios\"] = \"ios\";\n         Platform[\"android\"] = \"android\";\n     })(exports.Platform || (exports.Platform = {}));\n     var Auth = /** @class */ (function () {\n         function Auth(endpoint) {\n             var _this = this;\n             this._id = undefined;\n             this.username = undefined;\n             this.displayName = undefined;\n             this.avatarUrl = undefined;\n             this.isAnonymous = undefined;\n             this.email = undefined;\n             this.lang = undefined;\n             this.location = undefined;\n             this.timezone = undefined;\n             this.metadata = undefined;\n             this.devices = undefined;\n             this.facebookId = undefined;\n             this.twitterId = undefined;\n             this.googleId = undefined;\n             this.gameCenterId = undefined;\n             this.steamId = undefined;\n             this.friendIds = undefined;\n             this.blockedUserIds = undefined;\n             this.createdAt = undefined;\n             this.updatedAt = undefined;\n             // auth token\n             this.token = undefined;\n             this.endpoint = endpoint.replace(\"ws\", \"http\");\n             getItem(TOKEN_STORAGE, function (token) { return _this.token = token; });\n         }\n         Object.defineProperty(Auth.prototype, \"hasToken\", {\n             get: function () {\n                 return !!this.token;\n             },\n             enumerable: false,\n             configurable: true\n         });\n         Auth.prototype.login = function (options) {\n             if (options === void 0) { options = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 var queryParams, data, attr;\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0:\n                             queryParams = Object.assign({}, options);\n                             if (this.hasToken) {\n                                 queryParams.token = this.token;\n                             }\n                             return [4 /*yield*/, this.request('post', '/auth', queryParams)];\n                         case 1:\n                             data = _a.sent();\n                             // set & cache token\n                             this.token = data.token;\n                             setItem(TOKEN_STORAGE, this.token);\n                             for (attr in data) {\n                                 if (this.hasOwnProperty(attr)) {\n                                     this[attr] = data[attr];\n                                 }\n                             }\n                             this.registerPingService();\n                             return [2 /*return*/, this];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.save = function () {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('put', '/auth', {}, {\n                                 username: this.username,\n                                 displayName: this.displayName,\n                                 avatarUrl: this.avatarUrl,\n                                 lang: this.lang,\n                                 location: this.location,\n                                 timezone: this.timezone,\n                             })];\n                         case 1:\n                             _a.sent();\n                             return [2 /*return*/, this];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.getFriends = function () {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('get', '/friends/all')];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.getOnlineFriends = function () {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('get', '/friends/online')];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.getFriendRequests = function () {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('get', '/friends/requests')];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.sendFriendRequest = function (friendId) {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('post', '/friends/requests', { userId: friendId })];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.acceptFriendRequest = function (friendId) {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('put', '/friends/requests', { userId: friendId })];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.declineFriendRequest = function (friendId) {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('del', '/friends/requests', { userId: friendId })];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.blockUser = function (friendId) {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('post', '/friends/block', { userId: friendId })];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.unblockUser = function (friendId) {\n             return __awaiter(this, void 0, void 0, function () {\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0: return [4 /*yield*/, this.request('put', '/friends/block', { userId: friendId })];\n                         case 1: return [2 /*return*/, (_a.sent())];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.request = function (method, segments, query, body, headers) {\n             if (query === void 0) { query = {}; }\n             if (headers === void 0) { headers = {}; }\n             return __awaiter(this, void 0, void 0, function () {\n                 var queryParams, name_1, queryString, opts;\n                 return __generator(this, function (_a) {\n                     switch (_a.label) {\n                         case 0:\n                             headers['Accept'] = 'application/json';\n                             if (this.hasToken) {\n                                 headers['Authorization'] = 'Bearer ' + this.token;\n                             }\n                             queryParams = [];\n                             for (name_1 in query) {\n                                 queryParams.push(\"\".concat(name_1, \"=\").concat(query[name_1]));\n                             }\n                             queryString = (queryParams.length > 0)\n                                 ? \"?\".concat(queryParams.join(\"&\"))\n                                 : '';\n                             opts = { headers: headers };\n                             if (body) {\n                                 opts.body = body;\n                             }\n                             return [4 /*yield*/, http[method](\"\".concat(this.endpoint).concat(segments).concat(queryString), opts)];\n                         case 1: return [2 /*return*/, (_a.sent()).data];\n                     }\n                 });\n             });\n         };\n         Auth.prototype.logout = function () {\n             this.token = undefined;\n             removeItem(TOKEN_STORAGE);\n             this.unregisterPingService();\n         };\n         Auth.prototype.registerPingService = function (timeout) {\n             var _this = this;\n             if (timeout === void 0) { timeout = 15000; }\n             this.unregisterPingService();\n             this.keepOnlineInterval = setInterval(function () { return _this.request('get', '/auth'); }, timeout);\n         };\n         Auth.prototype.unregisterPingService = function () {\n             clearInterval(this.keepOnlineInterval);\n         };\n         return Auth;\n     }());\n\n     var SchemaSerializer = /** @class */ (function () {\n         function SchemaSerializer() {\n         }\n         SchemaSerializer.prototype.setState = function (rawState) {\n             return this.state.decode(rawState);\n         };\n         SchemaSerializer.prototype.getState = function () {\n             return this.state;\n         };\n         SchemaSerializer.prototype.patch = function (patches) {\n             return this.state.decode(patches);\n         };\n         SchemaSerializer.prototype.teardown = function () {\n             var _a, _b;\n             (_b = (_a = this.state) === null || _a === void 0 ? void 0 : _a['$changes']) === null || _b === void 0 ? void 0 : _b.root.clearRefs();\n         };\n         SchemaSerializer.prototype.handshake = function (bytes, it) {\n             if (this.state) {\n                 // TODO: validate client/server definitinos\n                 var reflection = new umd.Reflection();\n                 reflection.decode(bytes, it);\n             }\n             else {\n                 // initialize reflected state from server\n                 this.state = umd.Reflection.decode(bytes, it);\n             }\n         };\n         return SchemaSerializer;\n     }());\n\n     var NoneSerializer = /** @class */ (function () {\n         function NoneSerializer() {\n         }\n         NoneSerializer.prototype.setState = function (rawState) { };\n         NoneSerializer.prototype.getState = function () { return null; };\n         NoneSerializer.prototype.patch = function (patches) { };\n         NoneSerializer.prototype.teardown = function () { };\n         NoneSerializer.prototype.handshake = function (bytes) { };\n         return NoneSerializer;\n     }());\n\n     registerSerializer('schema', SchemaSerializer);\n     registerSerializer('none', NoneSerializer);\n\n     exports.Auth = Auth;\n     exports.Client = Client;\n     exports.Room = Room;\n     exports.SchemaSerializer = SchemaSerializer;\n     exports.registerSerializer = registerSerializer;\n\n     Object.defineProperty(exports, '__esModule', { value: true });\n\n }));\n //# sourceMappingURL=colyseus.js.map\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n_Protocol = module.exports.Protocol;\n_ErrorCode = module.exports.ErrorCode;\n_OPERATION = module.exports.OPERATION;\n_ArraySchema = module.exports.ArraySchema;\n_CollectionSchema = module.exports.CollectionSchema;\n_Context = module.exports.Context;\n_MapSchema = module.exports.MapSchema;\n_Reflection = module.exports.Reflection;\n_ReflectionField = module.exports.ReflectionField;\n_ReflectionType = module.exports.ReflectionType;\n_Schema = module.exports.Schema;\n_SchemaDefinition = module.exports.SchemaDefinition;\n_SetSchema = module.exports.SetSchema;\n_decode = module.exports.decode;\n_defineTypes = module.exports.defineTypes;\n_deprecated = module.exports.deprecated;\n_dumpChanges = module.exports.dumpChanges;\n_encode0 = module.exports.encode;\n_filter = module.exports.filter;\n_filterChildren = module.exports.filterChildren;\n_hasFilter = module.exports.hasFilter;\n_registerType = module.exports.registerType;\n_type = module.exports.type;\n___esModule = module.exports.__esModule;\n_Platform = module.exports.Platform;\n_Auth = module.exports.Auth;\n_Client = module.exports.Client;\n_Room = module.exports.Room;\n_SchemaSerializer = module.exports.SchemaSerializer;\n_registerSerializer = module.exports.registerSerializer;\n\n}, {});\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}