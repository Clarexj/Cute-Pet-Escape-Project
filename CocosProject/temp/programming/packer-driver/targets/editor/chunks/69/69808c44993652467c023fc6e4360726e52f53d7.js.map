{"version":3,"sources":["file:///Users/clare/Desktop/%E5%89%8D%E5%93%A8AI%E5%B0%8F%E8%AF%BE/ClareProject/Cute-Pet-Escape-Project/CocosProject/assets/scripts/Ore.ts"],"names":["_decorator","tween","Vec3","Interactable","GameManager","ccclass","property","Ore","_isCollecting","start","interactPrompt","canInteractMultipleTimes","canInteract","onInteract","player","console","log","collect","gameManager","getInstance","onOreCollected","node","initialPosition","position","clone","initialScale","scale","targetPosition","x","y","floatUpDistance","z","enlargeScale","collectScaleUp","to","collectDuration","easing","ZERO","call","destroy","isCollecting"],"mappings":"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","sourcesContent":["// 文件名: Ore.ts\n// 功能：矿石交互（拾取后消失）\n// 版本：V1.1 - 新增GameManager统计通知（任务2.2）\n\nimport { _decorator, Component, Node, tween, Vec3 } from 'cc';\nimport { Interactable } from './Interactable';\nimport { GameManager } from './GameManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('Ore')\nexport class Ore extends Interactable {\n    @property\n    public collectDuration: number = 0.3; // 拾取动画时长（秒）\n\n    @property\n    public collectScaleUp: number = 1.5; // 拾取时放大倍数\n\n    @property\n    public floatUpDistance: number = 1.0; // 向上漂浮距离\n\n    private _isCollecting: boolean = false; // 是否正在拾取中\n\n    start() {\n        // 设置交互提示\n        this.interactPrompt = \"拾取矿石\";\n        this.canInteractMultipleTimes = false; // 只能拾取一次\n    }\n\n    /**\n     * 检查是否可以交互\n     */\n    public canInteract(): boolean {\n        // 如果正在拾取中，不能再次交互\n        return !this._isCollecting && super.canInteract();\n    }\n\n    /**\n     * 执行交互：拾取矿石\n     */\n    protected onInteract(player: Node): void {\n        if (this._isCollecting) {\n            return;\n        }\n\n        console.log('[Ore] 矿石被拾取！');\n        this.collect();\n    }\n\n    /**\n     * 拾取动画\n     */\n    private collect() {\n        this._isCollecting = true;\n\n        // 通知GameManager\n        const gameManager = GameManager.getInstance();\n        if (gameManager) {\n            gameManager.onOreCollected(this.node);\n        }\n\n        // 保存初始位置和缩放\n        const initialPosition = this.node.position.clone();\n        const initialScale = this.node.scale.clone();\n\n        // 目标位置（向上漂浮）\n        const targetPosition = new Vec3(\n            initialPosition.x,\n            initialPosition.y + this.floatUpDistance,\n            initialPosition.z\n        );\n\n        // 目标缩放（放大后缩小到0）\n        const enlargeScale = new Vec3(\n            initialScale.x * this.collectScaleUp,\n            initialScale.y * this.collectScaleUp,\n            initialScale.z * this.collectScaleUp\n        );\n\n        // 使用tween实现拾取动画\n        tween(this.node)\n            // 第一阶段：放大 + 向上漂浮（前60%时间）\n            .to(this.collectDuration * 0.6, {\n                position: targetPosition,\n                scale: enlargeScale\n            }, {\n                easing: 'quadOut'\n            })\n            // 第二阶段：缩小到0（后40%时间）\n            .to(this.collectDuration * 0.4, {\n                scale: Vec3.ZERO\n            }, {\n                easing: 'quadIn'\n            })\n            // 动画完成后销毁节点\n            .call(() => {\n                console.log('[Ore] 矿石拾取完成，节点销毁');\n                this.node.destroy();\n            })\n            .start();\n    }\n\n    /**\n     * 获取是否正在拾取中\n     */\n    public isCollecting(): boolean {\n        return this._isCollecting;\n    }\n}\n"]}