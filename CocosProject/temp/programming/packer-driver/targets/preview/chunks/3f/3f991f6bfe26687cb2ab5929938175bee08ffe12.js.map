{"version":3,"sources":["file:///Users/clare/Desktop/%E5%89%8D%E5%93%A8AI%E5%B0%8F%E8%AF%BE/ClareProject/Cute-Pet-Escape-Project/CocosProject/assets/scripts/HunterUI.ts"],"names":["_decorator","Component","Node","Button","Label","HunterController","ccclass","property","HunterUI","start","hunterController","console","error","hideAttackButton","hideBreakBoardButton","onAttackTargetChange","target","onBoardTargetChange","board","attackButton","button","getComponent","node","on","EventType","CLICK","onAttackButtonClick","breakBoardButton","onBreakBoardButtonClick","log","update","deltaTime","active","showCooldownProgress","updateAttackCooldown","showAttackButton","name","targetName","attackLabel","string","canAttack","progress","getAttackCooldownProgress","percentage","Math","floor","interactable","getAttackTarget","triggerAttack","showBreakBoardButton","breakBoardLabel","triggerBreakBoard","debugShowAttackButton","debugHideAttackButton"],"mappings":"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","sourcesContent":["// 文件名: HunterUI.ts\n// 功能：追捕者UI - 攻击按钮、踩碎木板按钮（任务2.2）\n\nimport { _decorator, Component, Node, Button, Label } from 'cc';\nimport { HunterController } from './HunterController';\nimport { Board } from './Board';\nconst { ccclass, property } = _decorator;\n\n@ccclass('HunterUI')\nexport class HunterUI extends Component {\n    @property(Node)\n    public attackButton: Node = null!; // 攻击按钮节点\n\n    @property(Label)\n    public attackLabel: Label = null!; // 攻击按钮文字\n\n    @property(Node)\n    public breakBoardButton: Node = null!; // 踩碎木板按钮节点\n\n    @property(Label)\n    public breakBoardLabel: Label = null!; // 踩碎木板按钮文字\n\n    @property(HunterController)\n    public hunterController: HunterController = null!; // 追捕者控制器\n\n    @property\n    public showCooldownProgress: boolean = true; // 是否显示冷却进度\n\n    start() {\n        if (!this.hunterController) {\n            console.error('[HunterUI] HunterController未绑定！');\n            return;\n        }\n\n        // 初始化按钮状态\n        this.hideAttackButton();\n        this.hideBreakBoardButton();\n\n        // 注册回调\n        this.hunterController.onAttackTargetChange((target) => {\n            this.onAttackTargetChange(target);\n        });\n\n        this.hunterController.onBoardTargetChange((board) => {\n            this.onBoardTargetChange(board);\n        });\n\n        // 绑定按钮点击事件\n        if (this.attackButton) {\n            const button = this.attackButton.getComponent(Button);\n            if (button) {\n                button.node.on(Button.EventType.CLICK, this.onAttackButtonClick, this);\n            }\n        }\n\n        if (this.breakBoardButton) {\n            const button = this.breakBoardButton.getComponent(Button);\n            if (button) {\n                button.node.on(Button.EventType.CLICK, this.onBreakBoardButtonClick, this);\n            }\n        }\n\n        console.log('[HunterUI] 追捕者UI初始化完成');\n    }\n\n    update(deltaTime: number) {\n        // 更新攻击按钮冷却显示\n        if (this.attackButton && this.attackButton.active && this.showCooldownProgress) {\n            this.updateAttackCooldown();\n        }\n    }\n\n    // ============ 攻击按钮 ============\n\n    /**\n     * 攻击目标变化\n     */\n    private onAttackTargetChange(target: Node | null) {\n        if (target) {\n            this.showAttackButton(target.name);\n        } else {\n            this.hideAttackButton();\n        }\n    }\n\n    /**\n     * 显示攻击按钮\n     */\n    private showAttackButton(targetName: string) {\n        if (!this.attackButton) return;\n\n        this.attackButton.active = true;\n\n        if (this.attackLabel) {\n            this.attackLabel.string = `攻击 ${targetName}`;\n        }\n    }\n\n    /**\n     * 隐藏攻击按钮\n     */\n    private hideAttackButton() {\n        if (this.attackButton) {\n            this.attackButton.active = false;\n        }\n    }\n\n    /**\n     * 更新攻击冷却显示\n     */\n    private updateAttackCooldown() {\n        if (!this.hunterController || !this.attackLabel) return;\n\n        const canAttack = this.hunterController.canAttack();\n        const progress = this.hunterController.getAttackCooldownProgress();\n\n        if (!canAttack) {\n            // 显示冷却进度\n            const percentage = Math.floor(progress * 100);\n            this.attackLabel.string = `冷却中 ${percentage}%`;\n\n            // 可选：改变按钮颜色\n            const button = this.attackButton?.getComponent(Button);\n            if (button) {\n                button.interactable = false;\n            }\n        } else {\n            // 恢复正常显示\n            const target = this.hunterController.getAttackTarget();\n            if (target) {\n                this.attackLabel.string = `攻击 ${target.name}`;\n            }\n\n            const button = this.attackButton?.getComponent(Button);\n            if (button) {\n                button.interactable = true;\n            }\n        }\n    }\n\n    /**\n     * 攻击按钮点击\n     */\n    private onAttackButtonClick() {\n        if (!this.hunterController) return;\n\n        console.log('[HunterUI] 点击攻击按钮');\n        this.hunterController.triggerAttack();\n    }\n\n    // ============ 踩碎木板按钮 ============\n\n    /**\n     * 木板目标变化\n     */\n    private onBoardTargetChange(board: Board | null) {\n        if (board) {\n            this.showBreakBoardButton();\n        } else {\n            this.hideBreakBoardButton();\n        }\n    }\n\n    /**\n     * 显示踩碎木板按钮\n     */\n    private showBreakBoardButton() {\n        if (!this.breakBoardButton) return;\n\n        this.breakBoardButton.active = true;\n\n        if (this.breakBoardLabel) {\n            this.breakBoardLabel.string = \"踩碎木板\";\n        }\n    }\n\n    /**\n     * 隐藏踩碎木板按钮\n     */\n    private hideBreakBoardButton() {\n        if (this.breakBoardButton) {\n            this.breakBoardButton.active = false;\n        }\n    }\n\n    /**\n     * 踩碎木板按钮点击\n     */\n    private onBreakBoardButtonClick() {\n        if (!this.hunterController) return;\n\n        console.log('[HunterUI] 点击踩碎木板按钮');\n        this.hunterController.triggerBreakBoard();\n    }\n\n    // ============ 手动控制接口 ============\n\n    /**\n     * 手动显示攻击按钮（用于调试）\n     */\n    public debugShowAttackButton() {\n        this.showAttackButton('测试目标');\n    }\n\n    /**\n     * 手动隐藏攻击按钮（用于调试）\n     */\n    public debugHideAttackButton() {\n        this.hideAttackButton();\n    }\n}\n"]}