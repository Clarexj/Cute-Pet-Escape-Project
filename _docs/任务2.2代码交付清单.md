# ä»»åŠ¡2.2ä»£ç äº¤ä»˜æ¸…å•

## ğŸ“¦ äº¤ä»˜æ¦‚è§ˆ

**ä»»åŠ¡åç§°ï¼š** å®ç°è¿½æ•è€…åŸºç¡€ç©æ³•ä¸å®Œæ•´æ¸¸æˆèƒœè´Ÿæµç¨‹
**äº¤ä»˜æ—¥æœŸï¼š** 2025å¹´
**å¼€å‘è€…ï¼š** Claude Code

---

## ğŸ“„ æ–°å¢æ–‡ä»¶æ¸…å•

### 1. HunterController.ts
**è·¯å¾„ï¼š** `assets/scripts/HunterController.ts`
**åŠŸèƒ½ï¼š** è¿½æ•è€…å¯æ§ç§»åŠ¨ + æ”»å‡» + è¸©ç¢æœ¨æ¿
**ä»£ç è¡Œæ•°ï¼š** ~370è¡Œ

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… è™šæ‹Ÿæ‘‡æ†æ§åˆ¶ç§»åŠ¨ï¼ˆå¤ç”¨PlayerControlleré€»è¾‘ï¼‰
- âœ… ç§»åŠ¨é€Ÿåº¦115%ï¼ˆ5.75 m/sï¼‰
- âœ… æ”»å‡»æŒ‰é’®ï¼ˆ2ç±³èŒƒå›´ï¼Œ1ç§’å†·å´ï¼‰
- âœ… è¸©ç¢æœ¨æ¿ï¼ˆ2.5ç±³èŒƒå›´ï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹é™„è¿‘é€ƒç”Ÿè€…å’Œæœ¨æ¿
- âœ… å›è°ƒç³»ç»Ÿï¼ˆç›®æ ‡å˜åŒ–é€šçŸ¥ï¼‰

**ä¾èµ–å…³ç³»ï¼š**
```
HunterController â†’ Hunterï¼ˆè°ƒç”¨catchSurvivorï¼‰
HunterController â†’ Boardï¼ˆè°ƒç”¨breakBoardï¼‰
HunterController â†’ Joystickï¼ˆè¯»å–è¾“å…¥ï¼‰
```

**å…³é”®æ¥å£ï¼š**
```typescript
triggerAttack(): void              // è§¦å‘æ”»å‡»
triggerBreakBoard(): void          // è¸©ç¢æœ¨æ¿
getAttackTarget(): Node | null     // è·å–æ”»å‡»ç›®æ ‡
canAttack(): boolean               // æ˜¯å¦å¯ä»¥æ”»å‡»
getAttackCooldownProgress(): number // è·å–å†·å´è¿›åº¦
onAttackTargetChange(callback)     // æ³¨å†Œæ”»å‡»ç›®æ ‡å˜åŒ–å›è°ƒ
onBoardTargetChange(callback)      // æ³¨å†Œæœ¨æ¿ç›®æ ‡å˜åŒ–å›è°ƒ
```

---

### 2. GameManager.ts
**è·¯å¾„ï¼š** `assets/scripts/GameManager.ts`
**åŠŸèƒ½ï¼š** æ¸¸æˆçŠ¶æ€ç®¡ç† + å€’è®¡æ—¶ + èƒœè´Ÿåˆ¤å®š
**ä»£ç è¡Œæ•°ï¼š** ~400è¡Œ

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… 5åˆ†é’Ÿå€’è®¡æ—¶ï¼ˆ300ç§’ï¼‰
- âœ… å®æ—¶ç»Ÿè®¡ï¼šçŸ¿çŸ³ã€é€ƒè„±ã€æ·˜æ±°
- âœ… 3ç§èƒœè´Ÿåˆ¤å®šï¼š
  - æ·˜æ±°â‰¥3äºº â†’ è¿½æ•è€…èƒœåˆ©
  - é€ƒè„±â‰¥3äºº â†’ é€ƒç”Ÿè€…èƒœåˆ©
  - æ—¶é—´åˆ°ä¸”é€ƒè„±=2äºº â†’ å¹³å±€
- âœ… å•ä¾‹æ¨¡å¼
- âœ… äº‹ä»¶å›è°ƒç³»ç»Ÿ

**ä¾èµ–å…³ç³»ï¼š**
```
GameManager â†’ CharacterStateï¼ˆç›‘å¬çŠ¶æ€å˜åŒ–ï¼‰
GameManager â† Oreï¼ˆçŸ¿çŸ³æ‹¾å–é€šçŸ¥ï¼‰
GameManager â† ExitZoneï¼ˆé€ƒè„±é€šçŸ¥ï¼‰
```

**å…³é”®æ¥å£ï¼š**
```typescript
startGame(): void                  // å¼€å§‹æ¸¸æˆ
restartGame(): void                // é‡æ–°å¼€å§‹
onOreCollected(node): void         // çŸ¿çŸ³æ‹¾å–
onSurvivorEscaped(node): void      // é€ƒç”Ÿè€…é€ƒè„±
getCurrentState(): GameState       // è·å–æ¸¸æˆçŠ¶æ€
getStats(): GameStats              // è·å–ç»Ÿè®¡æ•°æ®
getTimeRemainingFormatted(): string // æ ¼å¼åŒ–å‰©ä½™æ—¶é—´
static getInstance(): GameManager  // è·å–å•ä¾‹
```

**æšä¸¾å®šä¹‰ï¼š**
```typescript
enum GameState {
    WAITING = 'waiting',
    PLAYING = 'playing',
    HUNTER_WIN = 'hunter_win',
    SURVIVOR_WIN = 'survivor_win',
    DRAW = 'draw'
}
```

---

### 3. GameUI.ts
**è·¯å¾„ï¼š** `assets/scripts/GameUI.ts`
**åŠŸèƒ½ï¼š** æ¸¸æˆUIæ˜¾ç¤º - å€’è®¡æ—¶ã€ç»Ÿè®¡ã€ç»“å±€
**ä»£ç è¡Œæ•°ï¼š** ~220è¡Œ

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… å€’è®¡æ—¶æ˜¾ç¤ºï¼ˆMM:SSæ ¼å¼ï¼‰
- âœ… çŸ¿çŸ³æ•°é‡æ˜¾ç¤º
- âœ… é€ƒè„±äººæ•°æ˜¾ç¤ºï¼ˆX/3ï¼‰
- âœ… æ·˜æ±°äººæ•°æ˜¾ç¤ºï¼ˆX/3ï¼‰
- âœ… æ¸¸æˆç»“æŸé¢æ¿ï¼ˆ3ç§é¢œè‰²ï¼‰
- âœ… è‡ªåŠ¨è®¢é˜…GameManageräº‹ä»¶

**UIç»‘å®šè¦æ±‚ï¼š**
```
timerLabel: Label         // å€’è®¡æ—¶æ–‡å­—
oreLabel: Label           // çŸ¿çŸ³ç»Ÿè®¡
escapedLabel: Label       // é€ƒè„±ç»Ÿè®¡
eliminatedLabel: Label    // æ·˜æ±°ç»Ÿè®¡
gameOverPanel: Node       // ç»“æŸé¢æ¿
gameOverLabel: Label      // ç»“æŸæ–‡å­—
```

**é¢œè‰²è§„åˆ™ï¼š**
- æ—¶é—´<1åˆ†é’Ÿï¼šçº¢è‰²
- é€ƒè„±â‰¥3äººï¼šç»¿è‰²
- æ·˜æ±°â‰¥3äººï¼šçº¢è‰²
- è¿½æ•è€…èƒœåˆ©ï¼šçº¢è‰²
- é€ƒç”Ÿè€…èƒœåˆ©ï¼šç»¿è‰²
- å¹³å±€ï¼šé»„è‰²

---

### 4. HunterUI.ts
**è·¯å¾„ï¼š** `assets/scripts/HunterUI.ts`
**åŠŸèƒ½ï¼š** è¿½æ•è€…UI - æ”»å‡»å’Œè¸©ç¢æœ¨æ¿æŒ‰é’®
**ä»£ç è¡Œæ•°ï¼š** ~200è¡Œ

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… æ”»å‡»æŒ‰é’®ï¼ˆè‡ªåŠ¨æ˜¾ç¤º/éšè—ï¼‰
- âœ… è¸©ç¢æœ¨æ¿æŒ‰é’®ï¼ˆè‡ªåŠ¨æ˜¾ç¤º/éšè—ï¼‰
- âœ… æ”»å‡»å†·å´è¿›åº¦æ˜¾ç¤º
- âœ… æŒ‰é’®ç‚¹å‡»äº‹ä»¶å¤„ç†

**UIç»‘å®šè¦æ±‚ï¼š**
```
attackButton: Node           // æ”»å‡»æŒ‰é’®
attackLabel: Label           // æ”»å‡»æ–‡å­—
breakBoardButton: Node       // è¸©ç¢æœ¨æ¿æŒ‰é’®
breakBoardLabel: Label       // è¸©ç¢æœ¨æ¿æ–‡å­—
hunterController: HunterController // æ§åˆ¶å™¨å¼•ç”¨
```

**æŒ‰é’®çŠ¶æ€ï¼š**
- é è¿‘é€ƒç”Ÿè€…ï¼šæ˜¾ç¤º"æ”»å‡» [åç§°]"
- æ”»å‡»å†·å´ä¸­ï¼šæ˜¾ç¤º"å†·å´ä¸­ X%"ï¼ŒæŒ‰é’®ç¦ç”¨
- é è¿‘å€’ä¸‹æœ¨æ¿ï¼šæ˜¾ç¤º"è¸©ç¢æœ¨æ¿"
- æ— ç›®æ ‡ï¼šéšè—æŒ‰é’®

---

### 5. ExitZone.ts
**è·¯å¾„ï¼š** `assets/scripts/ExitZone.ts`
**åŠŸèƒ½ï¼š** é€ƒè„±åŒºåŸŸè§¦å‘å™¨
**ä»£ç è¡Œæ•°ï¼š** ~110è¡Œ

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… è§¦å‘å™¨ç¢°æ’æ£€æµ‹
- âœ… é€ƒç”Ÿè€…é€ƒè„±åˆ¤å®šï¼ˆä»…NORMALçŠ¶æ€ï¼‰
- âœ… é€šçŸ¥GameManager
- âœ… é˜²é‡å¤è®¡æ•°
- âœ… å¯é€‰çŸ¿çŸ³æ•°é‡è¦æ±‚

**é…ç½®å‚æ•°ï¼š**
```typescript
exitPrompt: string                 // åŒºåŸŸæç¤º
requireOreCount: number            // é€ƒè„±æ‰€éœ€çŸ¿çŸ³ï¼ˆ0=ä¸éœ€è¦ï¼‰
destroySurvivorOnExit: boolean     // æ˜¯å¦é”€æ¯èŠ‚ç‚¹
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
1. åˆ›å»º3DèŠ‚ç‚¹
2. æ·»åŠ BoxColliderï¼ˆIsTrigger=trueï¼‰
3. æ·»åŠ ExitZoneç»„ä»¶
4. æ”¾ç½®åœ¨åœ°å›¾è¾¹ç¼˜

---

## ğŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### 1. Ore.tsï¼ˆV1.0 â†’ V1.1ï¼‰
**ä¿®æ”¹å†…å®¹ï¼š** æ·»åŠ GameManagerç»Ÿè®¡é€šçŸ¥

**æ–°å¢ä»£ç ï¼š**
```typescript
// ç¬¬7è¡Œï¼šæ–°å¢import
import { GameManager } from './GameManager';

// ç¬¬55-59è¡Œï¼šé€šçŸ¥GameManager
const gameManager = GameManager.getInstance();
if (gameManager) {
    gameManager.onOreCollected(this.node);
}
```

**å½±å“èŒƒå›´ï¼š** çŸ¿çŸ³æ‹¾å–æ—¶è‡ªåŠ¨è®¡æ•°

---

## ğŸ”§ ä¾èµ–å…³ç³»å›¾

```
GameManagerï¼ˆæ ¸å¿ƒç®¡ç†ï¼‰
    â†‘
    â”œâ”€ Ore.tsï¼ˆçŸ¿çŸ³æ‹¾å–é€šçŸ¥ï¼‰
    â”œâ”€ ExitZone.tsï¼ˆé€ƒè„±é€šçŸ¥ï¼‰
    â””â”€ CharacterState.tsï¼ˆæ·˜æ±°ç›‘å¬ï¼‰

GameUIï¼ˆUIæ˜¾ç¤ºï¼‰
    â†“
GameManagerï¼ˆæ•°æ®è®¢é˜…ï¼‰

HunterControllerï¼ˆè¿½æ•è€…æ§åˆ¶ï¼‰
    â”œâ”€ Hunter.tsï¼ˆæŠ“æ•é€»è¾‘ï¼‰
    â”œâ”€ Board.tsï¼ˆè¸©ç¢æœ¨æ¿ï¼‰
    â””â”€ Joystickï¼ˆè¾“å…¥ï¼‰

HunterUIï¼ˆè¿½æ•è€…UIï¼‰
    â†“
HunterControllerï¼ˆæŒ‰é’®å›è°ƒï¼‰
```

---

## ğŸ® åœºæ™¯é…ç½®è¦æ±‚

### å¿…éœ€èŠ‚ç‚¹æ¸…å•

| èŠ‚ç‚¹åç§° | ç»„ä»¶ | çˆ¶èŠ‚ç‚¹ | è¯´æ˜ |
|---------|------|--------|------|
| GameManager | GameManager | Scene | æ¸¸æˆç®¡ç†å™¨ |
| Hunter | HunterController + Hunter | Scene | è¿½æ•è€… |
| GameUI | GameUI | Canvas | æ¸¸æˆUI |
| HunterUI | HunterUI | Canvas | è¿½æ•è€…UI |
| ExitZone | ExitZone + BoxCollider | Scene | é€ƒè„±åŒºåŸŸ |

### GameUIå­èŠ‚ç‚¹ç»“æ„

```
GameUI (Component: GameUI)
â”œâ”€ TimerLabel (Component: Label)
â”œâ”€ OreLabel (Component: Label)
â”œâ”€ EscapedLabel (Component: Label)
â”œâ”€ EliminatedLabel (Component: Label)
â””â”€ GameOverPanel (Component: Sprite, Active: false)
    â””â”€ GameOverLabel (Component: Label)
```

### HunterUIå­èŠ‚ç‚¹ç»“æ„

```
HunterUI (Component: HunterUI)
â”œâ”€ AttackButton (Component: Button, Active: false)
â”‚   â””â”€ AttackLabel (Component: Label)
â””â”€ BreakBoardButton (Component: Button, Active: false)
    â””â”€ BreakBoardLabel (Component: Label)
```

---

## âš™ï¸ é…ç½®å‚æ•°å‚è€ƒ

### GameManageré…ç½®

```typescript
gameDuration: 300.0           // 5åˆ†é’Ÿ
survivorsToWin: 3             // é€ƒç”Ÿè€…èƒœåˆ©äººæ•°
eliminationsToWin: 3          // è¿½æ•è€…èƒœåˆ©äººæ•°
autoStartGame: true           // è‡ªåŠ¨å¼€å§‹
```

### HunterControlleré…ç½®

```typescript
moveSpeed: 5.75               // 115%é€Ÿåº¦
rotationSpeed: 10.0           // æ—‹è½¬é€Ÿåº¦
attackRange: 2.0              // æ”»å‡»èŒƒå›´
attackCooldown: 1.0           // æ”»å‡»å†·å´
boardBreakRange: 2.5          // è¸©ç¢æœ¨æ¿èŒƒå›´
```

### ExitZoneé…ç½®

```typescript
exitPrompt: "é€ƒè„±åŒºåŸŸ"
requireOreCount: 0            // ä¸éœ€è¦çŸ¿çŸ³
destroySurvivorOnExit: false  // ä¿ç•™èŠ‚ç‚¹ï¼ˆè°ƒè¯•ï¼‰
```

---

## ğŸ§ª æµ‹è¯•æ¸…å•

è¯¦è§ `ä»»åŠ¡2.2æµ‹è¯•è¯´æ˜.md`

**æµ‹è¯•è¦ç‚¹ï¼š**
- [x] è¿½æ•è€…ç§»åŠ¨ï¼ˆ115%é€Ÿåº¦ï¼‰
- [x] æ”»å‡»åŠŸèƒ½ï¼ˆèŒƒå›´+å†·å´ï¼‰
- [x] è¸©ç¢æœ¨æ¿
- [x] æ¸¸æˆå€’è®¡æ—¶ï¼ˆ5åˆ†é’Ÿï¼‰
- [x] çŸ¿çŸ³ç»Ÿè®¡
- [x] é€ƒè„±ç»Ÿè®¡
- [x] æ·˜æ±°ç»Ÿè®¡
- [x] è¿½æ•è€…èƒœåˆ©åˆ¤å®šï¼ˆæ·˜æ±°â‰¥3ï¼‰
- [x] é€ƒç”Ÿè€…èƒœåˆ©åˆ¤å®šï¼ˆé€ƒè„±â‰¥3ï¼‰
- [x] å¹³å±€åˆ¤å®šï¼ˆæ—¶é—´åˆ°ä¸”é€ƒè„±=2ï¼‰

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| ç±»åˆ« | æ–‡ä»¶æ•° | æ€»è¡Œæ•° |
|------|--------|--------|
| æ–°å¢è„šæœ¬ | 5 | ~1300 |
| ä¿®æ”¹è„šæœ¬ | 1 | +7 |
| æ–‡æ¡£ | 2 | ~800 |
| **åˆè®¡** | **8** | **~2100** |

---

## ğŸ” ä»£ç è´¨é‡æ£€æŸ¥

### è®¾è®¡æ¨¡å¼

- âœ… å•ä¾‹æ¨¡å¼ï¼ˆGameManagerï¼‰
- âœ… å›è°ƒæ¨¡å¼ï¼ˆäº‹ä»¶é€šçŸ¥ï¼‰
- âœ… çŠ¶æ€æœºæ¨¡å¼ï¼ˆGameStateæšä¸¾ï¼‰
- âœ… è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆUIè®¢é˜…æ•°æ®å˜åŒ–ï¼‰

### æ€§èƒ½ä¼˜åŒ–

- âœ… å¯¹è±¡ç¼“å­˜ï¼ˆ_allCharacters, _allBoardsï¼‰
- âœ… ä¸´æ—¶å˜é‡å¤ç”¨ï¼ˆ_tempVec3_1, _tempVec3_2ï¼‰
- âœ… æŒ‰éœ€æ›´æ–°ï¼ˆæ¯ç§’é€šçŸ¥ç»Ÿè®¡ï¼Œè€Œéæ¯å¸§ï¼‰
- âœ… é˜²é‡å¤è®¡æ•°ï¼ˆ_escapedSurvivors Setï¼‰

### ä»£ç è§„èŒƒ

- âœ… ç»Ÿä¸€å‘½åè§„èŒƒï¼ˆé©¼å³°å‘½åï¼‰
- âœ… è¯¦ç»†æ³¨é‡Šï¼ˆä¸­æ–‡è¯´æ˜ï¼‰
- âœ… é”™è¯¯å¤„ç†ï¼ˆconsole.errorï¼‰
- âœ… ç±»å‹å®‰å…¨ï¼ˆTypeScriptä¸¥æ ¼æ¨¡å¼ï¼‰

---

## ğŸ“š æ–‡æ¡£æ¸…å•

1. **ä»»åŠ¡2.2æµ‹è¯•è¯´æ˜.md** - è¯¦ç»†æµ‹è¯•æ­¥éª¤å’ŒéªŒæ”¶æ ‡å‡†
2. **ä»»åŠ¡2.2ä»£ç äº¤ä»˜æ¸…å•.md**ï¼ˆæœ¬æ–‡æ¡£ï¼‰- å®Œæ•´ä»£ç æ¸…å•

---

## âœ… äº¤ä»˜éªŒæ”¶

### åŠŸèƒ½å®Œæ•´æ€§

- [x] è¿½æ•è€…å¯æ§ç§»åŠ¨ï¼ˆ115%é€Ÿåº¦ï¼‰
- [x] æ”»å‡»æŒ‰é’®ï¼ˆèŒƒå›´åˆ¤å®š+å†·å´ï¼‰
- [x] è¸©ç¢æœ¨æ¿åŠŸèƒ½
- [x] 5åˆ†é’Ÿå€’è®¡æ—¶
- [x] çŸ¿çŸ³/é€ƒè„±/æ·˜æ±°ç»Ÿè®¡
- [x] 3ç§èƒœè´Ÿåˆ¤å®šé€»è¾‘
- [x] UIæ˜¾ç¤ºï¼ˆå€’è®¡æ—¶+ç»Ÿè®¡+ç»“æœï¼‰

### ä»£ç è´¨é‡

- [x] æ— ç¼–è¯‘é”™è¯¯
- [x] æ— TypeScriptç±»å‹é”™è¯¯
- [x] ä»£ç æ³¨é‡Šå®Œæ•´
- [x] ç¬¦åˆé¡¹ç›®è§„èŒƒ

### æ–‡æ¡£å®Œæ•´æ€§

- [x] æµ‹è¯•è¯´æ˜æ–‡æ¡£
- [x] ä»£ç äº¤ä»˜æ¸…å•
- [x] é…ç½®è¯´æ˜
- [x] æ•…éšœæ’æŸ¥æŒ‡å—

---

## ğŸš€ åç»­æ‰©å±•å»ºè®®

1. **AIè¿½æ•è€…ï¼š** åŸºäºHunterControllerå®ç°è‡ªåŠ¨å¯»è·¯å’Œæ”»å‡»
2. **æ›´å¤šèƒœåˆ©æ¡ä»¶ï¼š** å¦‚æ”¶é›†ç‰¹å®šæ•°é‡çŸ¿çŸ³æ‰èƒ½é€ƒè„±
3. **æŠ€èƒ½ç³»ç»Ÿï¼š** ç»™è¿½æ•è€…/é€ƒç”Ÿè€…æ·»åŠ ç‰¹æ®ŠæŠ€èƒ½
4. **å¤šäººè”æœºï¼š** å®ç°çœŸäººå¯¹æˆ˜æ¨¡å¼
5. **åŠ¨ç”»ç³»ç»Ÿï¼š** æ·»åŠ æ”»å‡»ã€ç§»åŠ¨åŠ¨ç”»
6. **éŸ³æ•ˆç³»ç»Ÿï¼š** æ·»åŠ èƒŒæ™¯éŸ³ä¹å’ŒéŸ³æ•ˆ

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. ç»„ä»¶å¼•ç”¨æ˜¯å¦æ­£ç¡®ç»‘å®š
3. åœºæ™¯èŠ‚ç‚¹ç»“æ„æ˜¯å¦å®Œæ•´
4. å‚è€ƒ `ä»»åŠ¡2.2æµ‹è¯•è¯´æ˜.md` ä¸­çš„æ•…éšœæ’æŸ¥ç« èŠ‚

---

**ä»»åŠ¡2.2äº¤ä»˜å®Œæˆï¼** ğŸ‰

**ç‰ˆæœ¬ï¼š** V1.0
**äº¤ä»˜æ—¥æœŸï¼š** 2025å¹´
**çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ
