# 任务1.1和1.2 全面测试计划

**测试执行者：** Claude Code
**测试日期：** 2025-10-01
**测试范围：** 基础功能与控制（模块一）

---

## 📋 测试清单（对照DELIVERY_CHECKLIST.md）

### 模块一：基础功能与控制

#### 1. 程序启动与退出
- [ ] 程序可正常启动和退出，无崩溃
- [ ] 场景加载正常，无报错
- [ ] 所有节点和组件正确加载

#### 2. 摇杆操控（任务1.1）
- [ ] 摇杆向上移动：角色向屏幕正前方移动
- [ ] 摇杆向下移动：角色向屏幕正后方移动
- [ ] 摇杆向左移动：角色向屏幕左方移动
- [ ] 摇杆向右移动：角色向屏幕右方移动
- [ ] 摇杆斜向移动（8个方向）：方向准确
- [ ] 摇杆强度影响速度：推得越远，移动越快
- [ ] 摇杆松开：角色停止移动

#### 3. 角色移动（任务1.1）
- [ ] 无卡顿现象
- [ ] 无漂移现象（松开摇杆立即停止）
- [ ] 不会穿墙（如果有碰撞）
- [ ] 不会被空气墙阻挡
- [ ] 角色移动时自动转向面对移动方向
- [ ] 转向平滑，无抖动

#### 4. 镜头控制（任务1.2）
- [ ] 拖动屏幕右侧可旋转视角
- [ ] 旋转平滑，无抖动
- [ ] 旋转无跳变
- [ ] 左侧摇杆区域不响应镜头旋转
- [ ] 可以360度旋转
- [ ] 旋转速度合适（不太快也不太慢）

#### 5. 摄像机跟随（任务1.1）
- [ ] 摄像机平滑跟随角色
- [ ] 跟随距离固定
- [ ] 无穿透地面或角色
- [ ] 无抖动或跳变

#### 6. 相对摄像机移动（任务1.2关键测试）
- [ ] 旋转摄像机到0度（初始位置）后，摇杆向上 → 角色向前
- [ ] 旋转摄像机到90度（右侧）后，摇杆向上 → 角色向右
- [ ] 旋转摄像机到180度（前方）后，摇杆向上 → 角色向后
- [ ] 旋转摄像机到270度（左侧）后，摇杆向上 → 角色向左
- [ ] 任意角度下，摇杆方向始终符合屏幕直觉

#### 7. 综合测试
- [ ] 可以边移动边旋转镜头
- [ ] 移动过程中旋转镜头，移动方向实时更新
- [ ] 长时间操作无性能下降
- [ ] 无内存泄漏（帧率稳定）

---

## 🔍 代码逻辑检查项

### Joystick.ts
- [ ] 触摸事件正确注册和销毁
- [ ] 触摸ID正确跟踪（多点触控隔离）
- [ ] 方向计算正确（归一化）
- [ ] 强度计算正确（0-1范围）
- [ ] 边界限制正确（maxRadius）

### PlayerController.ts
- [ ] 摄像机方向获取正确
- [ ] 前方向和右方向计算正确
- [ ] 水平面投影正确（Y=0）
- [ ] 移动方向组合正确
- [ ] 旋转插值平滑
- [ ] 空引用检查完整

### CameraFollow.ts
- [ ] 目标跟随正确
- [ ] 偏移量计算正确（三角函数）
- [ ] yaw角度更新正确
- [ ] 角度规范化正确（-180到180）
- [ ] 插值计算平滑
- [ ] 朝向计算正确（LookAt）

### CameraController.ts
- [ ] Canvas事件监听正确
- [ ] 摇杆区域排除逻辑正确
- [ ] UI坐标转换正确
- [ ] 触摸ID跟踪正确
- [ ] 角度增量计算正确
- [ ] 事件销毁完整

---

## 🐛 已知潜在问题

### 1. 性能问题（任务1.1遗留）
- PlayerController.ts 仍有对象频繁创建
- Joystick.ts 仍有对象频繁创建
- 建议：统一优化或在测试中监控性能

### 2. 坐标系问题
- UI坐标系和世界坐标系转换是否正确
- Cocos Creator Z轴方向是否处理正确

### 3. 边界情况
- 摄像机旋转到极限角度时的行为
- 快速连续触摸的处理
- 摇杆和镜头同时操作的冲突

---

## 🧪 测试方法

### 自动化代码检查
1. 检查所有空引用
2. 检查数学计算逻辑
3. 检查事件监听配对
4. 检查变量初始化

### 手动功能测试
1. 按照清单逐项测试
2. 记录每项测试结果
3. 截图/录屏问题现象
4. 定位问题代码位置

### 性能测试
1. 监控帧率（应≥60fps）
2. 监控内存使用
3. 长时间运行测试（5分钟）

---

## 📝 测试结果记录格式

每项测试记录：
```
[✅/❌] 测试项名称
- 预期行为：xxx
- 实际行为：xxx
- 问题描述：xxx（如果失败）
- 严重程度：P0/P1/P2
- 修复建议：xxx
```

---

## 🔧 修复优先级

- **P0（必须修复）：** 功能完全不可用，阻塞测试
- **P1（应该修复）：** 功能异常，影响体验
- **P2（建议修复）：** 小问题，可接受

---

开始测试！
